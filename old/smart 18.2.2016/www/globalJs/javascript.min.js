function globalJs(){function e(){r(),l(),$(window).resize(i),$(".global_pagesFixed").click(o),t()}function t(){$.building_main=json_mainBuilding,$.building_residential=json_residential,$.building_corporate=json_corporate,$.building_restaurant=json_restaurant,$.building_foodFactor=json_foodFactory,$.building_accountant=json_accountant,$.building_clothingStore=json_clothingStore,$.building_clothingFactory=json_clothingFactory}function n(){$(".global_hide").hide()}function o(){$("body,html").animate({scrollTop:0},500)}function i(){var e=$(window).height(),t=$(".header").height(),n=e-t-20;if(1==$(".map").is(":hidden")&&1==$(".notebook").is(":hidden"))var o=$(".war").offset().top,i=20;else if(1==$(".map").is(":hidden"))var o=$(".notebook").offset().top,i=20;else var o=$(".map").offset().top,i=20;var r=e-o-i-70,t=$(".header").height(),a=e-t-5;$(".global_pagesHolder, .global_pagesFixed").css("height",n+"px"),$(".map, .notebook, .war").css("height",r+"px"),$(".global_page_feed").css("height",a+"px"),$(".feed_cont").css("height",a-20+"px");var s=$(window).width(),l=306,c=115;if($.globalUser.mentor<13)var l=380;var d=s-l-c-45,u=s-l-c-27;$(".addBuilding").css("left",l+60+"px"),$(".map, .notebook, .war").css("width",d+"px"),$(".feed").css("width",u+"px")}function r(){var e={},t="/api/users/getUser/";global.api(t,e,function(e){e=JSON.parse(e),$.globalUser=e[0][0],$.globalUserBuilding=e[1],$.globalUserOnBuildingProcess=e[2],$.globalUserMentor=e[3][0],$.globalUserCity=e[4],$.globalUserFactoryRaq=e[5],a(),i()})}function a(){notebook.echoData($.globalUserBuilding),header.getUserBuildingsSum($.globalUser,$.globalUserOnBuildingProcess),header.getUserRep($.globalUser),header.getCompanyDetails($.globalUser),header.setProfit($.globalUser.profit),header.setMaxMoney($.globalUser.maxMoney),header.showUpgradOrText($.globalUserBuilding),runningTimes.showBuildingsOnBuildingProocess($.globalUserOnBuildingProcess),"undefined"==typeof vmap.map&&vmap.ctor($.globalUserCity[0]),map_lookAround.showBuildingsOnTheMap(),$.globalUser.mentor>12?feed.showPage():feed.hidePage(),setTimeout(function(){mentor.showPage()},1e3),chat.listen(),clearInterval($.headerSetMoney),$.headerSetMoney=setInterval(function(){s($.globalUser.money,$.globalUser.profit,$.globalUser.lastLogin,$.globalUser.maxMoney)},1e3),notebookNav.showPage()}function s(e,t,n,o){n=new Date(n);var i=new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds(),n.getUTCMilliseconds());n=i.getTime()/1e3;var r=new Date,i=new Date(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds());r=i.getTime()/1e3;var a=formulas.calculateMoney(r,n,t),s=e+a;s>o&&(s=o),header.setMoney(s,o)}function l(){n(),1==h?h=0:mentor.showPage(),chat.showPage(),vmap.showPage(),addBuilding.showPage(),header.showBottomHeader(),bgElements.showPage(),feed.showPage(),notebookNav.showPage()}function c(e,t,n){e=$.rootUrl+e,t.session=$.cookie("session"),$.ajax({type:"GET",url:e,data:t,dataType:"text",success:function(e){var t=e[0]+e[1]+e[2];"-1"==e?d():"-10"==t?alert("שגיאה לא ידועה : "+e):n(e)},error:function(){}})}function d(){n(),$.cookie("session",""),login.showPage()}function u(e){return("0"+e).slice(-2)}function p(e){return[e.getUTCFullYear(),u(e.getUTCMonth()+1),u(e.getUTCDate())].join("-")+" "+[u(e.getUTCHours()),u(e.getUTCMinutes()),u(e.getUTCSeconds())].join(":")}this.main=e,this.globalHide=n,this.resizePage=i,this.getUser=r;var h=1;this.showDasInFirstTime=h,this.showDashboard=l,this.api=c,this.logOut=d,this.formatDate=p}function pagesJS(){function e(e){}$(document).ready(function(){function t(){var t=window.location.hash,t=t.split("#").pop();e(t)}t()}),$(window).on("hashchange",function(){var t=window.location.hash,t=t.split("#")[1];e(t)}),this.pages=e}function buildingsJsonJs(){function e(e){var t="";return 0==e?t="משרדי החברה":1==e?t="בניין מגורים":2==e?t="מסעדה":3==e?t="מפעל מזון":4==e?t="תאגיד":5==e?t="רואה חשבון":6==e?t="חנות בגדים":7==e?t="מפעל בגדים":console.log("error: not find building name file:buildingsJson.js function:getBuildingName"),t}function t(e){return 0==e?$.building_main:1==e?$.building_residential:2==e?$.building_restaurant:3==e?$.building_foodFactor:4==e?$.building_corporate:5==e?$.building_accountant:6==e?$.building_clothingStore:7==e?$.building_clothingFactory:void 0}function n(e,n){var o=t(e),i=o.levels[n].img;return i}function o(e,n){n-=1;var o=t(e),i=o.levels[n].day,r=o.levels[n].minutes,a=o.levels[n].seconds,s=o.levels[n].hours,l="";return i>0&&(l+=i+" ימים "),s>0&&(l+=s+" שעות "),r>0&&(l+=r+" דקות "),a>0&&(l+=a+" שניות "),0==l.length&&(l="0 שניות"),l}function i(){if(void 0==$.globalUserBuilding||0==$.globalUserBuilding.length)return 0;for(var e=$.globalUserBuilding.length,t=0;e>t;t++)if("0"==$.globalUserBuilding[t].type_id)return $.globalUserBuilding[t]}function r(e){if(void 0==$.globalUserBuilding)return 0;for(var t=$.globalUserBuilding.length,n=0,o=0;t>o;o++)("3"==$.globalUserBuilding[o].type_id||3==$.globalUserBuilding[o].type_id)&&n++;return n}this.getBuildingName=e,this.getJson=t,this.getImageUrl=n,this.getTime=o,this.getMainBuilding=i,this.counterBuildings=r}function helpJs(){function e(e){if(null==e)return 0;var t=e.toString().split(".");return t[0]=t[0].replace(/\B(?=(\d{3})+(?!\d))/g,","),t.join(".")}function t(e){return e.indexOf("Street")>0?e.replace("Street",""):e}this.addComma=e,this.orderStreetName=t}function formulasJs(){function e(e){var t=1;return 60>=e&&e>0?t=1:e>60&&3600>=e?t=19*(e-60)/3540+1:e>3600&&86400>=e?t=240*(e-3600)/82800+20:e>86400&&(t=740*(e-86400)/518400+260),Math.floor(t)}function t(e,t,n){var o=e-t,i=Math.floor(o/3600),r=o-3600*i,a=100*r/3600/100,s=a*n,l=n*i,c=s+l;return c}function n(e,t){return parseInt(s(e,t)/e)}function o(e,t){return parseInt(r(e,t)/e)}function i(e,t){return parseInt(a(e,t)/e)}function r(e,t){e>40&&(e=40);var n=.01*e,o=t*n;return parseInt(o)}function a(e,t){e>40&&(e=40);var n=.01*e,o=t*n;return parseInt(o)}function s(e,t){if(1==e)var n=.04*t*e;else if(2==e)var n=.03*t*e;else if(3==e)var n=.027*t*e;else if(4==e)var n=.022*t*e;else{e=5;var n=.02*t*e}return parseInt(n)}function l(e,t,n,o){for(var e=c(e,t,n,o),i=e.length,r=0,a=0;i>a;a++)r+=parseFloat(e[a].minus);return r=.01*r,r*o}function c(e,t,n,o){for(var i=.5,r=e.length,a=6371,s=[],l=[],c=0;r>c;c++){var d=e[c].lat,u=e[c].lng,p=e[c].id,h=d-t,f=u-n,_=h*Math.PI*a/180,m=f*Math.PI*a/180,g=Math.pow(_,2)+Math.pow(m,2);if(g=Math.sqrt(g),g>i)var v=0;else var v=100-100*g/i;s[c]=v,l[c]=p}var y=s.sort(function(e,t){return t-e});s=y;var b=[];if(r>0){var w=20,$=s[0]*w/100,x=new Object;x.buildingId=l[0],x.minus=parseInt($),b[0]=x}if(r>1){var w=15,$=s[1]*w/100,x=new Object;x.buildingId=l[1],x.minus=parseInt($),b[1]=x}if(r>2){var w=15,$=s[2]*w/100,x=new Object;x.buildingId=l[2],x.minus=parseInt($),b[2]=x}if(r>3){var w=5,$=s[3]*w/100,x=new Object;x.buildingId=l[3],x.minus=parseInt($),b[3]=x}if(r>4){var w=5,$=s[4]*w/100,x=new Object;x.buildingId=l[4],x.minus=parseInt($),b[4]=x}return b}function d(e,t,n){var o=u(e,t)-n;return o}function u(e,t){if(1==e)var n=.2;else if(2==e)var n=.25;else if(3==e)var n=.3;else if(4==e)var n=.35;else if(5==e)var n=.4;else if(6==e)var n=.45;else var n=.5;var o=n*t;return o}this.time=e,this.calculateMoney=t,this.residentialVsRestaurantClient=n,this.restaurantVsResidentialClient=o,this.residentialVsResidentialClient=i,this.restaurantVsResidential=r,this.residentialVsResidential=a,this.residentialVsRestaurant=s,this.calculateRestaurant=l,this.restaurantVsRestaurant=c,this.factoryVsRestaurant=d,this.factoryCalculate=u}function headerJS(){function e(){$(".header_cont_logout").click(v),$(".header_cont_homePage, .header_cont_pageName_homePage").click(_),$(".header_menu_li_youtube").click(m),$(".header_menu_li_payment").click(g),$(".header_searchCompany_btn").click(y),$(".header_cont_pageName_rank").click(t),$(".header_company_nameInput").focus(a),$(".header_company_nameInput").focusout(s),$(".header_bottomHeader_money_hover_upgrade").click(o),$(".header_bottomHeader_money").mouseenter(r),$(".header_bottomHeader_money").mouseleave(i),$(".header_bottomHeader_mission4_1_text_submit").click(n)}function t(){$(".header_cont_pageName").removeClass("header_cont_pageNameActive"),$(this).addClass("header_cont_pageNameActive"),rank.showPage()}function n(){$.globalUser.mentor=5,clearInterval($.mentor_level4),$(".header_bottomHeader_mission4, .header_bottomHeader_mission4_1_text").hide(),mentor.updateMentor(),mentor.checkMentorLevel()}function o(){for(var e=$.globalUserBuilding,t=e.length,n=0;t>n;n++){var o=e[n].type_id;if(5==o)var i=e[n].id}upgradeBuilding.showPage(i)}function i(){4==$.globalUser.mentor&&(clearInterval($.mentor_level4),$.mentor_level4=setInterval(function(){$(".header_bottomHeader_mission4").fadeToggle(100)},500))}function r(){clearInterval($.mentor_level4),$(".header_bottomHeader_mission4").hide(),4==$.globalUser.mentor?$(".header_bottomHeader_mission4_1, .header_bottomHeader_mission4_1_text").show():$(".header_bottomHeader_mission4_1, .header_bottomHeader_mission4_1_text").hide()}function a(){$(".header_searchCompany").addClass("header_searchCompanyAddClass")}function s(){$(".header_searchCompany").removeClass("header_searchCompanyAddClass")}function l(e,t){var n=parseInt(e);e=Math.floor(e),e=help.addComma(e);var o=t;n>=o?($(".header_bottomHeader_money_ammount").addClass("header_bottomHeader_money_ammountAddClass"),$(".header_bottomHeader_money_hover_UpgradeText").show()):($(".header_bottomHeader_money_ammount").removeClass("header_bottomHeader_money_ammountAddClass"),$(".header_bottomHeader_money_hover_UpgradeText").hide()),$(".header_bottomHeader_money_ammount span").text(e)}function c(e){null==e&&(e=0),e=help.addComma(e),$(".header_bottomHeader_money_hover_money span").text(e)}function d(e){for(var t=e.length,n=0,o=0;t>o;o++){var i=e[o].type_id;5==i&&(n=e[o].id)}0==n?($(".header_bottomHeader_money_hover_notUpgrade").show(),$(".header_bottomHeader_money_hover_upgrade").hide()):($(".header_bottomHeader_money_hover_notUpgrade").hide(),$(".header_bottomHeader_money_hover_upgrade").show())}function u(e){e=help.addComma(e),$(".header_bottomHeader_money_hover_maxMoney span").text(e)}function p(){$(".header_bottomHeader").show()}function h(e,t){$(".header_bottomHeader_keys_ammount_sumAv").text(e.officeLevel),$(".header_bottomHeader_keys_ammount_sumBuild").text(t.length)}function f(e){var t=help.addComma(e.reputation);$(".header_bottomHeader_star_ammount span").text(t)}function _(){$(".header_cont_pageName").removeClass("header_cont_pageNameActive"),$(".header_cont_pageName_homePage").addClass("header_cont_pageNameActive"),global.showDashboard()}function m(){youtube.showPage()}function g(){payment.showPage()}function v(){global.logOut()}function y(){$(".header_cont_pageName").removeClass("header_cont_pageNameActive"),$(this).addClass("header_cont_pageNameActive");var e=$("#header_searchCompany_input").val(),t={companyName:e},n="/api/company/search/";global.api(n,t,function(e){JSON.parse(e);company.searchCompany(e)})}function b(e){$(".header_cont_company").unbind("click"),null==e.companys_name?($(".header_cont_company").text("צור תאגיד"),$(".header_cont_company").click(w)):($(".header_cont_company").text("תאגיד"),$(".header_cont_company").click(x))}function w(){company.showPopupPage(),company.createNewCompany()}function x(){company.showPage($.globalUser.companys_id)}this.ctor=e,this.setMoney=l,this.setProfit=c,this.showUpgradOrText=d,this.setMaxMoney=u,this.showBottomHeader=p,this.getUserBuildingsSum=h,this.getUserRep=f,this.getCompanyDetails=b}function header_notifcationsJS(){function e(){t()}function t(){var e={},t="/api/header/notifications/";global.api(t,e,function(e){var t=JSON.parse(e);n(t)})}function n(e){if(console.log(e),null!=e){for(var t=e.length,n=0,i=0;t>i;i++)0==e[i].vread&&n++;n>0&&($(".header_cont_notafications_count").text(n),$(".header_cont_notafications_count").show()),$(".header_cont_notafications").click(r),$(".header_cont_notafications_list_row").hide();for(var i=0;t>i;i++){var s,c,u,p=$(".header_cont_notafications_list_row:first").clone(),h=(e[i].users_id,e[i].name);1==e[i].type_id&&(s="שלח לך הצעת מחיר",c="צפה",p.find(".header_cont_notafications_list_row_aprrove").click({reqId:e[i].id,otherId:e[i].other},o)),2==e[i].type_id&&(s="מנסה לגנוב לך לקוחות",c="אישור"),3==e[i].type_id&&(s="אישר את הצעת המחיר",c="אישור"),4==e[i].type_id&&(s="סירב להצעת המחיר",c="אישור"),5==e[i].type_id&&(s="ביקש להצטרף לתאגיד",c="אישור",u="ביטול",p.find(".header_cont_notafications_list_row_aprrove").click({param1:e[i].id},a),p.find(".header_cont_notafications_list_row_cancel").click({param1:e[i].id},l)),6==e[i].type_id&&(s="אישר את בקשת ההצטרפות שלך",c="אישור"),"undefined"==typeof u&&p.find(".header_cont_notafications_list_row_cancel").hide(),0==e[i].vread?p.css("background","#edeff5"):p.css("background","default"),p.click({param1:e[i].id},d),p.find(".header_cont_notafications_list_row_aprrove").text(c),p.find(".header_cont_notafications_list_row_cancel").text(u),p.find(".header_cont_notafications_list_row_msg").text(s),p.find(".header_cont_notafications_list_row_userName").text(h),$(".header_cont_notafications_list").append(p),p.show()}}}function o(e){var t=e.data.reqId,n=e.data.otherId,o={store_id:n},r="/api/war/getRestuarantsBid/";global.api(r,o,function(e){i(JSON.parse(e),t)})}function i(e,t){console.log(e),console.log(t),war.showRequest(e,t)}function r(){$(".header_cont_notafications_list").toggle()}function a(e){var t=e.data.param1,n={notification_id:t},o="/api/company/confirmReq/";global.api(o,n,function(e){s(e)})}function s(e){console.log(e),"sucsses"==e?popup.showPage("המשתמש נוסף לתאגיד"):valert.showPage("ארעה שגיאה");var n=$(".header_cont_notafications_count").text();n--,n>0?$(".header_cont_notafications_count").text(n):$(".header_cont_notafications_count").hide(),t()}function l(e){var t=e.data.param1,n={notification_id:t},o="/api/company/cancelReq/";global.api(o,n,function(e){c(e)})}function c(e){console.log(e);var n=$(".header_cont_notafications_count").text();n--,n>0?$(".header_cont_notafications_count").text(n):$(".header_cont_notafications_count").hide(),t()}function d(e){var t=e.data.param1,n={notification_id:t},o="/api/header/readNotifications/";global.api(o,n,function(e){u(e)})}function u(e){var t=$(".header_cont_notafications_count").text();t--,t>0&&$(".header_cont_notafications_count").text(t)}this.ctor=e,this.getNotifcations=t}function headerJS(){function e(){$(".header_cont_logout").click(v),$(".header_cont_homePage, .header_cont_pageName_homePage").click(_),$(".header_menu_li_youtube").click(m),$(".header_menu_li_payment").click(g),$(".header_searchCompany_btn").click(y),$(".header_cont_pageName_rank").click(t),$(".header_company_nameInput").focus(a),$(".header_company_nameInput").focusout(s),$(".header_bottomHeader_money_hover_upgrade").click(o),$(".header_bottomHeader_money").mouseenter(r),$(".header_bottomHeader_money").mouseleave(i),$(".header_bottomHeader_mission4_1_text_submit").click(n)}function t(){$(".header_cont_pageName").removeClass("header_cont_pageNameActive"),$(this).addClass("header_cont_pageNameActive"),rank.showPage()}function n(){$.globalUser.mentor=5,clearInterval($.mentor_level4),$(".header_bottomHeader_mission4, .header_bottomHeader_mission4_1_text").hide(),mentor.updateMentor(),mentor.checkMentorLevel()}function o(){for(var e=$.globalUserBuilding,t=e.length,n=0;t>n;n++){var o=e[n].type_id;if(5==o)var i=e[n].id}upgradeBuilding.showPage(i)}function i(){4==$.globalUser.mentor&&(clearInterval($.mentor_level4),$.mentor_level4=setInterval(function(){$(".header_bottomHeader_mission4").fadeToggle(100)},500))}function r(){clearInterval($.mentor_level4),$(".header_bottomHeader_mission4").hide(),4==$.globalUser.mentor?$(".header_bottomHeader_mission4_1, .header_bottomHeader_mission4_1_text").show():$(".header_bottomHeader_mission4_1, .header_bottomHeader_mission4_1_text").hide()}function a(){$(".header_searchCompany").addClass("header_searchCompanyAddClass")}function s(){$(".header_searchCompany").removeClass("header_searchCompanyAddClass")}function l(e,t){var n=parseInt(e);e=Math.floor(e),e=help.addComma(e);var o=t;n>=o?($(".header_bottomHeader_money_ammount").addClass("header_bottomHeader_money_ammountAddClass"),$(".header_bottomHeader_money_hover_UpgradeText").show()):($(".header_bottomHeader_money_ammount").removeClass("header_bottomHeader_money_ammountAddClass"),$(".header_bottomHeader_money_hover_UpgradeText").hide()),$(".header_bottomHeader_money_ammount span").text(e)}function c(e){null==e&&(e=0),e=help.addComma(e),$(".header_bottomHeader_money_hover_money span").text(e)}function d(e){for(var t=e.length,n=0,o=0;t>o;o++){var i=e[o].type_id;5==i&&(n=e[o].id)}0==n?($(".header_bottomHeader_money_hover_notUpgrade").show(),$(".header_bottomHeader_money_hover_upgrade").hide()):($(".header_bottomHeader_money_hover_notUpgrade").hide(),$(".header_bottomHeader_money_hover_upgrade").show())}function u(e){e=help.addComma(e),$(".header_bottomHeader_money_hover_maxMoney span").text(e)}function p(){$(".header_bottomHeader").show()}function h(e,t){$(".header_bottomHeader_keys_ammount_sumAv").text(e.officeLevel),$(".header_bottomHeader_keys_ammount_sumBuild").text(t.length)}function f(e){var t=help.addComma(e.reputation);$(".header_bottomHeader_star_ammount span").text(t)}function _(){$(".header_cont_pageName").removeClass("header_cont_pageNameActive"),$(".header_cont_pageName_homePage").addClass("header_cont_pageNameActive"),global.showDashboard()}function m(){youtube.showPage()}function g(){payment.showPage()}function v(){global.logOut()}function y(){$(".header_cont_pageName").removeClass("header_cont_pageNameActive"),$(this).addClass("header_cont_pageNameActive");var e=$("#header_searchCompany_input").val(),t={companyName:e},n="/api/company/search/";global.api(n,t,function(e){JSON.parse(e);company.searchCompany(e)})}function b(e){$(".header_cont_company").unbind("click"),null==e.companys_name?($(".header_cont_company").text("צור תאגיד"),$(".header_cont_company").click(w)):($(".header_cont_company").text("תאגיד"),$(".header_cont_company").click(x))}function w(){company.showPopupPage(),company.createNewCompany()}function x(){company.showPage($.globalUser.companys_id)}this.ctor=e,this.setMoney=l,this.setProfit=c,this.showUpgradOrText=d,this.setMaxMoney=u,this.showBottomHeader=p,this.getUserBuildingsSum=h,this.getUserRep=f,this.getCompanyDetails=b}function header_notifcationsJS(){function e(){t()}function t(){var e={},t="/api/header/notifications/";global.api(t,e,function(e){var t=JSON.parse(e);n(t)})}function n(e){if(console.log(e),null!=e){for(var t=e.length,n=0,i=0;t>i;i++)0==e[i].vread&&n++;n>0&&($(".header_cont_notafications_count").text(n),$(".header_cont_notafications_count").show()),$(".header_cont_notafications").click(r),$(".header_cont_notafications_list_row").hide();for(var i=0;t>i;i++){var s,c,u,p=$(".header_cont_notafications_list_row:first").clone(),h=(e[i].users_id,e[i].name);1==e[i].type_id&&(s="שלח לך הצעת מחיר",c="צפה",p.find(".header_cont_notafications_list_row_aprrove").click({reqId:e[i].id,otherId:e[i].other},o)),2==e[i].type_id&&(s="מנסה לגנוב לך לקוחות",c="אישור"),3==e[i].type_id&&(s="אישר את הצעת המחיר",c="אישור"),4==e[i].type_id&&(s="סירב להצעת המחיר",c="אישור"),5==e[i].type_id&&(s="ביקש להצטרף לתאגיד",c="אישור",u="ביטול",p.find(".header_cont_notafications_list_row_aprrove").click({param1:e[i].id},a),p.find(".header_cont_notafications_list_row_cancel").click({param1:e[i].id},l)),6==e[i].type_id&&(s="אישר את בקשת ההצטרפות שלך",c="אישור"),"undefined"==typeof u&&p.find(".header_cont_notafications_list_row_cancel").hide(),0==e[i].vread?p.css("background","#edeff5"):p.css("background","default"),p.click({param1:e[i].id},d),p.find(".header_cont_notafications_list_row_aprrove").text(c),p.find(".header_cont_notafications_list_row_cancel").text(u),p.find(".header_cont_notafications_list_row_msg").text(s),p.find(".header_cont_notafications_list_row_userName").text(h),$(".header_cont_notafications_list").append(p),p.show()}}}function o(e){var t=e.data.reqId,n=e.data.otherId,o={store_id:n},r="/api/war/getRestuarantsBid/";global.api(r,o,function(e){i(JSON.parse(e),t)})}function i(e,t){console.log(e),console.log(t),war.showRequest(e,t)}function r(){$(".header_cont_notafications_list").toggle()}function a(e){var t=e.data.param1,n={notification_id:t},o="/api/company/confirmReq/";global.api(o,n,function(e){s(e)})}function s(e){console.log(e),"sucsses"==e?popup.showPage("המשתמש נוסף לתאגיד"):valert.showPage("ארעה שגיאה");var n=$(".header_cont_notafications_count").text();n--,n>0?$(".header_cont_notafications_count").text(n):$(".header_cont_notafications_count").hide(),t()}function l(e){var t=e.data.param1,n={notification_id:t},o="/api/company/cancelReq/";global.api(o,n,function(e){c(e)})}function c(e){console.log(e);var n=$(".header_cont_notafications_count").text();n--,n>0?$(".header_cont_notafications_count").text(n):$(".header_cont_notafications_count").hide(),t()}function d(e){var t=e.data.param1,n={notification_id:t},o="/api/header/readNotifications/";global.api(o,n,function(e){u(e)})}function u(e){var t=$(".header_cont_notafications_count").text();t--,t>0&&$(".header_cont_notafications_count").text(t)}this.ctor=e,this.getNotifcations=t}function loginJs(){function e(){$(".login_submit").click(o),$(".login_registerBtn").click(r),$(".register_submit").click(a),$(".login_input").keypress(n)}function t(){global.globalHide(),$(".global_pagesFixed").hide(),$(".global_page_login").show()}function n(e){13==e.which&&o()}function o(){$(".login_error").hide();var e=$(".login_input").eq(0).val(),t=$(".login_input").eq(1).val(),n={email:e,password:t},o="/api/users/login/";global.api(o,n,function(e){"badUserNameAndPass"==e?$(".login_error").show():($.cookie("session",e),location.href="/")})}function i(e){$.cookie("session",e),global.showDasInFirstTime=1,global.showDashboard(),global.getUser()}function r(){$(".login_register").fadeIn(),$(".login_holder").hide()}function a(){var e=1;$(".register_error").hide();var t=$(".register_input_userName").val(),n=$(".register_input_mail").val(),o=$(".register_input_password").val(),i=$(".register_input_passwordRepeat").val();l(n)||(alert("email not good"),e=0),t.length<3&&(alert("שם משתמש חייב להיות מעל 3 תווים"),e=0),n.length<4&&(alert("אימייל חייב להיות מעל 4 תווים"),e=0),o.length<3?(alert("סיסמא חייבת להיות מעל 3 תווים"),e=0):o!=i&&(alert("סיסמאות לא תואמות"),e=0),1==e&&s(t,n,o)}function s(e,t,n){var o={userName:e,email:t,password:n},r="/api/users/register/";global.api(r,o,function(e){"user exist"==e?alert("User Exist!"):i(e)})}function l(e){var t=/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/;return t.test(e)}this.ctor=e,this.showPage=t}function notebookJs(){function e(){}function t(){$(".global_page_map").hide(),$(".global_page_notebook").show(),global.resizePage()}function n(e){var t=e.length,n=$(".notebook_rowLoop:first").clone();$(".notebook_rowLoop").remove(),$(".notebook_row_prop").append(n);for(var i=0;t>i;i++){var n=$(".notebook_rowLoop:first").clone();n.find(".notebook_row_level span").text(e[i].level),e[i].inBuild?n.find(".notebook_row_status span").text("בבניה"):n.find(".notebook_row_status span").text("מוכן"),n.find("#notebook_row_buildingID").text(e[i].id);var r,a=e[i].type_id,s=e[i].level,l=help.orderStreetName(decodeURIComponent(e[i].street));r=buildingsJson.getImageUrl(a,s),a=buildingsJson.getBuildingName(a),n.find(".notebook_row_pic img").attr("src",r),n.find(".notebook_row_name span").text(a),n.find(".notebook_row_street span").text(l),n.find(".notebook_row_upgradeBtn").click({buildingId:e[i].id},o),$(".notebook_row_prop").append(n),n.show()}}function o(e){var t=e.data.buildingId;upgradeBuilding.showPage(t)}this.ctor=e,this.showPage=t,this.echoData=n}function warJs(){function e(){$(".war_grid_goBack").click(a),$(".war_startPage_searchBox_searchRandomRresturant").click(k),$(".war_mission10_text_submit").click(i),$(".war_mission10_textReturn_submit").click(n),$(".war_mission10_choosePrice_text_submit").click(o)}function t(){$(".war_cont").hide(),$(".global_page_map").hide(),$(".global_page_war").show(),$(".war_startPage").show(),$(".war_startPage_assets").hide(),$(".war_startPage_users").hide(),$(".war_startPage_searchBox").val(""),global.resizePage(),_(),10==$.globalUser.mentor?($(".notebookNav").removeClass("mentor_notBlock"),$(".war_mission10").addClass("mentor_notBlock"),$(".war_mission10_text").show(),clearInterval($.mentorHaz_level10_0),$(".notebookNav_mission10").hide(),clearInterval($.mentor_level10_hazMap),$(".map_mentor_level10Haz").hide()):($(".war_mission10").hide(),$(".war_mission10_text").hide())}function n(){$(".war_mission10_textReturn").hide(),clearInterval($.mentor_level10_hazReturn),$.mentor_level10_hazReturn=setInterval(function(){$(".war_mission10_return").fadeToggle(100)},500)}function o(){$(".war_mission10_choosePrice_text").hide(),clearInterval($.mentor_level10_hazReturn),$.mentor_level10_hazChoosePrice=setInterval(function(){$(".war_mission10_choosePrice").fadeToggle(100)},500)}function i(){$(".war_mission10_text").hide(),$(".war_startPage_searchBox_searchRandomRresturant").addClass("mentor_notBlock"),clearInterval($.mentorHaz_level10_1),$.mentorHaz_level10_1=setInterval(function(){$(".war_mission10").fadeToggle(100)},500)}function r(e,n){if(10==$.globalUser.mentor&&$(".war_mission10_textReturn").show(),t(),$(".war_startPage").hide(),null==n)$(".war_grid_title").hide(),$(".war_userCol").css("width","100%");else{$(".war_grid_title").show(),$(".war_userCol").css("width","48%"),$(".war_enemyCol").find(".war_grid_title").text(n.userName),$(".war_enemyCol").find(".war_grid_resturentIncome").text(help.addComma(e.profit)),$(".war_enemyCol").find(".war_grid_expense").text(help.addComma(n.bid));var o={store_id:n.store_id},i="/api/war/getFactoryBid/";global.api(i,o,function(t){x(JSON.parse(t),e.profit)})}$(".war_cont").show(),$(".war_title").find("span").text("רכישת לקוחות");var r,a=$.globalUserBuilding,s=$.globalUser.userName;$(".war_userCol").find(".war_grid_title").text(s),$(".war_grid_line_oneElement").hide(),"2"==e.type_id&&(r="3"),"6"==e.type_id&&(r="7");for(var l=0,c=0;c<a.length;c++)if(a[c].type_id==r){l=1;var d=$(".war_grid_line_oneElement:first").clone(),u=buildingsJson.getImageUrl(a[c].type_id,a[c].level),h=formulas.factoryCalculate(a[c].level,e.profit);d.find("img").attr("src",u),d.find(".war_grid_line_oneElement_text_beneift").text(help.addComma(h)),$(".war_grid_factoryLine").append(d),d.click({factory:a[c],resturant:e},p),d.show()}l||$(".war_userCol").find(".war_grid_description").html("!לא נמצאו מפעלים<br> בשביל לבצע מהפכה כלכלית, חובה לבנות מפעלים")}function a(){$(".war_holder").hide(),$(".war_startPage").show(),$(".war_startPage_assets").show()}function s(e,n){var o=formulas.factoryCalculate(e[3][0].level,e[2][0].profit);t(),$(".war_grid_title").hide(),$(".war_userCol").css("width","100%"),$(".war_cont").show(),$(".war_grid_line_oneElement").hide(),$(".war_grid_description").hide(),$(".war_startPage").hide(),$(".war_startPage_stickyNote_text").hide(),$(".war_startPage_stickyNote_player").hide(),$(".war_startPage_stickyNote_bid").show(),$(".war_grid_summ").show(),$(".war_title").find("span").text("רכישת לקוחות"),$(".war_grid_summ").find(".war_grid_description:first").text("צפייה בהצעת מחיר"),$(".war_grid_summ").find(".war_grid_description").show(),$(".war_userCol").find("input[type=range]").hide(),$(".war_grid_factoryDetails").hide(),$(".war_userCol").find(".war_grid_description").find("span").text(help.addComma(e[0][0].bid)),$(".war_userCol").find(".war_grid_factoryLevelColuc").text(help.addComma(o)),$(".war_userCol").find(".war_grid_resturentIncome").text(help.addComma(e[2][0].profit));var i=e[2][0].profit+o;$(".war_userCol").find(".war_grid_totalIcon").text(help.addComma(i)),$(".war_userCol").find(".war_grid_expense").text(help.addComma(e[0][0].bid));var r=i-e[0][0].bid;$(".war_userCol").find(".war_grid_totalProfit").text(help.addComma(r)),$(".war_grid_approveBtn").text("אישור להצעת המחיר"),$(".war_grid_approveBtn").click({reqId:n},l),$(".war_grid_cancelBtn").show(),$(".war_grid_cancelBtn").click({reqId:n},c)}function l(e){var t={notification_id:e.data.reqId},n="/api/war/comfirmReq/";global.api(n,t,function(e){u(e)})}function c(e){var t={notification_id:e.data.reqId},n="/api/war/cancelReq/";global.api(n,t,function(e){d(e)})}function d(e){"success"==e&&(global.globalHide(),global.showDashboard(),popup.showPage("סירבת להצעת המחיר"))}function u(e){"success"==e&&(global.globalHide(),global.showDashboard(),popup.showPage("הבקשה אושרה בהצלחה"))}function p(e){var t=e.data.factory,n=e.data.resturant,o=formulas.factoryCalculate(t.level,n.profit),i="0";$(".war_grid_line_oneElement_text").hide(),$(".war_userCol").find("input[type=range]").val(i),$(".war_grid_line_oneElement").removeClass("war_grid_line_oneElementActive"),$(this).addClass("war_grid_line_oneElementActive"),$(".war_grid_summ").show(),$(".war_userCol").find("input[type=range]").attr("max",o),$(".war_userCol").find(".war_grid_description").find("span").text(i),$(".war_userCol").find(".war_grid_expense").text(i),$(".war_userCol").find(".war_grid_factoryStreet").text(decodeURIComponent(t.street)),$(".war_userCol").find(".war_grid_factoryProfit").text(t.profit),$(".war_userCol").find(".war_grid_factoryLevel").text(t.level),$(".war_userCol").find(".war_grid_factoryLevelColuc").text(o),$(".war_userCol").find(".war_grid_resturentIncome").text(n.profit);var r=n.profit+o;$(".war_userCol").find(".war_grid_totalIcon").text(r),$(".war_userCol").find(".war_grid_totalProfit").text(r),$(".war_userCol").find("input[type=range]").on("change",function(){clearInterval($.mentor_level10_sendAttack),$.mentor_level10_sendAttack=setInterval(function(){$(".war_mission10_sendAttack").fadeToggle(100)},500),$(".war_mission10_choosePrice").hide(),clearInterval($.mentor_level10_hazChoosePrice),10==$.globalUser.mentor&&$(".war_grid_approveBtn").show(),i=$(".war_userCol").find("input[type=range]").val(),$(".war_userCol").find(".war_grid_description").find("span").text(i),$(".war_userCol").find(".war_grid_expense").text(i),totalProfit=r-i,$(".war_userCol").find(".war_grid_totalProfit").text(totalProfit)}),$(".war_grid_cancelBtn").hide(),$(".war_grid_approveBtn").css("margin-left","-100px"),$(".war_grid_approveBtn").click({storeId:n.id,factoryId:t.id,bid:i,maxRange:o},h),10==$.globalUser.mentor?(clearInterval($.mentor_level10_hazReturn),$(".war_mission10_return").hide(),$(".war_grid_approveBtn").hide(),$(".war_mission10_choosePrice_text").show()):$(".war_grid_approveBtn").show()}function h(e){10==$.globalUser.mentor&&(clearInterval($.mentor_level10_sendAttack),$(".war_mission10_sendAttack").hide(),mentor.updateMentor(),mentor.finishLevel10());var t=e.data.maxRange-$(".war_grid_descriptionEarn span").text(),n={my_building_id:e.data.factoryId,store_id:e.data.storeId,bid:t},o="/api/war/attack/";global.api(o,n,function(e){10!=$.globalUser.mentor&&f(e)})}function f(e){"ok"==e?(global.globalHide(),global.showDashboard(),popup.showPage("בקשה נשלחה בהצלחה"),vmap.closeFlow()):"error: you can send only one req"==e?valert.showPage("ניתן לשלוח רק בקשה אחת"):valert.showPage("לא ניתן לשלוח את הבקשה")}function _(){$(".war_startPage_searchBox").keypress(function(e){var t=e.keyCode?e.keyCode:e.which;if("13"==t){$(".war_startPage_users").hide(),$(".war_startPage_assets").hide();var n=$(".war_startPage_searchBox").val();n.length<2?valert.showPage("שם המשתמש חייב להיות גדול מ2"):m(n)}})}function m(e){var t={userName:e},n="/api/war/searchUser/";global.api(n,t,function(e){g(JSON.parse(e))})}function g(e){if($(".war_startPage_users_oneuser").hide(),0==e.length)valert.showPage("לא נמצאו משתמשים");else if(e.length>1){$(".war_startPage_users").show(),$(".war_startPage_users_title").text(":נמצאו"),$(".war_startPage_users_title").append(" <span></span> "),$(".war_startPage_users_title").append("משתמשים. בחר משתמש"),$(".war_startPage_users_title").find("span").text(e.length);
for(var t=0;t<e.length;t++){var n=$(".war_startPage_users_oneuser:first").clone();n.find(".war_startPage_users_oneuser_name").find("span").text(e[t].userName),n.find(".war_startPage_users_oneuser_rank").find("span").text(e[t].rank),n.find(".war_startPage_users_oneuser_profit").find("span").text(e[t].profit),$(".war_startPage_users").append(n),n.show(),n.click({data:e[t].id},v)}}else 1==e.length&&y(e[0].id)}function v(e){y(e.data.data)}function y(e){$(".war_startPage_users").hide();var e={user_id:e},t="/api/war/getUserRestuarants/";global.api(t,e,function(e){b(JSON.parse(e))})}function b(e){var t;if($(".war_startPage_stickyNote_text").hide(),$(".war_startPage_stickyNote_bid").hide(),$(".war_startPage_stickyNote_player").show(),$(".war_startPage_assets_resturents_oneBuilding").hide(),$(".war_startPage_assets_resturents_oneClient").hide(),$(".war_startPage_users").hide(),0==e[0].length)$(".war_startPage_assets_buildings_title").text("לא נמצאו מסעדות");else if(e[0].length>0){$(".war_startPage_assets").show();for(var n=0;n<e[0].length;n++){var o,i=$(".war_startPage_assets_resturents_oneBuilding:first").clone(),r=buildingsJson.getImageUrl(e[0][n].type_id,e[0][n].level);if(null==e[0][n].other)o="ללא",t=null;else for(var a=0;a<e[1].length;a++)e[1][a].factory_id==e[0][n].other&&(o=e[1][a].userName,t=e[1][a]);i.find(".war_startPage_assets_resturents_oneBuilding_pic").attr("src",r),i.find(".war_startPage_assets_resturents_oneBuilding_level").find("span").text(e[0][n].level),i.find(".war_startPage_assets_resturents_oneBuilding_profit").find("span").text(help.addComma(e[0][n].profit)),i.find(".war_startPage_assets_resturents_oneBuilding_street").find("span").text(decodeURIComponent(e[0][n].street)),i.find(".war_startPage_assets_resturents_oneBuilding_supplier").find("span").text(o),$(".war_startPage_assets_buildings").append(i),i.show(),i.click({data:e[0][n],bid:t},w)}}if(0==e[2].length)$(".war_startPage_assets_clients_title").text("לא נמצאו לקוחות");else if(e[2].length>0){$(".war_startPage_assets").show();for(var n=0;n<e[2].length;n++){for(var s,l=$(".war_startPage_assets_resturents_oneClient:first").clone(),r=buildingsJson.getImageUrl(e[2][n].type_id,e[2][n].level),a=0;a<e[4].length;a++)e[4][a].id==e[2][n].users_id&&(s=e[4][a].userName);l.find(".war_startPage_assets_resturents_oneClient_pic").attr("src",r),l.find(".war_startPage_assets_resturents_oneClient_profit").find("span").text(e[2][n].profit),l.find(".war_startPage_assets_resturents_oneClient_street").find("span").text(decodeURIComponent(e[2][n].street)),l.find(".war_startPage_assets_resturents_oneClient_client").find("span").text(s),$(".war_startPage_assets_clients").append(l),l.show(),l.click({data:e[2][n],bid:e[3][n]},w)}}}function w(e){var t=e.data.data,n=e.data.bid;$(".war_holder").show(),r(t,n)}function x(e,t){var n=e[0],o=formulas.factoryCalculate(n.level,t),i=t+o,r=$(".war_enemyCol").find(".war_grid_expense").text(),a=i-r;$(".war_enemyCol").find(".war_grid_factoryStreet").text(decodeURIComponent(n.street)),$(".war_enemyCol").find(".war_grid_factoryProfit").text(n.profit),$(".war_enemyCol").find(".war_grid_factoryLevel").text(n.level),$(".war_enemyCol").find(".war_grid_factoryLevelColuc").text(o),$(".war_enemyCol").find(".war_grid_totalIcon").text(i),$(".war_enemyCol").find(".war_grid_totalProfit").text(a)}function k(){var e={isRestuarant:1},t="/api/war/randomRestuarant/";global.api(t,e,function(e){B(JSON.parse(e))}),10==$.globalUser.mentor&&($(".mentor_block").hide(),clearInterval($.mentorHaz_level10_1),$(".war_mission10").hide())}function B(e){vmap.makeMapLarger();var t=e[0];vmap.zoomToMainBuilding(t.lng,t.lat),map_lookAround.sendCornersToAPI(),notebookNav.showMap(),setTimeout(function(){var e=[];vmap.map.eachLayer(function(t){e.push(t)});for(var n=0;n<e.length;n++)if("undefined"!=typeof e[n]._latlng){var o=e[n].getLatLng();t.lng==o.lat&&t.lat==o.lng&&e[n].openPopup()}},1e3),$(".map_randomClient").show(),10==$.globalUser.mentor?(clearInterval($.mentor_level10_hazMap),$.mentor_level10_hazMap=setInterval(function(){$(".map_mentor_level10Haz").fadeToggle(100)},500),$(".map_randomClient").hide()):$(".map_randomClient").show()}this.ctor=e,this.showPage=t,this.factoryForResturant=r,this.showRequest=s,this.getRandomRresutrant=k}function addBuildingJs(){function e(){$(".addBuilding_addNewHouse").click(s),$(document).click(n)}function t(){$(".global_page_addBuilding").show()}function n(e){"undefined"!=typeof e.target.className.split&&"addBuilding"!=e.target.className.split("_")[0]&&u()}function o(){$(".global_page_addBuilding").hide()}function i(){$(".addBuilding").addClass("addBuildingAddClass")}function r(){$(".addBuilding").removeClass("addBuildingAddClass")}function a(e){var t=e.length,n=$(".addBuilding_rowLoop:first").clone();$(".addBuilding_rowLoop").remove(),$(".addBuilding_row_prop").append(n);for(var o=0;t>o;o++){var n=$(".addBuilding_rowLoop:first").clone();n.find(".addBuilding_row_level span").text(e[o].level),e[o].inBuild?n.find(".addBuilding_row_status span").text("בבניה"):n.find(".addBuilding_row_status span").text("מוכן"),n.find("#addBuilding_row_buildingID").text(e[o].id);var i,r=e[o].type_id;e[o].level;r=buildingsJson.getBuildingName(r),n.find(".addBuilding_row_pic img").attr("src",i),n.find(".addBuilding_row_name span").text(r),$(".addBuilding_row_prop").append(n),n.show()}}function s(){$.globalUser.mentor<13&&(clearInterval($.addBuilding_mentorLevel3),$(".addBuilding_mentor_poniter").hide()),0==$(".addBuilding_add_iconsList").is(":visible")?(l($.globalUserBuilding),$(".addBuilding_addNewHouse_tooltip").show(),$(".map_larger").hide(),$(".map_smaller").hide()):u()}function l(e){for(var t,n=e.length,o=0;n>o;o++)0==e[o].type_id&&(t=e[o].level);t--;var i=$.building_main.building[t--].type;c(e,i)}function c(e,t){$(".addBuilding_add_iconsList").show(),$(".addBuilding_add_iconsList_oneIcon").hide();for(var n=[0,0,0,0,0,0,0,0,0,0],o=e.length,i=0;o>i;i++)isNaN(n[e[i].type_id])&&(n[e[i].type_id]=0),n[e[i].type_id]++;o=t.length;for(var i=0;o>i;i++){var r=$(".addBuilding_add_iconsList_oneIcon:first").clone(),a=t[i].type_id,s=buildingsJson.getJson(a),l=s.levels[0],c=t[i].number-n[a],u=help.addComma(l.price),h="",f=p(a);isNaN(c)&&(c=0),r.find(".addBuilding_add_iconsList_oneIcon_numLeft_built").text(n[a]),r.find(".addBuilding_add_iconsList_oneIcon_description").text(f),r.find(".addBuilding_add_iconsList_oneIcon_numLeft_built").text(n[a]),r.find(".addBuilding_add_iconsList_oneIcon_numLeft_left").text(t[i].number),r.find(".addBuilding_add_iconsList_oneIcon_name").text(buildingsJson.getBuildingName(a)),r.find(".addBuilding_add_iconsList_oneIcon_price").find("span").text(u),l.hours&&(h=l.hours+" שעות "),l.minutes&&(h=h+l.minutes+" דקות "),l.seconds&&(h=h+l.seconds+" שניות "),r.find(".addBuilding_add_iconsList_oneIcon_time").find("span").text(h),r.find("img").attr("src",l.img),1>c||3==$.globalUser.mentor&&2==a?(r.addClass("addBuilding_add_iconsList_oneIcon_grayFilter"),r.css("cursor","default")):r.click({buildingType:a,price:l.price},d),4!=a&&($(".addBuilding_add_iconsList").append(r),r.show())}var _=$.globalUser.mentor;if(3==_)clearInterval($.addBuilding_mentorLevel3_1),$.addBuilding_mentorLevel3_1=setInterval(function(){$(".addBuilding_mentor_level3_1").fadeToggle(100)},500);else if(5==_){var m=$(".addBuilding_add_iconsList_oneIcon").length-1;$(".addBuilding_add_iconsList_oneIcon:eq("+(m-1)+")").css("opacity","1"),clearInterval($.addBuilding_mentorLevel4),$.addBuilding_mentorLevel4=setInterval(function(){$(".addBuilding_mentor_level4").fadeToggle(100)},500)}else if(6==_){var m=$(".addBuilding_add_iconsList_oneIcon").length-1;$(".addBuilding_add_iconsList_oneIcon:eq("+(m-1)+")").css("opacity","1"),clearInterval($.addBuilding_mentorLevel3),$.addBuilding_mentorLevel3=setInterval(function(){$(".addBuilding_mentor_level3").fadeToggle(100)},500)}else 8==_?(clearInterval($.addBuilding_mentorLevel8),$.addBuilding_mentorLevel8=setInterval(function(){$(".addBuilding_mentor_level8").fadeToggle(100)},500)):$(".addBuilding_add_iconsList_oneIcon").css("opacity","1")}function d(e){$(".mentor_block").hide(),o(),clearInterval($.addBuilding_mentorLevel3),clearInterval($.addBuilding_mentorLevel4),clearInterval($.addBuilding_mentorLevel3_1),$(".addBuilding_mentor_level3").hide(),$(".addBuilding_mentor_level3_1").hide(),$(".addBuilding_mentor_level4").hide();var t=$(this).find("img").attr("src"),n=15;e.data.buildingType==n?map_realEstate.startFlow():(map_click.startChecking(t),vmap.buyHouseAlert(t,e.data.buildingType,e.data.price))}function u(){$(".addBuilding_add_iconsList").hide(),$(".addBuilding_addNewHouse_tooltip").hide(),$(".map_larger").show();var e=$.globalUser.mentor;2==e&&(clearInterval($.addBuilding_mentorLevel1),$(".addBuilding_mentor_level1").hide())}function p(e){var t;switch(e){case 1:t="מבנה קבע המשמש באופן שגרתי למגורי אדם";break;case 2:t="בית אוכל, מוסד המוכר מזון ומשקאות ";break;case 3:t="סדנת ייצור גדולה, שבה מייצרים מזון ";break;case 5:t="ביצוע ביקורת על דוחות כספיים ומתן חוות דעת";break;case 6:t="מקום מסחר קמעונאי המאחסן מוצרים הלבשה";break;case 7:t="סדנת ייצור גדולה, שבה מייצרים מוצרי הלבשה"}return t}this.ctor=e,this.showPage=t,this.hidePage=o,this.moveDown=i,this.moveUp=r,this.echoData=a,this.hideBuildings=u}function feedJs(){function e(){$(".feed_cont_replybox_btnBig").click(c),$(window).scroll(g),$(".feed_cont_sendBigMessage").click(a),$(".feed_cont, .feed_cont_sendBigMessage_close").click(s),$(".feed").click(o)}function t(){$(".global_page_feed").show(),d()}function n(){$(".global_page_feed").hide()}function o(){$("html, body").animate({scrollTop:"2000"},1e3)}function i(){var e=$(this);e.parent().parent().find(".feed_cont_replybox_hide").slideDown(),setTimeout(function(){e.hide()},200)}function r(){$(this).parent().parent().find(".feed_cont_replybox_hide").slideUp(),$(this).parent().parent().find(".feed_cont_replybox_text_replay").show()}function a(){0==v&&(setTimeout(function(){v=1},100),$(".feed_cont_replybox_inputBigMessage").focus(),$(".feed_cont_sendBigMessage_close").fadeIn(),$(".feed_cont_sendBigMessage").css("bottom","45px"))}function s(){1==v&&(setTimeout(function(){v=0},100),$(".feed_cont_replybox_textarea, .feed_cont_replybox_input").val(""),$(".feed_cont_sendBigMessage_close").fadeOut(),$(".feed_cont_sendBigMessage").css("bottom","-120px"))}function l(){$(".feed_cont_replybox_miniError").hide();var e=$(this).parent().parent().parent().find(".feed_cont_oneMessage_id").text(),t=global.formatDate(new Date),n=$(this).parent().find(".feed_cont_replybox_input_addSmallMessage").val();n=encodeURIComponent(n);var o=$(this).parent().find(".feed_cont_replybox_textarea1").val();if(o=encodeURIComponent(o),n.length<3)$(".feed_cont_replybox_miniError").show();else{$(".feed_cont_replybox_miniError").hide();var i={id:e,title:n,text:o,date:t},r="/api/feed/addSmallMessage/";global.api(r,i,function(e){d()})}}function c(){$(".feed_cont_replybox_error").hide();var e=global.formatDate(new Date),t=encodeURIComponent($(".feed_cont_replybox_inputBigMessage").val()),n=encodeURIComponent($(".feed_cont_replybox_textarea2").val()),o={title:t,text:n,date:e};if(t.length<3)$(".feed_cont_replybox_error").show();else{$(".feed_cont_replybox_error").hide();var i="/api/feed/addBigMessage/";global.api(i,o,function(e){d(),s()})}}function d(){var e={},t="/api/feed/getFeed/";global.api(t,e,function(e){var t=JSON.parse(e);y=t[1],p(t[0])})}function u(e){for(var t=y,n=t.length,o=0;n>o;o++)if(t[o].id==e)return 1;return 0}function p(e){var t=e.length,n=$(".feed_cont_oneMessage:first").clone();$(".feed_cont_oneMessage").remove(),$(".feed_cont").append(n);for(var o=0;t>o;o++){var n=$(".feed_cont_oneMessage:first").clone(),a=decodeURIComponent(e[o].title),s=decodeURIComponent(e[o].text),c=_(e[o].date),d=u(e[o].id);n.find(".feed_cont_replybox_data_date_text").text(c),n.find(".feed_cont_oneMessage_autherName").text(e[o].userName),n.find(".feed_cont_oneMessage_title_text").text(a),n.find(".feed_cont_replybox_text").text(s),n.find(".feed_cont_oneMessage_id").text(e[o].id),n.find(".feed_cont_oneMessage_autherDetails").text("[תאגיד: "+e[o].companys_name+"]"),n.find(".feed_cont_oneMessage_numOfThumbs").text(e[o].likes),null==e[o].companys_name&&n.find(".feed_cont_oneMessage_autherDetails").hide();var p=25*e[o].num;n.css("padding-right",p+"px"),0==e[o].small_id&&(n.css("margin-top","18px"),n.find(".feed_cont_oneMessage_title").addClass("feed_cont_oneMessage_titleAddClass"),n.find(".feed_cont_oneMessage_numOfComments").text(e[o].comments),n.find(".feed_cont_comments_btn").show(),2==$.globalUser.admin&&n.find(".feed_cont_replybox_text_trashHolder").show());var g=o+1;g>t&&(g=o),$(".feed_cont").append(n),n.show(),1==d&&n.find(".feed_cont_comments_btn_likeIcon").addClass("feed_cont_comments_btn_likeIconAddClass")}$(".feed_cont_btnSmall").blur("click"),$(".feed_cont_btnSmall").click(l),$(".feed_cont_oneMessage_title").blur("click"),$(".feed_cont_oneMessage_title").click(m),$(".feed_cont_replybox_text_replay").blur("click"),$(".feed_cont_replybox_text_replay").click(i),$(".feed_cont_replybox_hide_close").blur("click"),$(".feed_cont_replybox_hide_close").click(r),$(".feed_cont_replybox_text_trash").blur("click"),$(".feed_cont_replybox_text_trash").click(f),$(".feed_cont_like_btn").blur("click"),$(".feed_cont_like_btn").click(h)}function h(){var e=$(this).parent().parent().find(".feed_cont_oneMessage_id").text(),t="/api/feed/doLike/",n={feed_id:e},o=$(this);0==u(e)&&global.api(t,n,function(e){var t=parseInt(o.find(".feed_cont_oneMessage_numOfThumbs").text())+1;$(".feed_cont_oneMessage_numOfThumbs").text(t),o.find(".feed_cont_comments_btn_likeIcon").addClass("feed_cont_comments_btn_likeIconAddClass");var n=JSON.parse(e);p(n)})}function f(){var e=$(this).parent().parent().parent().parent().find(".feed_cont_oneMessage_id").text(),t="/api/feed/deleteComment/",n={msg_id:e};global.api(t,n,function(e){var t=JSON.parse(e);y=t[1],p(t[0])})}function _(e){var e=new Date(e),t=e.getFullYear(),n=e.getMonth(),o=e.getDate(),i=e.getHours(),r=e.getMinutes(),a=i+":"+r+" "+o+"/"+n+"/"+t;return a}function m(){$(this).parent().find(".feed_cont_replybox").slideToggle()}function g(){var e=$(window).scrollTop()-b;e>200&&250>e?$(".global_pagesFixed").css("-webkit-filter","blur(1px)"):e>249&&300>e?$(".global_pagesFixed").css("-webkit-filter","blur(2px)"):e>299&&400>e?$(".global_pagesFixed").css("-webkit-filter","blur(3px)"):e>399&&500>e?$(".global_pagesFixed").css("-webkit-filter","blur(4px)"):e>499?$(".global_pagesFixed").css("-webkit-filter","blur(5px)"):$(".global_pagesFixed").css("-webkit-filter","blur(0px)")}this.ctor=e,this.showPage=t,this.hidePage=n;var v=0,y={},b=$(window).scrollTop()}function vmapJs(){function e(e){n(e),$(".map_randomClient_cancel").click(y),$(".map_randomClient_search").click(war.getRandomRresutrant),$(".map_larger").click(T),$(".map_smaller").click(N),$(".map_zoomToMain").click(C)}function t(){$(".global_page_notebook").hide(),$(".global_page_map").show(),"undefined"!=typeof j&&setTimeout(function(){j._onResize()},500)}function n(e){L.mapbox.accessToken="pk.eyJ1Ijoia3lkb3MiLCJhIjoiZDA3OGZlZmIzOGMxOGEwZDg5OTRkNzYzNWM5MjQ0OTUifQ.DvOaW0Br9Ulgv0u11h1inw",j=L.mapbox.map("mapbox","kydos.e6192ac7").setView([32.0853,34.781668],13),J(),"undefined"==typeof e?mapLayer=L.mapbox.featureLayer().addTo(j):mapLayer=L.mapbox.featureLayer().addTo(j),vmap.map=j}function o(){j.setView([31.8297,34.9717],9),i()}function i(){r()}function r(){var e={country:1},t="/api/map/showCity/";global.api(t,e,function(e){var t=JSON.parse(e),n=new Array;a(t.length,t,n)})}function a(e,t,n){for(var o=0;e>o;o++)n[o]=L.mapbox.featureLayer();for(var o=0;e>o;o++){var i=JSON.parse(t[o].geoJson);n[o].setGeoJSON(i),n[o].addTo(j),s(n[o])}}function s(e){e.on("click",function(t){var n=(t.target._geojson.features,t.latlng);l(n,e)})}function l(e,t){j.setView([e.lat,e.lng],15);var n=t._geojson;n.features[0].properties.fill="none",n.features[0].properties.stroke="#FF0000",t.setGeoJSON(n),notebook.addCity(n.features[0].properties.name)}function c(){$(".map_controls_searchInput").fadeIn(),d()}function d(){$("#map_searchInput").bind("enterKey",function(e){var t=$("#map_searchInput").val();u(t)}),$("#map_searchInput").keyup(function(e){13==e.keyCode&&$(this).trigger("enterKey")})}function u(e){var t={country:1,street:e},n="/api/map/showStreet/";global.api(n,t,function(e){var t=JSON.parse(e);p(t)})}function p(e){var t=e[0].id;$(".map_userStreetID").text(t);for(var n=JSON.parse("["+e[0].geoJson+"]"),o=0;o<n.length;o++)n[o].properties["stroke-width"]="5";h(n),f(e[0].street)}function h(e){console.log(e),streetLayer=L.mapbox.featureLayer(),streetLayer.setGeoJSON(e),streetLayer.addTo(j),$(".StreetGeoJson").text(e),streetLayer.on("click",function(e){var t=e.layer.feature;addHouseIcon(t)}),_(e)}function f(e){var t=confirm("לקנות את רחוב "+e+"?");1==t?(alert("קנית"),k()):alert("לא קנית")}function _(e){var t=e[0].geometry.coordinates[0][0],n=e[0].geometry.coordinates[0][1];j.setView([n,t],16)}function m(e,t,n){function o(){c=g(),0==c&&valert.showPage("אי אפשר לבנות על כבישים!"),0==s&&1==l&&1==c&&(map_findStreetName.geocodeLatLng(map_findStreetName.geocoder,map_findStreetName.map,map_findStreetName.infowindow,a,t,e),s++,map_click.stopChecking())}S(),T(),A();var i=buildingsJson.getMainBuilding();if(console.log(i),"0"==i){var r=$.globalUserCity[0].city;"telAviv"==r&&R(),"jerusalem"==r&&M()}var a={},s=(document.getElementById("click"),0),l=0,c=0;j.on("click",function(e){var t=$(".leaflet-popup-content").css("width");"undefined"==typeof t&&(a[1]=e.latlng.lat,a[0]=e.latlng.lng,l=1,o())});map_click.canBuild}function g(){var e=$("#curser_tail").css("border");return console.log(e),"1px solid rgb(255, 0, 0)"==e?0:1}function v(e,t,n,o){var i=JSON.parse(o);if("-1"==o)var r="-1";else var r=encodeURIComponent(i[1].long_name);var a=buildingsJson.getJson(t),s=j.getZoom(),l=L.mapbox.featureLayer(),c=[{type:"Feature",geometry:{type:"Point",coordinates:[e[0],e[1]]},properties:{title:t,icon:{iconUrl:n,iconSize:[4*s,4*s]}}}];l.on("layeradd",function(e){var t=e.layer,n=t.feature;t.setIcon(L.icon(n.properties.icon))}),l.setGeoJSON(c),l.addTo(j),(1==t||2==t||6==t||3==t||7==t)&&map_relationship.showPage(e[0],e[1],r,a.levels[0].profit,t);var a=buildingsJson.getJson(t),d='<div class="map_popup"><div class="map_popup_buildingID">'+buildingsJson.getBuildingName(t)+"</div><h2>האם אתה רוצה לבנות?</h2>מחיר: "+help.addComma(a.levels[0].price)+"<br>זמן סיום: "+buildingsJson.getTime(t,1)+'<br><div class="map_popup_approve">קנה</div><div class="map_popup_cancel">בטל</div></div>';l.bindPopup(d,{closeButton:!1,closeOnClick:!1}),l.openPopup(),l.on("popupclose",function(){l.bindPopup(d,{closeButton:!1,closeOnClick:!1}),l.openPopup()}),j.setView([e[1],e[0]]),j.tap&&j.tap.disable(),j.boxZoom.disable(),j.keyboard.disable(),$(".leaflet-control-zoom").css("visibility","hidden"),j.dragging.disable(),j.touchZoom.disable(),j.doubleClickZoom.disable(),j.scrollWheelZoom.disable(),$(".map_note").hide(),$(".map").off("click",".map_popup_approve"),$(".map").on("click",".map_popup_approve",function(){map_relationship.deleteArchLayer(),$(".map_cssicon").hide();var i=$.globalUserCity[0];$.getJSON("/cities/"+i.city+".geojson",function(i){var r=L.geoJson(i),s=leafletPip.pointInLayer([e[0],e[1]],r);s.length?(j.removeLayer(l),y(),B(e,t,o,function(o){"error: you dont have enough office level"==o?valert.showPage("ניתן לבנות רק מבנה אחד בכל זמן נתון"):"error: you dont have money"==o?valert.showPage("אין לך מספיק כסף"):x(e,t,n)})):(valert.showPage("אי אפשר לבנות מחוץ לעיר"),j.removeLayer(l),b(),m(n,t,a.levels[0].price))})}),$(".map").off("click",".map_popup_cancel"),$(".map").on("click",".map_popup_cancel",function(){j.removeLayer(l),b(),m(n,t,a.levels[0].price),map_relationship.deleteArchLayer(),map_click.startChecking(n),$(".map_cssicon").hide()})}function y(){map_click.stopChecking(),N(),j.closePopup(),j.boxZoom.enable(),j.keyboard.enable(),$(".leaflet-control-zoom").css("visibility","show"),j.tap&&j.tap.enable(),j.dragging.enable(),j.touchZoom.enable(),j.doubleClickZoom.enable(),j.scrollWheelZoom.enable(),j.on("click",function(e){})}function b(){map_lookAround.showBuildingsOnTheMap(),$(".map_note").show(),j.closePopup(),j.boxZoom.enable(),j.keyboard.enable(),$(".leaflet-control-zoom").css("visibility","show"),j.tap&&j.tap.enable(),j.dragging.enable(),j.touchZoom.enable(),j.doubleClickZoom.enable(),j.scrollWheelZoom.enable()}function w(e){var t=20-e;if(19==e)var n=100;else var n=100/t;return n}function x(e,n,o,i,r){for(var a=0,s=$.globalUserBuilding,l=0;l<s.length;l++)("3"==s[l].type_id||"7"==s[l].type_id)&&(a=1);var c=1,d=[];j.eachLayer(function(e){d.push(e)});for(var l=0;l<d.length;l++)if("undefined"!=typeof d[l]._latlng){var u=d[l].getLatLng();e[1]==u.lat&&e[0]==u.lng&&(c=0)}if(c){var p=j.getZoom(),h=L.mapbox.featureLayer(),f=w(p);if(p>15){var _=[{type:"Feature",geometry:{type:"Point",coordinates:[e[0],e[1]]},properties:{title:n,icon:{iconUrl:o,iconSize:[f,f]}}}];h.on("layeradd",function(e){var t=e.layer,n=t.feature;t.setIcon(L.icon(n.properties.icon))}),h.setGeoJSON(_),h.addTo(j)}else if("undefined"!=typeof r&&r.users_id==$.globalUser.id){var _=[{type:"Feature",geometry:{type:"Point",coordinates:[e[0],e[1]]},properties:{title:n,"marker-color":"#000"}}];h.setGeoJSON(_),h.addTo(j)}if(void 0===r){var m='<div class="map_popup"><div class="map_popup_buildingID"></div><h2> הבית בבנייה </h2></div>';h.bindPopup(m)}if("undefined"!=typeof r&&r.users_id==$.globalUser.id){if("undefined"!=typeof r)if("0"==r.inBuild){var g=buildingsJson.getBuildingName(r.type_id);if(-1==r.street&&(r.street="ללא רחוב"),E(r.type_id)&&a)var m='<div class="map_popup"><div class="map_popup_buildingID" style="display:none">'+r.id+"</div><h2>"+g+"</h2>רמה: "+r.level+"<br>רווח: "+help.addComma(r.profit)+"<br>רחוב: "+decodeURIComponent(r.street)+'<br><div class="map_popup_upgradeBtn">שדרג</div><div class="map_popup_resturantFactoryWar">רכוש לקוח</div></div>';else var m='<div class="map_popup"><div class="map_popup_buildingID" style="display:none">'+r.id+"</div><h2>"+g+"</h2>רמה: "+r.level+"<br>רווח: "+help.addComma(r.profit)+"<br>רחוב: "+decodeURIComponent(r.street)+'<br><div class="map_popup_upgradeBtn">שדרג</div></div>';7==$.globalUser.mentor&&0==r.type_id&&(h.bindPopup(m,{closeButton:!1,closeOnClick:!1}),h.on("popupclose",function(){h.bindPopup(m,{closeButton:!1,closeOnClick:!1}),h.openPopup()}));var v='<div class="map_userCircle_child"></div>',e={};e[0]=r.lat,e[1]=r.lng;var y=L.divIcon({className:"map_userCircle_father",html:v,iconSize:[20,20]}),b=$(".map_userCircle_father").css("z-index");if($(".map_userCircle_father").css("z-index",b-1),L.marker([e[1],e[0]],{icon:y}).addTo(vmap.map),H(f),O(r)){var v="▲",e={};e[0]=r.lat,e[1]=r.lng;var y=L.divIcon({className:"map_cssupgrade",html:v,iconSize:[20,20]});L.marker([e[1],e[0]],{icon:y}).addTo(vmap.map),D(f)}h.bindPopup(m),h.on("click",function(e){$(".map_cssicon").hide(),map_relationship.deleteArchLayer(),$(".leaflet-popup-content").is(":visible")?(1==r.type_id||2==r.type_id||6==r.type_id||3==r.type_id||7==r.type_id)&&map_relationship.showPage(r.lat,r.lng,r.street,r.profit,r.type_id,r.id):($(".map_cssicon").hide(),map_relationship.deleteArchLayer())}),h.on("click",function(e){7==$.globalUser.mentor&&(clearInterval($.addBuilding_mentorLevel5),clearInterval($.addBuilding_mentorLevel5_1),$(".map_mentor_level5").hide(),$.addBuilding_mentorLevel5_1=setInterval(function(){$(".map_mentor_level5_1").fadeToggle(100)},500))}),$(".map").off("click",".map_popup_upgradeBtn"),$(".map").on("click",".map_popup_upgradeBtn",function(){var e=$(this);clearInterval($.addBuilding_mentorLevel5_1),$(".map_mentor_level5_1").hide(),7==$.globalUser.mentor&&($.addBuilding_mentorLevel5_3=setInterval(function(){$(".upgradeBuilding_holder_level5_3").fadeToggle(100)},500)),U(e)})}else{var x,g=buildingsJson.getBuildingName(r.type_id),k=$.globalUserOnBuildingProcess;-1==r.street&&(r.street="ללא רחוב");for(var l=0;l<k.length;l++)k[l].usersBuildings_id==r.id&&(x=k[l].dateEnd);var m='<div class="map_buildingProcess"><div class="map_popup_buildingID" style="display:none">'+r.id+"</div><h2>!בבניה</h2><h2>"+g+"</h2>"+decodeURIComponent(r.street)+" :רחוב <br></div>";h.bindPopup(m)}}else if("undefined"!=typeof r){var B=r.companys_name;if(null==B&&(B=""),-1==r.street&&(r.street="ללא רחוב"),2==r.type_id&&1==a){var m='<div class="map_popup"><h2>'+buildingsJson.getBuildingName(r.type_id)+"</h2>רמה: "+r.level+"<br>רווח: "+help.addComma(r.profit)+"<br>רחוב: "+decodeURIComponent(r.street)+'<br><div class="map_popup_resturantFactoryWar">רכוש לקוח</div><div class="map_popup_showUserBtn">'+r.userName+"</div>";B.length>0,$(".map").off("click",".map_popup_resturantFactoryWar"),$(".map").on("click",".map_popup_resturantFactoryWar",function(){war.factoryForResturant(r)})}else{var m='<div class="map_popup"><h2>'+buildingsJson.getBuildingName(r.type_id)+"</h2>רמה: "+r.level+"<br>רווח: "+help.addComma(r.profit)+"<br>רחוב: "+decodeURIComponent(r.street)+'<br><div class="map_popup_showUserBtn">'+r.userName+"</div>";B.length>0}h.bindPopup(m),h.on("click",function(e){map_relationship.deleteArchLayer(),$(".map_cssicon").hide()}),$(".map").off("click",".map_popup_showUserBtn"),$(".map").on("click",".map_popup_showUserBtn",function(){profile.showPage(r.users_id)}),$(".map").off("click",".map_popup_showClanBtn"),$(".map").on("click",".map_popup_showClanBtn",function(){t.showPage(r.companys_id)})}if("undefined"==r){var m='<div class="map_popup"><div class="map_popup_buildingID">הבניין עדיין לא מוכן</div></div>';h.bindPopup(m)}}}function k(){var e=$("#map_streetName").val();if(e.length>0){var t=$(".map_userStreetID").text(),n={country:1},o="/api/buy/addStreet//?cityId=2&cityName=telAviv&streetId="+t;global.api(o,n,function(e){JSON.parse(e);notebook.getData(),map_lookAround.showBuildingsOnTheMap()})}}function B(e,t,n,o){var i,r,a,s,l,c=JSON.parse(n);if("-1"==n?(i="-1",r="-1",a="-1",s="-1",l="-1"):(i=encodeURIComponent(c[0].long_name),r=encodeURIComponent(c[1].long_name),a=encodeURIComponent(c[2].long_name),s=encodeURIComponent(c[3].long_name),l=encodeURIComponent(c[4].long_name)),4==t)var d=$(".company_new_holder_input_companyName").val(),u={companyName:d,streetNumber:i,streetName:r,cityName:a,DistrictName:s,CountryName:l,vtype:t,lat:e[0],lng:e[1]};else var u={streetNumber:i,streetName:r,cityName:a,DistrictName:s,CountryName:l,vtype:t,lat:e[0],lng:e[1]};var p="/api/buy/addNewBuilding/";global.api(p,u,function(e){o(e);var t=$.globalUser.mentor;2==t&&mentor.finishLevel2(),3==t?mentor.finishLevel3():5==t?mentor.finishLevel5():7==t?mentor.finishLevel7():8==t&&mentor.finishLevel8(),global.getUser()})}function C(){var e=buildingsJson.getMainBuilding();P(e.lng,e.lat,18)}function P(e,t){j._onResize(),j.setView([e,t],18),map_lookAround.sendCornersToAPI()}function I(){j.tap&&j.tap.disable(),j.boxZoom.disable(),j.keyboard.disable(),$(".leaflet-control-zoom").css("visibility","hidden"),j.dragging.disable(),j.touchZoom.disable(),j.doubleClickZoom.disable(),j.scrollWheelZoom.disable(),$(".map_note").hide()}function U(e){var t=e.parent().find(".map_popup_buildingID").text();upgradeBuilding.showPage(t)}function T(){$(".map_larger").hide(),$(".map_smaller").show(),$(".map_searchBox").show(),$(".map_searchBox").attr("placeholder","חפש כתובת"),$(".map_goToNotebook").hide(),$(".global_page_map").css("-webkit-filter","blur(0px)"),$(".notebookNav").hide(),addBuilding.moveDown(),$(".map").addClass("mapLarger"),setTimeout(function(){j._onResize()},100),setTimeout(function(){j._onResize()},200),setTimeout(function(){j._onResize()},300),setTimeout(function(){j._onResize()},400),setTimeout(function(){j._onResize()},500),setTimeout(function(){j._onResize(),map_click.createCanvas()},600),$.globalUser.mentor<13?$(".map_smaller, .addBuilding").hide():$(".map_smaller, .addBuilding").show()}function N(){$(".map_smaller").hide(),$(".map_searchBox").hide(),$(".map_larger").show(),$(".map_goToNotebook").show(),$(".addBuilding").show(),addBuilding.showPage(),addBuilding.moveUp(),$(".map").removeClass("mapLarger"),$(".map_note").hide(),$(".map_note_realEstate").hide(),$(".map_randomClient").hide(),setTimeout(function(){j._onResize()},100),setTimeout(function(){j._onResize()},200),setTimeout(function(){j._onResize()},300),setTimeout(function(){j._onResize()},400),setTimeout(function(){j._onResize()},500),setTimeout(function(){j._onResize(),$(".notebookNav").show()},600)}function A(){addBuilding.hideBuildings(),$(".map_note").show(),$(".map_note_cancel").click(y),$.globalUser.mentor<13?$(".map_note_cancel").hide():$(".map_note_cancel").show()}function S(){j.eachLayer(function(e){if(e.feature){var t=e.feature.name;"undefined"!=typeof t&&j.removeLayer(e)}})}function R(){var e=[{x:"32.089588",y:"34.7774925"},{x:"32.0887071",y:"34.792085"},{x:"32.0887071",y:"34.792085"},{x:"32.0958446",y:"34.7766366"},{x:"32.1154574",y:"34.7966502"},{x:"32.0946226",y:"34.7984124"},{x:"32.0599972",y:"34.7706164"},{x:"32.0541617",y:"34.7688156"},{x:"32.0477956",y:"34.7505092"}],t=e[Math.floor(Math.random()*e.length)];P(t.x,t.y,15)}function M(){var e=[{x:"31.7719645",y:"35.2141375"},{x:"31.7850746",y:"34.792085"},{x:"31.7721321",y:"35.2158639"},{x:"31.7731655",y:"35.2182617"},{x:"31.7796353",y:"35.2242318"},{x:"31.7897382",y:"35.2207928"},{x:"31.7570726",y:"35.1809898"},{x:"31.7841211",y:"35.2142722"},{x:"31.7893696",y:"35.2366359"}],t=e[Math.floor(Math.random()*e.length)];P(t.x,t.y,15)}function J(){for(var e=$.globalUserBuilding,t=new L.featureGroup,n=0;n<e.length;n++){var o=L.mapbox.featureLayer();o.setGeoJSON({type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[e[n].lat,e[n].lng]},properties:{}}]}),t.addLayer(o),j.fitBounds(t.getBounds())}}function O(e){var t=buildingsJson.getJson(e.type_id);return t=t.levels[e.level+1],$.globalUser.money<t.price?0:$.globalUserOnBuildingProcess.length>=$.globalUser.officeLevel?0:1}function E(e){var t=0;switch(e){case 2:t=1;break;case 6:t=1}return t}function H(e){$(".map_userCircle_child").css("width",e),$(".map_userCircle_child").css("height",e),e>20?("100"==e&&($(".map_userCircle_child").css("margin-left","-45px"),$(".map_userCircle_child").css("margin-top","-20px")),"50"==e&&($(".map_userCircle_child").css("margin-left","-18px"),$(".map_userCircle_child").css("margin-top","2px")),"33.333333333333336"==e&&($(".map_userCircle_child").css("margin-top","2px"),$(".map_userCircle_child").css("margin-left","-10px")),"25"==e&&($(".map_userCircle_father").hide(),$(".map_userCircle_child").hide())):($(".map_userCircle_father").hide(),$(".map_userCircle_child").hide())}function D(e){e>20?("100"==e&&$(".map_cssupgrade").css("margin-left","50px"),"50"==e&&$(".map_cssupgrade").css("margin-left","25px"),"33.333333333333336"==e&&($(".map_cssupgrade").css("margin-left","17px"),$(".map_cssupgrade").css("margin-top","-5px")),"25"==e&&$(".map_cssupgrade").hide()):$(".map_cssupgrade").hide()}var j;this.ctor=e,this.showPage=t,this.chooseCity=o,this.buyStreets=c,this.drawStreetGeoJson=h,this.buyHouseAlert=m,this.buildingMarker=v,this.closeFlow=y,this.continueFlow=b,this.markerSize=w,this.placeMarker=x,this.sendHouseToApi=B,this.zoomToMainBuilding=P,this.disableMove=I,this.makeMapLarger=T,this.makeMapSmaller=N,this.showNote=A,this.deleteCityGeoJson=S}function map_lookAroundJs(){function e(){}function t(){n(),vmap.map.on("zoomend",function(){var e=vmap.map.getZoom();if(vmap.map.eachLayer(function(e){e._icon?vmap.map.removeLayer(e):e.feature}),vmap.map.eachLayer(function(e){e._popupContent||e._icon||!e._latlngs||"green"==e.options.color||vmap.map.removeLayer(e)}),16>e){var t,o=$.globalUserCity[0];t="undefined"==typeof o?L.mapbox.featureLayer().addTo(vmap.map):L.mapbox.featureLayer().loadURL("/cities/"+o.city+".geojson").addTo(vmap.map),t.addTo(vmap.map)}n()}),vmap.map.on("dragstart",function(){$(".map_cssicon").hide(),map_relationship.deleteArchLayer(),1==r&&n()}),vmap.map.on("dragend",function(){$(".map_cssicon").hide(),map_relationship.deleteArchLayer(),1==r&&n()})}function n(){
var e=vmap.map.getBounds(),t=e.getWest(),n=e.getSouth(),i=e.getEast(),r=e.getNorth(),a={west:t,south:n,east:i,north:r},s="/api/map/showBuildings/";global.api(s,a,function(e){var t=JSON.parse(e);o(t)})}function o(e){if(vmap.map.getZoom()>15)for(var t=e.length,n=0;t>n;n++){var o,i=[e[n].lat,e[n].lng],r=e[n].type_id,a=e[n].level,s=buildingsJson.getJson(r);a-=1,s=s.levels[a],o=s.img,vmap.placeMarker(i,r,o,s,e[n])}else{e=$.globalUserBuilding;for(var t=e.length,n=0;t>n;n++){var o,i=[e[n].lat,e[n].lng],r=e[n].type_id,a=e[n].level,s=buildingsJson.getJson(r);a-=1,s=s.levels[a],o=s.img,vmap.placeMarker(i,r,o,s,e[n])}}}function i(){vmap.map.eachLayer(function(e){e._icon&&vmap.map.removeLayer(e)})}var r=1;this.boolLookAround=r,this.ctor=e,this.showPage,this.showBuildingsOnTheMap=t,this.sendCornersToAPI=n,this.removeMarkers=i}function map_findStreetNameJs(){function e(){}function t(){var e=new google.maps.Map(document.getElementById("map_googleMaps"),{center:{lat:40.731,lng:-73.997},zoom:8,mapTypeId:google.maps.MapTypeId.ROADMAP}),t=document.getElementById("map_searchBox_locations"),n=new google.maps.places.SearchBox(t);n.addListener("places_changed",function(){var e=n.getPlaces();0!=e.length&&e.forEach(function(e){vmap.zoomToMainBuilding(e.geometry.location.lat(),e.geometry.location.lng())})}),geocoder=new google.maps.Geocoder,infowindow=new google.maps.InfoWindow,this.geocoder=geocoder,this.map=e,this.infowindow=infowindow}function n(e,t,n,o,i,r){var a=buildingsJson.getJson(i),s={lat:parseFloat(o[1]),lng:parseFloat(o[0])};e.geocode({location:s},function(e,t){if("OK"==t)if("street_address"==e[0].types[0]){var n=JSON.stringify(e[0].address_components);vmap.buildingMarker(o,i,r,n)}else vmap.buildingMarker(o,i,r,-1);else console.log(e[0].types[0]),$("#map_streetName").val(),$("#map_clickedLatLng").val(),valert.showPage("אי אפשר לבנות כאן"),vmap.buyHouseAlert(r,i,a.levels[0].price)})}this.ctor=e,this.initMap=t,this.geocodeLatLng=n}function map_clickJs(){function e(){}function t(e){d(e),h=1,vmap.map.on("zoomend",function(){1==h&&($(".map img").unbind("mousemove"),c(),u(),d(e))}),vmap.map.on("dragend",function(){1==h&&($(".map img").unbind("mousemove"),c(),u(),d(e))}),u()}function n(){h=0,vmap.map.off("click"),$(".map img").unbind("mousemove"),$("#mapbox").css("cursor","default"),$("#curser_tail").hide()}function o(e,t,n){_=[],f=0;var o=s(t),a=e.pageX-o.x,l=e.pageY-o.y;$("#mapbox").offset();a=e.pageX,l=e.pageY,i(a,l,t),r(n)}function i(e,t,n){var o=vmap.map.getZoom(),i=vmap.markerSize(o),r=i/2;r/=20-o,a(e,t,n),a(e+r,t+r,n),a(e-r,t+r,n),a(e+r,t-r,n),a(e,t+r,n),a(e+r,t,n),a(e,t-r,n),a(e-r,t,n),a(e-r,t-r,n),a(e+r/2,t+r/2,n),a(e-r/2,t+r/2,n),a(e+r/2,t-r/2,n),a(e,t+r/2,n),a(e+r/2,t,n),a(e,t-r/2,n),a(e-r/2,t,n),a(e-r/2,t-r/2,n),r=$("#curser_tail").width()/2,r/=20-o,a(e,t,n),a(e+r,t+r,n),a(e-r,t+r,n),a(e+r,t-r,n),a(e,t+r,n),a(e+r,t,n),a(e,t-r,n),a(e-r,t,n),a(e-r,t-r,n),a(e+r/2,t+r/2,n),a(e-r/2,t+r/2,n),a(e+r/2,t-r/2,n),a(e,t+r/2,n),a(e+r/2,t,n),a(e,t-r/2,n),a(e-r/2,t,n),a(e-r/2,t-r/2,n)}function r(e){var t=_.length;p=1;for(var n=0;t>n;n++){var o=_[n];("#ffffff"==o||"#73b6e6"==o)&&(p=0)}e(1==p?1:0)}function a(e,t,n){e=e,t=t;var o=$("#map_canvas")[0].getContext("2d"),i=o.getImageData(e,t,1,1).data,r="#"+("000000"+l(i[0],i[1],i[2])).slice(-6);_[f]=r,f++,"undefined"!=typeof $.context}function s(e){var t=0,n=0;if(e.offsetParent){do t+=e.offsetLeft,n+=e.offsetTop;while(e=e.offsetParent);return{x:t,y:n}}}function l(e,t,n){if(e>255||t>255||n>255)throw"Invalid color component";return(e<<16|t<<8|n).toString(16)}function c(){var e=$("#mapbox").find(".leaflet-tile-loaded").length,t=document.getElementById("map_canvas"),n=t.getContext("2d");n.clearRect(0,0,t.width,t.height);for(var o=0;e>o;o++){var i=new Image,r=$("#mapbox").find(".leaflet-tile-loaded").eq(o).offset().left-$(window).scrollLeft(),a=$("#mapbox").find(".leaflet-tile-loaded").eq(o).offset().top-$(window).scrollTop(),t=document.getElementById("map_canvas"),n=t.getContext("2d");$.context=n,i.crossOrigin="anonymous",i.src=$("#mapbox").find(".leaflet-tile-loaded").eq(o).attr("src"),i.setAtX=r,i.setAtY=a,i.onload=function(){n.drawImage(this,this.setAtX,this.setAtY)}}setTimeout(function(){var e=$("#mapbox").find(".leaflet-tile-loaded").length,t=document.getElementById("map_canvas"),n=t.getContext("2d");n.clearRect(0,0,t.width,t.height);for(var o=0;e>o;o++){var i=new Image,r=$("#mapbox").find(".leaflet-tile-loaded").eq(o).offset().left-$(window).scrollLeft(),a=$("#mapbox").find(".leaflet-tile-loaded").eq(o).offset().top-$(window).scrollTop(),t=document.getElementById("map_canvas"),n=t.getContext("2d");$.context=n,i.crossOrigin="anonymous",i.src=$("#mapbox").find(".leaflet-tile-loaded").eq(o).attr("src"),i.setAtX=r,i.setAtY=a,i.onload=function(){n.drawImage(this,this.setAtX,this.setAtY)}}},1e3),setTimeout(function(){var e=$("#mapbox").find(".leaflet-tile-loaded").length,t=document.getElementById("map_canvas"),n=t.getContext("2d");n.clearRect(0,0,t.width,t.height);for(var o=0;e>o;o++){var i=new Image,r=$("#mapbox").find(".leaflet-tile-loaded").eq(o).offset().left-$(window).scrollLeft(),a=$("#mapbox").find(".leaflet-tile-loaded").eq(o).offset().top-$(window).scrollTop(),t=document.getElementById("map_canvas"),n=t.getContext("2d");$.context=n,i.crossOrigin="anonymous",i.src=$("#mapbox").find(".leaflet-tile-loaded").eq(o).attr("src"),i.setAtX=r,i.setAtY=a,i.onload=function(){n.drawImage(this,this.setAtX,this.setAtY)}}},2e3),setTimeout(function(){var e=$("#mapbox").find(".leaflet-tile-loaded").length,t=document.getElementById("map_canvas"),n=t.getContext("2d");n.clearRect(0,0,t.width,t.height);for(var o=0;e>o;o++){var i=new Image,r=$("#mapbox").find(".leaflet-tile-loaded").eq(o).offset().left-$(window).scrollLeft(),a=$("#mapbox").find(".leaflet-tile-loaded").eq(o).offset().top-$(window).scrollTop(),t=document.getElementById("map_canvas"),n=t.getContext("2d");$.context=n,i.crossOrigin="anonymous",i.src=$("#mapbox").find(".leaflet-tile-loaded").eq(o).attr("src"),i.setAtX=r,i.setAtY=a,i.onload=function(){n.drawImage(this,this.setAtX,this.setAtY)}}},3e3),setTimeout(function(){var e=$("#mapbox").find(".leaflet-tile-loaded").length,t=document.getElementById("map_canvas"),n=t.getContext("2d");n.clearRect(0,0,t.width,t.height);for(var o=0;e>o;o++){var i=new Image,r=$("#mapbox").find(".leaflet-tile-loaded").eq(o).offset().left-$(window).scrollLeft(),a=$("#mapbox").find(".leaflet-tile-loaded").eq(o).offset().top-$(window).scrollTop(),t=document.getElementById("map_canvas"),n=t.getContext("2d");$.context=n,i.crossOrigin="anonymous",i.src=$("#mapbox").find(".leaflet-tile-loaded").eq(o).attr("src"),i.setAtX=r,i.setAtY=a,i.onload=function(){n.drawImage(this,this.setAtX,this.setAtY)}}},4e3)}function d(e){var t=vmap.map.getZoom(),n=vmap.markerSize(t);$(document).bind("mousemove",function(t){$("#curser_tail").css({width:n,height:n,"background-image":'url("'+e+'")',"background-size":n,"background-repeat":"none",left:t.pageX-30,top:t.pageY-30})}),$("#mapbox").css("cursor","none"),$("#curser_tail").show()}function u(){$(".map img").mousemove(function(e){var t=this,n=e;map_click.mapClickWorking(n,t,function(e){p=e,e?$("#curser_tail").css({border:"1px solid green"}):$("#curser_tail").css({border:"1px solid red"})})})}var p=1,h=0;this.canBuild=p,this.ctor=e,this.startChecking=t,this.stopChecking=n;var f=0,_=[];this.mapClickWorking=o,this.createCanvas=c}function map_relationshipJs(){function e(){}function t(e,t,o,i,r,a){"undefined"==typeof a&&(a=null);var s={lat:e,lng:t,vtype:r,streetName:o,buildingId:a},l="/api/map/showBuildingsInArea/";global.api(l,s,function(o){var a=JSON.parse(o);n(a,i,e,t,r)})}function n(e,t,n,s,l){var c=0,d=0;if(e[0].length>0)for(var u=0;u<e[0].length;u++){var p=e[0][u].type_id;1==p&&d++,2==p&&c++}if("undefined"!=typeof e[1]&&e[1].length>0)for(var u=0;u<e[1].length;u++){var p=e[1][u].type_id;1==p&&d++,2==p&&c++}if(1==l){var h=calculateBuildings.residentialVsResidential(d,t),f=calculateBuildings.residentialVsRestaurant(c,t);o(e[0],h,f,n,s),o(e[1],h,f,n,s)}else if(2==l||6==l){var h=calculateBuildings.restaurantVsResidential(d,t),f=calculateBuildings.restaurantVsRestaurant(e[1],n,s,t);o(e[0],h,f,n,s),i(e[1],f,n,s,t),console.log(e[2]),e[2].length>0&&"undefined"!=typeof e[2]&&a(e[2],e[3],t,n,s)}else(3==l||7==l)&&r(e[0],t,n,s)}function o(e,t,n,o,i){for(var r=0;r<e.length;r++){var a=e[r].type_id;if(1==a)var c="green",d="+"+t+"₪";if(2==a)var c="green",d="+"+n+"₪";var u={};u[0]=e[r].lat,u[1]=e[r].lng,(1==a||2==a)&&(s(u,d,c),l(o,i,u[0],u[1],c))}}function i(e,t,n,o,i){for(var r=0;r<e.length;r++)for(var a=e[r].type_id,c=e[r].id,d=0;d<t.length;d++)if(t[d].buildingId==c){var u="red",p="-"+t[d].minus+"₪",h={};h[0]=e[r].lat,h[1]=e[r].lng,(1==a||2==a)&&(s(h,p,u),l(n,o,h[0],h[1],u))}}function r(e,t,n,o){var i="green",r="+"+t+"₪",a={};a[0]=e.lat,a[1]=e.lng,s(a,r,i),l(n,o,a[0],a[1],i)}function a(e,t,n,o,i){var r=formulas.factoryCalculate(e[0].level,n),a=r-t[0].bid,c="green",d="+"+a+"₪",u={};u[0]=e[0].lat,u[1]=e[0].lng,s(u,d,c),l(o,i,u[0],u[1],c)}function s(e,t,n){if("green"==n)var o=L.divIcon({className:"map_cssicon",html:t,iconSize:[100,30]});else var o=L.divIcon({className:"map_cssicon map_cssicon2",html:t,iconSize:[100,30]});L.marker([e[1],e[0]],{icon:o}).addTo(vmap.map)}function l(e,t,n,o,i){var r=L.mapbox.featureLayer(),a={x:e,y:t},s={x:n,y:o},l=new arc.GreatCircle(a,s),c=l.Arc(60,{offset:10});L.geoJson(c.json(),{color:i}).addTo(r),r.addTo(vmap.map)}function c(){vmap.map.eachLayer(function(e){e._popupContent||e._icon||!e._latlngs||"green"==e.options.color&&vmap.map.removeLayer(e)})}this.ctor=e,this.showPage=t,this.deleteArchLayer=c}function youtubeJs(){function e(){}function t(){global.globalHide(),$(".global_page_youtube").show()}this.ctor=e,this.showPage=t}function companyJs(){function e(){$(".company_new_holder_close").click(p),$(".company_new_holder_accept").click(c)}function t(e){global.globalHide(),$(".global_page_company").show(),$(".company").show(),n(e)}function n(e){o(e)}function o(e){var t={clanId:e},n="/api/company/getClanDetailsFromId/";global.api(n,t,function(e){i(e)})}function i(e){e=JSON.parse(e),$(".company_main_users_text").hide(),$(".company_title span").text(e[0][0].name),null==$.globalUser.companys_name?($(".company_oneResult_btns_joinBtn").show(),$(".company_oneResult_btns_joinBtn").click({clanid:e[0][0].id},r)):$.globalUser.companys_id==e[0][0].id&&($(".company_oneResult_btns_leaveBtn").show(),$(".company_oneResult_btns_leaveBtn").click(h));for(var t=e[1],n=0;n<t.length;n++){var o=$(".company_main_users_text:first").clone();o.find(".company_main_users_text_userName span").text(t[n].userName),o.find(".company_main_users_text_userName span").click({userId:t[n].id},m),o.find(".company_main_users_text_profit span").text(t[n].profit),o.find(".company_main_users_text_rank span").text(t[n].rank),$.globalUser.id!=t[n].id&&(o.find(".company_oneResult_btns_sendMsgBtn").show(),o.find(".company_oneResult_btns_sendMsgBtn").click({userId:t[n].id,userName:t[n].userName},g)),1==$.globalUser.admin&&$.globalUser.companys_id==e[0][0].id&&$.globalUser.id!=t[n].id&&(o.find(".company_oneResult_btns_kickBtn").show(),o.find(".company_oneResult_btns_kickBtn").click({userId:t[n].id},f)),$(".company_main_users").append(o),o.show()}}function r(e){var t=e.data.clanid,n={companyId:t},o="/api/company/sendReq/";global.api(o,n,function(e){a(e)})}function a(e){"sucsses"==e&&popup.showPage("בקשתך נשלחה בהצלחה"),"you all ready send req"==e&&popup.showPage("יש לך כבר בקשה ממתינה"),"you have country"==e&&popup.showPage("לא ניתן להצטרף ליותר מברית אחת")}function s(){global.globalHide(),$(".global_page_company").show(),$(".company_new").show()}function l(){var e=buildingsJson.getJson(4).levels[0],t=buildingsJson.getTime(4,1),n=e.profit;n=help.addComma(n),$(".company_new_holder_image").attr("src",e.img),$(".company_new_holder_time span").html(t),$(".company_new_holder_data1 span").text(e.price),$(".company_new_holder_data2 span").text(n)}function c(){var e="/api/company/checkCompanyName/",t=$(".company_new_holder_input_companyName").val(),n={companyName:t};global.api(e,n,function(e){"error: name exist"==e?valert.showPage("השם תפוס, אנא בחר שם אחר"):d()})}function d(e){var t=buildingsJson.getJson(4).levels[0];global.globalHide(),global.showDashboard(),vmap.buyHouseAlert(t.img,4,t.price)}function u(){var e=$(".company_new input").val();return e}function p(){global.globalHide(),global.showDashboard()}function h(){var e="/api/company/leaveCompany/",t={};global.api(e,t,function(e){global.showDashboard(),popup.showPage("עזבת את התאגיד בהצלחה"),global.getUser(),$(".header_cont_company").unbind("click"),$(".header_cont_company").text("צור תאגיד"),$(".header_cont_company").click(header.createCompany)})}function f(e){var t="האם אתה רוצה להסיר את המשתמש מהתאגיד?";choicePopup.showPage(t,function(t){if(t){var n=e.data.userId,o={user_id:n},i="/api/company/removeUserFromCompany/";global.api(i,o,function(e){_(e)})}})}function _(e){popup.showPage("הסרת את המשתמש מהתאגיד"),t($.globalUser.companys_id)}function m(e){var t=e.data.userId;profile.showPage(t)}function g(e){var t=e.data.userId,n=e.data.userName;chat.openChat(t,n)}this.ctor=e,this.showPage=t,this.showPopupPage=s,this.createNewCompany=l,this.getNewCompanyName=u}function petekJs(){function e(){t()}function t(){0==i&&(i=1,n()),$(".global_page_petek").show()}function n(){var e={},t="/api/header/getPetek/";global.api(t,e,function(e){var t=JSON.parse(e);o(t),setInterval(function(){o(t)},5e3)})}function o(e){var t=Math.floor(Math.random()*e.length),n=e[t].line,o=e[t].name,i=e[t].company;$(".petek_line").text('"'+n+'"'),$(".petek_name").text(o),$(".petek_title").text(i)}this.ctor=e;var i=0;this.showPage=t}function runningTimesJs(){function e(){}function t(){}function n(e){if(alert($.globalUserFactoryRaq),$(".runningTimes_oneBuilding").hide(),$(".runningTimes_loop_icon").text("x"+e.length),$(".runningTimes_finishWithRep").blur("click"),$(".bgElements_keyboard").show(),$(".bgElements_notePad").hide(),e.length>0){$(".bgElements_keyboard").hide(),$(".bgElements_notePad").show(),$(".runningTimes").show();var t=e.length;a=t;for(var n=0;t>n;n++){var i=$(".runningTimes_oneBuilding:first").clone();o(i,e[n].dateEnd);var s=e[n].type,l=buildingsJson.getBuildingName(s);i.find(".runningTimes_type span").text(l),$(".runningTimes_loop").append(i),$(".runningTimes_finishWithRep").find("span").text(choicePopup.getReputation(e[n].dateEnd)),i.find(".runningTimes_finishWithRep").click({buildingsId:e[n].usersBuildings_id,dateEnd:e[n].dateEnd},r),i.show(),$(".global_page_runningTimes").show()}}}function o(e,t){var n=setInterval(function(){var o=new Date(t);o=new Date(o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate(),o.getUTCHours(),o.getUTCMinutes(),o.getUTCSeconds());var r=new Date,s=new Date(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds()),l=o.getTime()-s.getTime(),c=Math.floor(l/1e3),d=Math.floor(c/60),u=Math.floor(d/60),p=Math.floor(u/24);u%=24,d%=60,c%=60,10>u&&u>0&&(u="0"+u),10>d&&(d="0"+d),10>c&&(c="0"+c),l>0?(e.find(".runningTimes_timer_days").text(p),e.find(".runningTimes_timer_hours").text(u),e.find(".runningTimes_timer_min").text(d),e.find(".runningTimes_timer_sec").text(c)):(a--,0==a&&$(".runningTimes_loop_icon").hide(),clearInterval(n),e.remove(),map_lookAround.removeMarkers(),map_lookAround.sendCornersToAPI(),i(),$(".bgElements_keyboard").show(),$(".bgElements_notePad").hide(),$(".runningTimes").hide())},1e3)}function i(){setTimeout(function(){var e={},t="/api/users/getUserProfit/";global.api(t,e,function(e){var t=JSON.parse(e);$.globalUser=t[0][0],$.globalUserBuilding=t[1],header.getUserBuildingsSum($.globalUser,$.globalUserOnBuildingProcess),header.getUserRep($.globalUser),header.getCompanyDetails($.globalUser),header.setProfit($.globalUser.profit),map_lookAround.removeMarkers(),map_lookAround.sendCornersToAPI();var n=parseInt($(".header_bottomHeader_keys_ammount_sumBuild").text())-1;$(".header_bottomHeader_keys_ammount_sumBuild").text(n)})},5e3)}function r(e){var t=e.data.dateEnd,n=e.data.buildingsId;choicePopup.showPageReputation(1,t,n)}this.ctor=e,this.showPage=t;var a=0;this.showBuildingsOnBuildingProocess=n}function paymentJs(){function e(){n()}function t(){global.globalHide(),$(".global_page_payment").show()}function n(){var e=$.cookie("session");$(".payment_userToken").attr("value",e),console.log(e)}this.ctor=e,this.showPage=t}function profileJs(){function e(){$(".profile_bg, .profile_close").click(i),$("#profile_exit_button").click(n),$(document).keyup(t)}function t(e){27==e.keyCode&&n()}function n(){i()}function o(e){$(".global_page_profile").show(),r(e)}function i(){$(".global_page_profile").hide()}function r(e){a(e)}function a(e){var t={userId:e},n="/api/users/getUserDetailsFromId/";global.api(n,t,function(e){s(e)})}function s(e){var t=JSON.parse(e);t=t[0],$(".profile_name").text(t.userName),d(t.rank),u(t.profit),null==t.companys_name?$(".profile_holder_companyName").hide():$(".profile_name_taagid").text(t.companys_name),$("#profile_holder_send_massage_button").click({otherUserId:t.id},l),$("#profile_holder_attack_button").click({otherUserId:t.id},c),$(".profile_name_taagid").click({otherCompanyId:t.companys_id},p)}function l(e){var t=e.data.otherUserId,n=$(".profile_name").text();$(".global_page_profile").hide(),chat.openChat(t,n)}function c(e){var t=e.data.otherUserId;$(".profile_name").text();$(".global_page_profile").hide(),alert("attack "+t)}function d(e){var t=e;if(e>1e3&&1e6>e)var e=e/1e3+"K";else if(e>1e6)var e=e/1e6+"M";t=help.addComma(t),$(".profile_holder_rank_circle_number").text(e),$(".profile_holder_rank_circle_hover").text(t)}function u(e){var t=e;if(e>1e3&&1e6>e)var e=e/1e3+"K";else if(e>1e6)var e=e/1e6+"M";t=help.addComma(t),$(".profile_holder_profit_circle_number").text(e),$(".profile_holder_profit_circle_hover").text(t+"₪")}function p(e){var t=e.data.otherCompanyId;n(),company.showPage(t)}this.ctor=e,this.showPage=o,this.showData=r}function upgradeBuildingJs(){function e(){$(".upgradeBuilding_bg").click(n),$(".upgradeBuilding_holder_close").click(n),$(".upgradeBuilding_holder_accept").click(r)}function t(e){$(".upgradeBuilding_holder_id").text(e),$(".global_page_upgradeBuilding").fadeIn(),$(".global_pagesFixed").css("-webkit-filter","blur(5px)"),o(e,$.globalUserBuilding),7!=$.globalUser.mentor&&(clearInterval($.addBuilding_mentorLevel5_2),clearInterval($.addBuilding_mentorLevel5_3),$(".upgradeBuilding_holder_level5_2").hide(),$(".upgradeBuilding_holder_level5_3").hide())}function n(){$(".global_pagesFixed").css("-webkit-filter","blur(0px)"),$(".global_page_upgradeBuilding").fadeOut()}function o(e,t){for(var n=t.length,o=0;n>o;o++)if(t[o].id==e)var r=o;var a=t[r].type_id,d=buildingsJson.getBuildingName(a),u=t[r].level,p=buildingsJson.getImageUrl(a,u+1),h=" שיפור לרמה "+(u+1),f=buildingsJson.getTime(a,u+1),_=decodeURIComponent(t[r].street),m=buildingsJson.getJson(a),g=t[r].jsonProfit,v=m.levels[u-1].profit,y=m.levels[u].profit,b=y-v,w="₪"+m.levels[u].price,x=m.levels[u].mainBuilding,k=buildingsJson.getMainBuilding();if(0==a){$(".upgradeBuilding_holder_nextBuildings").show(),$(".upgradeBuilding_holder_sacle").hide(),$(".upgradeBuilding_holder_textProfit").hide(),$(".upgradeBuilding_holder_sum").hide(),$(".upgradeBuilding_holder_nextBuildings_one").hide();for(var B=$.building_main.building[u-1].type,C=$.building_main.building[u].type,o=0;o<C.length;o++){for(var P=$(".upgradeBuilding_holder_nextBuildings_one:first").clone(),I=C[o].type_id,U=C[o].number,T=buildingsJson.getImageUrl(I,0),N=0;N<B.length;N++)B[N].type_id==I&&(U-=B[N].number);U>0&&(P.find("img").attr("src",T),P.find(".upgradeBuilding_holder_nextBuildings_number").text(U),P.show(),$(".upgradeBuilding_holder_nextBuildings").append(P)),c()}}else if(5==a){$(".upgradeBuilding_holder_nextBuildings").hide(),$(".upgradeBuilding_holder_sacle").show(),$(".upgradeBuilding_holder_textProfit").show(),$(".upgradeBuilding_holder_sum").show(),v=m.levels[u-1].maxMoney,y=m.levels[u].maxMoney,b=y-v;var A=m.levels[m.levels.length-1].maxMoney,S=100*v/A,R=100*b/A;$(".upgradeBuilding_holder_sacle_current").css("width",S+"%"),$(".upgradeBuilding_holder_sacle_pot").css("width",R+"%"),v=help.addComma(v),y=help.addComma(y),b=help.addComma(b),$(".upgradeBuilding_holder_textProfit_current .upgradeBuilding_holder_textProfit_text").text("יכולת נוכחית"),$(".upgradeBuilding_holder_textProfit_current .upgradeBuilding_holder_textProfit_sum").text(v),$(".upgradeBuilding_holder_textProfit_pot .upgradeBuilding_holder_textProfit_text").text("יכולת פוטנציאלית"),$(".upgradeBuilding_holder_textProfit_pot .upgradeBuilding_holder_textProfit_sum").text(b),$(".upgradeBuilding_holder_sum").text('סה"כ יכולת '),$(".upgradeBuilding_holder_sum").append("<span></span>"),$(".upgradeBuilding_holder_sum span").text(y)}else{$(".upgradeBuilding_holder_nextBuildings").hide(),$(".upgradeBuilding_holder_sacle").show(),$(".upgradeBuilding_holder_textProfit").show(),$(".upgradeBuilding_holder_sum").show();var A=m.levels[m.levels.length-1].profit,S=100*v/A,R=100*b/A;$(".upgradeBuilding_holder_sacle_current").css("width",S+"%"),$(".upgradeBuilding_holder_sacle_pot").css("width",R+"%"),v=help.addComma(v),y=help.addComma(y),b=help.addComma(b),$(".upgradeBuilding_holder_textProfit_current .upgradeBuilding_holder_textProfit_sum").text(v),$(".upgradeBuilding_holder_textProfit_pot .upgradeBuilding_holder_textProfit_sum").text(b),3==a||7==a?(i(u+1,e,g),$(".upgradeBuilding_holder_sum span").text("")):$(".upgradeBuilding_holder_sum span").text(y)}x>k.level?($(".upgradeBuilding_holder_notMinimum").show(),$(".upgradeBuilding_holder_button").hide(),$(".upgradeBuilding_holder_notMinimum_text span").text(x)):($(".upgradeBuilding_holder_notMinimum").hide(),$(".upgradeBuilding_holder_button").show()),w=help.addComma(w),$(".upgradeBuilding_holder_street span").text(_),$(".upgradeBuilding_holder_time span").html(f),$(".upgradeBuilding_holder_image").attr("src",p),$(".upgradeBuilding_holder_title").text(h),$(".upgradeBuilding_holder_buildingName").text(d),$(".upgradeBuilding_holder_accept").text(w),s(),l()}function i(e,t,n){var o="/api/war/getStoreProfit/",i={factoryId:t};global.api(o,i,function(t){var o=JSON.parse(t),i=o[0].profit-n,r=formulas.factoryCalculate(e,i);$(".upgradeBuilding_holder_sum span").text(r)})}function r(e){var t=$(".upgradeBuilding_holder_id").text(),o="/api/buy/updateBuilding/",i={buildingId:t};global.api(o,i,function(e){a(e),7==$.globalUser.mentor&&(clearInterval($.addBuilding_mentorLevel5_2),$(".upgradeBuilding_holder_level5_3").hide(),mentor.updateMentor()),n()})}function a(e){"error: you dont have enough office level"==e?valert.showPage("הרמה של המשרד לא מספיק גבוהה"):"error: you dont have money"==e?valert.showPage("אין לך מספיק כסף"):"error: you dont have enough main building level"==e?valert.showPage("הרמה של הבניין הראשי לא מספיק גבוהה"):"error: the building is in build"==e?valert.showPage("ניתן לבנות רק מבנה אחד בכל זמן נתון"):(vmap.map.closePopup(),map_lookAround.removeMarkers(),map_lookAround.sendCornersToAPI()),vmap.map.closePopup(),global.getUser()}function s(){var e=$(".upgradeBuilding_holder_accept").width()+30;e/=2,$(".upgradeBuilding_holder_accept").css("margin-left","-"+e+"px")}function l(){var e=8*$(".upgradeBuilding_holder_time span").text().length;$(".upgradeBuilding_holder_time").css("width",e+"px")}function c(){var e=100-10*$(".upgradeBuilding_holder_nextBuildings_one").length;$(".upgradeBuilding_holder_nextBuildings_one").css("width",e+"px")}this.ctor=e,this.showPage=t,this.showData=o}function mentorJs(){function e(){$(".mentor_box_holder_city").click(T),$(".mentor_box_holder_submit_level_1").click(U),$(".mentor_box_holder_submit_level_1_2").click(N),$(".mentor_box_holder_submitBonus").click(I),$(".mentor_level12_button").click(O),$(".mentor_allMission_close").click(o),$(".mentor_text_mession1_0").click(r),$(".mentor_text_mession1_1").click(a),$(".mentor_text_mession2_0").click(s),$(".mentor_text_mession2_1").click(l),$(".mentor_text_mession2_2").click(c),$(".mentor_text_mession3_0").click(d),$(".mentor_text_mession3_1").click(u),$(".mentor_text_mession4_0").click(p),$(".mentor_level2_submit").click(h),$(".mentor_level3_submit").click(f),$(".mentor_level5_submit").click(_),$(".mentor_level6_submit").click(m),$(".mentor_level7_submit").click(g),$(".mentor_level8_submit").click(v),$(".mentor_level9_submit").click(b),$(".mentor_level10_submit").click(y),$(".runningTimes_level9_text_submit").click(w)}function t(){$(".global_page_mentor").show(),B()}function n(e){var t=$(".header_bottomHeader_star img").offset().left-40,n=$(".mentor_success_button_img1").css("left");$(".mentor_success_button_img1").addClass("mentor_success_button_img1_addClass"),$(".mentor_success_button_img1").css("left",t+"px");var i=$(".mentor_success_button_img2").css("left");$(".mentor_success_button_img2").addClass("mentor_success_button_img2_addClass"),$(".mentor_success_button_img2").css("left",t+"px");var r=$(".mentor_success_button_img3").css("left");$(".mentor_success_button_img3").addClass("mentor_success_button_img3_addClass"),$(".mentor_success_button_img3").css("left",t+"px"),$(".mentor_success_button_beforeSuccess").hide(),$(".mentor_success_button_afterSuccess").show(),setTimeout(function(){$(".mentor_success_button_img1").hide(),$(".mentor_success_button_img1").css("left",n),$(".mentor_success_button_img1").removeClass("mentor_success_button_img1_addClass")},500),setTimeout(function(){$(".mentor_success_button_img2").hide(),$(".mentor_success_button_img2").css("left",i),$(".mentor_success_button_img2").removeClass("mentor_success_button_img2_addClass"),$.globalUser.reputation+=e,header.getUserRep($.globalUser)},1e3),setTimeout(function(){$(".mentor_success_button_img3").hide(),$(".mentor_success_button_img3").css("left",r),$(".mentor_success_button_img3").removeClass("mentor_success_button_img3_addClass")},1500),setTimeout(function(){$(".mentor_allMission").find(".mentor_text").show(),$(".mentor_allMission").find(".mentor_success").hide(),$(".mentor_success_button_beforeSuccess").show(),$(".mentor_success_button_afterSuccess").hide(),o()},1500)}function o(){$(".mentor_allMission").hide(),$(".mentor_allHolder").show()}function i(e,t,n){$(".mentor_allHolder").hide(),$(".mentor_allMission").show(),$(".mentor_allMission").find(".mentor_title").text(e),$(".mentor_allMission").find(".mentor_text").html(t),$(".mentor_bonus_num").text(n)}function r(){var e=$(this).text(),t="רכוש שלושה נכסים מסוג בניני מגורים, ומקם אותם על המפה במקום אסטרטגי שיניב לך תשואה גבוהה.",n=10;x(1,0,n),i(e,t,n)}function a(){var e=$(this).text(),t="בנה 5 דירות ו2 מסעדות על המפה",n=40;x(1,0,n),i(e,t,n)}function s(){var e=$(this).text(),t="שדרג את המשרד הראשי שלך לרמה 3.",n=20;x(2,0,n),i(e,t,n)}function l(){var e=$(this).text(),t="שדרג את המשרד הראשי שלך לרמה 4.",n=30;x(2,0,n),i(e,t,n)}function c(){var e=$(this).text(),t="שדרג את המשרד הראשי שלך לרמה 5.",n=30;x(2,0,n),i(e,t,n)}function d(){var e=$(this).text(),t="שדרג דירה אחת לרמה 2.",n=15;x(3,0,n),i(e,t,n)}function u(){var e=$(this).text(),t="שפר מסעדה אחת לרמה 2 ודירה אחת לרמה 3.",n=30;x(3,0,n),i(e,t,n)}function p(){var e=$(this).text(),t="הוסף את המשחק למועדפים שלך! כך תוכל לזכור לחזור אליו ולסיים את המשימות שלך<br> לחץ על <b>ctrl+D</b> על מנת להוסיף את האתר למועדפים",n=40;x(4,0,n),i(e,t,n)}function h(){$(".mentor_level2").fadeOut(),vmap.deleteCityGeoJson()}function f(){$(".mentor_level3").removeClass("mentor_notBlock"),$(".addBuilding").addClass("mentor_notBlock"),$.addBuilding_mentorLevel3=setInterval(function(){$(".addBuilding_mentor_poniter").fadeToggle(100)},500),$(".mentor_level3_submit").hide()}function _(){$(".mentor_level5").removeClass("mentor_notBlock"),$(".addBuilding").addClass("mentor_notBlock"),$.addBuilding_mentorLevel3=setInterval(function(){$(".addBuilding_mentor_poniter").fadeToggle(100)},500)}function m(){$(".mentor_level6").hide(),$(".header_cont_pageName_rank").addClass("mentor_notBlock"),$(".header_bottomHeader_mission6").addClass("mentor_notBlock"),$.mentor_level6=setInterval(function(){$(".header_bottomHeader_mission6").fadeToggle(100)},500)}function g(){$(".mentor_level7").hide(),vmap.makeMapLarger(),$(".mentor_block").hide(),$(".map_goToNotebook").hide(),clearInterval($.addBuilding_mentorLevel5),$.addBuilding_mentorLevel5=setInterval(function(){$(".map_mentor_level5").fadeToggle(100)},500),setTimeout(function(){var e=buildingsJson.getMainBuilding();vmap.zoomToMainBuilding(e.lng,e.lat,18),vmap.disableMove()},500),setTimeout(function(){var e=buildingsJson.getMainBuilding();vmap.zoomToMainBuilding(e.lng,e.lat,18),vmap.disableMove()},1e3)}function v(){$(".mentor_level8").removeClass("mentor_notBlock"),$(".addBuilding").addClass("mentor_notBlock"),$.addBuilding_mentorLevel3=setInterval(function(){$(".addBuilding_mentor_poniter").fadeToggle(100)},500),$(".mentor_level3_submit").hide()}function y(){$(".mentor_level10").hide(),$(".notebookNav_war, .notebookNav").addClass("mentor_notBlock"),$(".notebookNav_mission10_block").show(),clearInterval($.mentorHaz_level10_0),$.mentorHaz_level10_0=setInterval(function(){$(".notebookNav_mission10").fadeToggle(100)},500)}function b(){$(".mentor_level9").hide(),$(".runningTimes_level9Hez, .runningTimes_level9_text").show(),$(".runningTimes").addClass("mentor_notBlock")}function w(){$(".runningTimes_level9Hez, .runningTimes_level9_text").hide(),clearInterval($.mentor_level9_haz),$.mentor_level9_haz=setInterval(function(){$(".runningTimes_level9_1Hez").fadeToggle(100)},500)}function x(e,t,o){var i={mession_id:e,toComplete:t},r="/api/mentor/completeMission/";1==t&&n(o),global.api(r,i,function(n){"pinish"==n&&0==t&&($(".mentor_success_button_img1").show(),$(".mentor_success_button_img2").show(),$(".mentor_success_button_img3").show(),$(".mentor_allMission").find(".mentor_text").hide(),$(".mentor_allMission").find(".mentor_success").show(),$(".mentor_allMission").find(".mentor_success_button span").text(o),$(".mentor_success_button_beforeSuccess").off(),$(".mentor_success_button_beforeSuccess").click(function(){x(e,1,o),1==e?$.globalUserMentor.mession1+=1:2==e?$.globalUserMentor.mession2+=1:3==e?$.globalUserMentor.mession3+=1:4==e&&($.globalUserMentor.mession4+=1),P()}))})}function k(){var e={city_id:H},t="/api/mentor/updateMentor/";global.api(t,e,function(e){var t=JSON.parse(e);$.globalUser=t,B()})}function B(){D++;var e=$.globalUser.mentor;if(1==e)$(".mentor").hide(),$(".mentor_box, .mentor_box_holder1").show();else if(2==e){$(".mentor").hide(),$(".mentor_level2").show(),$(".mentor_box").fadeOut(),$(".mentor_box_holderBonus").hide();var t=buildingsJson.getJson(0).levels[0],n=buildingsJson.getImageUrl(0,0);map_click.startChecking(n),vmap.buyHouseAlert(t.img,0,t.price)}else 3==e?($(".mentor").hide(),$(".mentor_block").show(),$(".mentor_level3").show(),$(".mentor_level3").addClass("mentor_notBlock")):4==e?1==D&&C():5==e?($(".mentor_block").show(),$(".header_bottomHeader_money").removeClass("mentor_notBlock"),$(".mentor").hide(),$(".mentor_level5").show()):6==e?($(".mentor").hide(),$(".mentor_level6").show(),$(".addBuilding").removeClass("mentor_notBlock"),$(".mentor_level6").addClass("mentor_notBlock"),$(".mentor_block").show()):7==e?($(".mentor").hide(),$(".mentor_block").show(),$(".mentor_level7").show(),$(".header_cont_pageName_rank").removeClass("mentor_notBlock"),$(".mentor_level7").addClass("mentor_notBlock"),clearInterval($.mentor_level6),$(".header_bottomHeader_mission6").hide()):8==e?(vmap.closeFlow(),$(".mentor_block").show(),$(".mentor_level7").hide(),$(".mentor_level8").addClass("mentor_notBlock"),$(".mentor").hide(),$(".mentor_level8").show()):9==e?($(".mentor_block").show(),$(".mentor_level8").hide(),$(".mentor_level9").addClass("mentor_notBlock"),$(".mentor").hide(),$(".mentor_level9").show()):10==e?($(".mentor_block").show(),$(".mentor_level9").hide(),$(".mentor_level10").addClass("mentor_notBlock"),$(".mentor").hide(),$(".mentor_level10").show()):12==e?(vmap.closeFlow(),$(".notebookNav_mission10_block").hide(),
$(".mentor_level12, .mentor_all").show(),$(".mentor_block").show(),$(".mentor_level12").addClass("mentor_notBlock"),$(".mentor_all").addClass("mentor_notBlock")):($(".notebookNav_mission10_block").hide(),$(".mentor_all").removeClass("mentor_notBlock"),$(".map_goToNotebook").show(),P())}function C(){$(".mentor_level3").hide(),$(".addBuilding").removeClass("mentor_notBlock"),$(".mentor_block").show(),$(".header_bottomHeader_money").addClass("mentor_notBlock"),$(".header_bottomHeader_mission4").show(),clearInterval($.mentor_level4),$.mentor_level4=setInterval(function(){$(".header_bottomHeader_mission4").fadeToggle(100)},500)}function P(){$(".mentor_text_mession").hide(),0==$.globalUserMentor.mession1?$(".mentor_text_mession1_0").show():1==$.globalUserMentor.mession1?$(".mentor_text_mession1_1").show():2==$.globalUserMentor.mession1&&$(".mentor_text_mession1_2").show(),0==$.globalUserMentor.mession2?$(".mentor_text_mession2_0").show():1==$.globalUserMentor.mession2?$(".mentor_text_mession2_1").show():2==$.globalUserMentor.mession2&&$(".mentor_text_mession2_2").show(),0==$.globalUserMentor.mession3?$(".mentor_text_mession3_0").show():1==$.globalUserMentor.mession3&&$(".mentor_text_mession3_1").show(),0==$.globalUserMentor.mession4&&$(".mentor_text_mession4_0").show(),$(".mentor_box").hide(),$(".mentor").hide(),$(".mentor_all").show()}function I(){$(".mentor_box, .mentor_box_holderBonus").fadeOut(),4==$.globalUser.mentor&&C()}function U(){$(".mentor_box_holder").fadeOut(),$(".mentor_box_holder_leve1").fadeIn()}function T(){$(".mentor_box_holder_city").removeClass("mentor_box_holder_cityAddClass"),$(this).addClass("mentor_box_holder_cityAddClass"),$(".mentor_box_holder_submit_level_1_2").fadeIn(),H=$(this).find(".mentor_box_holder_city_id").text(),"telAviv"!=H&&"jerusalem"!=H&&(H="telAviv")}function N(){$(".mentor_box_holder_submit_level_1, .mentor_box_holderBonus").hide(),$(".mentor_box_holder_leve1").fadeOut();var e="מעולה! עכשיו נבחר איפה למקם את הביניין הראשי שלך.",t=10;E(e,t);var n={city_id:H},o="/api/mentor/level1/";global.api(o,n,function(e){var t=JSON.parse(e);$.globalUser=t[3][0],$.globalUserCity=t[4],B()})}function A(){var e="כל הכבוד! ועכשיו נלמד איך לבנות דירות.",t=20;E(e,t)}function S(){$(".mentor_box_holder_leve1").fadeOut();var e='נכס מסוג בניין מגורים, מניב 3,000 ש"ח כל שעה עגולה. <br> בשביל להמשיך להרוויח כסף, תצטרך לרכוש עוד נכסים.',t=15;E(e,t)}function R(){$(".mentor_box_holder_leve1").fadeOut();var e="מעולה! <br> ככל שהמסעדה שלך תהיה באזור עם יותר דירות ככה היא תרוויח יותר כסף.",t=20;E(e,t)}function L(){$(".mentor_box_holder_leve1").fadeOut();var e="מאדאר פאקר עוז תמצא תוספת שאפשר לרשום על השלב הזה.",t=10;E(e,t)}function M(){$(".mentor_box_holder_leve1").fadeOut();var e="מעולה, עוז תכניס טקסט למשהו 10.",t=50;E(e,t)}function J(){$(".mentor_box_holder_leve1").fadeOut();var e="עוז תן שורת הסבר על המפעל, שהוא לא מכניס כסף רק אחרי שיש לו מסעדה.",t=30;E(e,t)}function O(){$(".mentor_level9, .mentor_block").hide(),k()}function E(e,t){k(),$(".mentor_box_holder").show(),$(".global_page_mentor, .mentor_box_holderBonus").show(),$(".mentor_box_holderBonus").find(".mentor_box_holder_text").html(e),$(".mentor_box_holder_bonus_number").html(t),$(".mentor_box_holderBonus").fadeIn()}e(),this.ctor=e,this.showPage=t,this.continueLevel6=m,this.updateMentor=k;var H,D=0;this.finishLevel2=A,this.finishLevel3=S,this.finishLevel5=R,this.finishLevel9=L,this.finishLevel10=M,this.finishLevel8=J,this.finishLevel12=O,this.showBonus=E}function chatJs(){function e(){$(".chatBox_title").click(_),$(".chatBox").click(h),t()}function t(){$(".global_page_chat").show(),r()}function n(){var e=$(this).parent().parent().find(".chatBox_sendBox_otherUserId").text();$(this).parent().parent().remove();var t="/api/chat/closeChat/",n={otherUsers_id:e};d(t,n,function(e){JSON.parse(e);$(this).parent().parent().remove()})}function o(){}function i(e,t){$(this).parent().parent().find(".chatBox_sendBox_otherUserId").text();$(this).parent().parent().remove();var n="/api/chat/openChat/",o={otherUsers_id:e,otherUsers_name:t};d(n,o,function(e){var t=JSON.parse(e);a(t)})}function r(){var e="/api/chat/getChat/",t={};d(e,t,function(e){var t=JSON.parse(e);a(t)})}function a(e){var t=e.length;if(1==t){$(".chat").show(),$(".chat").find(".chatBox_title_userName").text(e[0].otherUsers_name),$(".chat").find(".chatBox_sendBox_otherUserId").text(e[0].otherUsers_id);var o=$(".chat:first"),i=e[0].otherUsers_id;b=e[0].otherUsers_id,s(o,i)}else if(t>1){$(".chat").show(),$(".chat").find(".chatBox_title_userName").text(e[0].otherUsers_name),$(".chat").find(".chatBox_sendBox_otherUserId").text(e[0].otherUsers_id);var o=$(".chat:first"),i=e[0].otherUsers_id;b=e[0].otherUsers_id,s(o,i);var r=$(".chat").clone();r.addClass("chat1"),$(".chat1").remove(),r.show(),$(".global_page_chat").append(r),$(".chat1").find(".chatBox_title_userName").text(e[1].otherUsers_name),$(".chat1").find(".chatBox_sendBox_otherUserId").text(e[1].otherUsers_id);var o=r,i=e[1].otherUsers_id;w=i,s(o,i)}$(".chatBox_title_close").blur("click"),$(".chatBox_title_close").click(n),$(".chat").blur("click"),$(".chat").click(c),$(".chatBox_sendBox_textarea").blur("keypress"),$(".chatBox_sendBox_textarea").keypress(p),$(".chatBox_sendBox_textarea").keypress(u),$(".chatBox_sendBox_send").blur("click"),$(".chatBox_sendBox_send").click(f)}function s(e,t){var n="/api/chat/getChatContent/",o={otherUsers_id:t};d(n,o,function(t){var n=JSON.parse(t);l(n,e)})}function l(e,t){for(var n=e.length,o=0;n>o;o++){var i=e[o].msg,r=e[o].sendId;r==$.globalUser.id?v(i,t,1):g(i,t,1)}setTimeout(function(){t.find(".chatBox_text").animate({scrollTop:1e3},0)},1e3)}function c(){$(this).find("textarea").focus()}function d(e,t,n){e="http://localhost:3001"+e,t.session=$.cookie("session"),$.ajax({type:"GET",url:e,data:t,dataType:"text",success:function(e){var t=e[0]+e[1]+e[2];"-1"==e?console.log("chat error in function chatApi"):"-10"==t?console.log("chat error in function chatApi"):n(e)},error:function(){}})}function u(){if($(this).length<10&&(x=0,$(this).css("height","16px"),$(this).parent().parent().find(".chatBox_sendBox").css("height","45px"),$(this).parent().parent().find(".chatBox_text").css("height","266px")),50>x)for(;$(this).outerHeight()<this.scrollHeight+parseFloat($(this).css("borderTopWidth"))+parseFloat($(this).css("borderBottomWidth"));)x++,$(this).height($(this).height()+1),$(this).parent().parent().find(".chatBox_sendBox").height($(this).parent().parent().find(".chatBox_sendBox").height()+1),$(this).parent().parent().find(".chatBox_text").height($(this).parent().parent().find(".chatBox_text").height()-1)}function p(e){var t=e.keyCode?e.keyCode:e.which;if(13==t){e.preventDefault();var n=$(this);return m(n),!1}}function h(){$(this).find(".chatBox_sendBox_textarea").focus()}function f(){var e=$(this).parent().find(".chatBox_sendBox_textarea");m(e)}function _(){$(this).parent().toggleClass("chatBoxHide"),$(".chatBox_sendBox_textarea").focus()}function m(e){var t=encodeURIComponent(e.val());if(t.length>0){var n=e.parent().parent();v(t,n,0);var o=n.find(".chatBox_sendBox_otherUserId").text();e.parent().parent().find(".chatBox_sendBox_textarea").val(""),e.parent().parent().find(".chatBox_sendBox_textarea").focus(),y.emit("chat message",{msg:t,otherUsersId:o,id:$.globalUser.id})}}function g(e,t,n){e=decodeURIComponent(e);var o=$(".chatBox_text_message:first").clone();o.find(".chatBox_text_message_text").text(e),0==n&&t.find(".chatBox_text").animate({scrollTop:t.find(".chatBox_textHolder").height()},200),o.show(),t.find(".chatBox_textHolder").append(o)}function v(e,t,n){e=decodeURIComponent(e);var o=$(".chatBox_text_messageMy:first").clone();o.find(".chatBox_text_messageMy_text").text(e),o.show(),0==n&&t.find(".chatBox_text").animate({scrollTop:t.find(".chatBox_textHolder").height()},200),t.find(".chatBox_textHolder").append(o)}var y={};this.ctor=e,this.showPage=t,this.listen=o,this.openChat=i;var b=0,w=0,x=0}function bgElementsJs(){function e(){t()}function t(){$(".global_page_bgElements").show()}this.ctor=e,this.showPage=t}function searchResultsJs(){function e(){n(),$(".header_searchCompany_btn").click(o)}function t(e){global.globalHide(),$(".global_page_searchResults").show(),i(e)}function n(){$("#header_searchCompany_input").keypress(function(e){if(13==e.which){var n=$("#header_searchCompany_input").val();return t(n),!1}})}function o(){var e=$("#header_searchCompany_input").val();t(e)}function i(e){$(".searchResults_title span").text(e);var t={searchQuery:e},n="/api/header/search/";global.api(n,t,function(e){var t=JSON.parse(e);r(t)})}function r(e){$(".searchResults_oneUserResult").hide(),$(".searchResults_oneClanResult").hide();var t=e[0].length;$(".searchResults_numOfUsersResult span").text(t);for(var n=0;t>n;n++){var o=$(".searchResults_oneUserResult:first").clone();o.find(".searchResults_oneResult_title_name").text(e[0][n].userName),o.find(".searchResults_oneResult_btns_viewProfile").click({userId:e[0][n].id},a),$(".searchResults_main_users").append(o),o.show()}t=e[1].length,$(".searchResults_numOfClansResult span").text(t);for(var n=0;t>n;n++){var i=$(".searchResults_oneClanResult:first").clone();i.find(".searchResults_oneResult_title_name").text(e[1][n].name),i.find(".searchResults_oneResult_details_Rank .searchResults_oneResult_details_oneField_value").text(e[1][n].rank),i.find(".searchResults_oneResult_details_power .searchResults_oneResult_details_oneField_value").text(e[1][n].power),i.find(".searchResults_oneResult_btns_showCompany").click({clanId:e[1][n].id},s),$(".searchResults_main_Clans").append(i),i.show()}}function a(e){profile.showPage(e.data.userId)}function s(e){company.showPage(e.data.clanId)}this.ctor=e,this.showPage=t}function choicePopupJs(){function e(){$(".choicePopup_x").click(r),$(".choicePopup_btn_approveReputation").click(a),$(".choicePopup_btn_cancel").click(r)}function t(e,t){$(".choicePopup_btn_approve").unbind("click"),$(".choicePopup_btn_cancel").unbind("click"),$(".choicePopup_btn_approve").click(function(){t(1),r()}),$(".choicePopup_btn_cancel").click(function(){t(0),r()}),$(".choicePopup_text").text(e),$(".global_page_choicePopup").fadeIn(),$(".global_pagesFixed").css("-webkit-filter","blur(5px)")}function n(e,t,n){9==$.globalUser.mentor?(clearInterval($.mentor_level9_haz),$(".runningTimes_level9_1Hez").hide(),$(".choicePopup_x").hide(),clearInterval($.mentor_level9_2_haz),$.mentor_level9_2_haz=setInterval(function(){$(".choicePopup_level9Hez").fadeToggle(100)},500)):$(".choicePopup_x").show(),$(".choicePopup_btn_approveReputation_error").hide();var r=i(t);if($(".choicePopup_btn_reputation_buildingId").text(n),$(".choicePopup_btn_approveReputation_number").text(r),$(".choicePopup_btn_normal").hide(),$(".choicePopup_btn_reputation").show(),1==e)var a="האם תרצה לסיים את הבניה בעזרת מוניטין?";$(".choicePopup_text").text(a),$(".global_page_choicePopup").fadeIn(),$(".global_pagesFixed").css("-webkit-filter","blur(5px)"),o(t)}function o(e){setTimeout(function(){1==$(".global_page_choicePopup").is(":visible")&&o(e)},2e3);var t=i(e);$(".choicePopup_btn_approveReputation_number").text(t)}function i(e){e=new Date(e).getTime()/1e3;var t=new Date;t=new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds()).getTime()/1e3;var n=e-t,o=formulas.time(n);return o}function r(){$(".global_page_choicePopup").fadeOut(),$(".global_pagesFixed").css("-webkit-filter","blur(0px)")}function a(){var e=$(".choicePopup_btn_reputation_buildingId").text(),t={usersBuildings_id:e},n="/api/reputation/finishBuildTime/";global.api(n,t,function(e){9==$.globalUser.mentor&&(clearInterval($.mentor_level9_2_haz),$(".hide").fadeToggle(100),mentor.updateMentor(),mentor.finishLevel9()),"error: not enough reputation"==e?$(".btn_approveReputation_error").fadeIn():"not enough reputation"==e?$(".btn_approveReputation_error").fadeIn():(global.getUser(),r())})}this.ctor=e,this.showPage=t,this.showPageReputation=n,this.getReputation=i}function popupJs(){function e(){$(".popup_btn_approve").click(n),$(".popup_x").click(n)}function t(e){$(".popup_text").text(e),$(".global_page_popup").fadeIn(),$(".global_pagesFixed").css("-webkit-filter","blur(5px)")}function n(){$(".global_page_popup").fadeOut(),$(".global_pagesFixed").css("-webkit-filter","blur(0px)")}this.ctor=e,this.showPage=t}function rankJs(){function e(){$(".rank_mission6_text_submit").click(n)}function t(){global.globalHide(),bgElements.showPage(),$(".global_page_rank").show(),o(),6==$.globalUser.mentor?($(".header").hide(),$(".header_bottomHeader_mission6").fadeOut(100),$(".mentor_block").show(),$(".rank_mission6_text").show(),$(".rank_yourRank_row").addClass("mentor_notBlock"),$(".rank_mission6").show()):(clearInterval($.mentor_level6),$(".header_bottomHeader_mission6").fadeOut(100),$(".mentor_block, .rank_mission6_text, .rank_mission6").hide())}function n(){$(".header").show(),$.globalUser.mentor=7,mentor.updateMentor(),global.showDashboard()}function o(){var e="/api/rank/getTopTen/",t={};global.api(e,t,function(e){var t=JSON.parse(e);i(t[0]),a(t[1])})}function i(e){var t=e.length,n=$(".rank_table_row1:first").clone();$(".rank_table_row1").remove(),$(".rank_table").append(n);for(var o=0;t>o;o++){var n=$(".rank_table_row1:first").clone();n.find(".rank_table_row_li_rank").text(o+1),n.find(".rank_table_row_li_userName").text(e[o].userName),n.find(".rank_table_row_li_power").text(e[o].profit),n.find(".rank_table_row_li_userName").click({userId:e[o].id},r),$(".rank_table").append(n),n.show()}}function r(e){var t=e.data.userId;profile.showPage(t)}function a(e){var t=e[0].rank;t=help.addComma(t),$(".rank_yourRank span").text(t)}this.ctor=e,this.showPage=t}function alertJs(){function e(){$(".alert_btn_approve").click(n),$(".alert_x").click(n)}function t(e){$(".alert_text").text(e),$(".global_page_alert").fadeIn(),$(".global_pagesFixed").css("-webkit-filter","blur(5px)"),setTimeout(n,5e3)}function n(){$(".global_page_alert").fadeOut(),$(".global_pagesFixed").css("-webkit-filter","blur(0px)")}this.ctor=e,this.showPage=t}var json_corporate={type_id:4,levels:[{level:1,price:1,profit:300,seconds:10,minutes:0,hours:0,day:0,img:"www/images/icons/corporate/level1.png"},{level:2,price:1,profit:300,seconds:0,minutes:1,hours:0,day:0,img:"www/images/icons/corporate/level1.png"},{level:3,price:1,profit:300,seconds:0,minutes:30,hours:0,day:0,img:"www/images/icons/corporate/level1.png"},{level:4,price:1,profit:300,seconds:0,minutes:0,hours:1,day:0,img:"www/images/icons/corporate/level1.png"},{level:5,price:1,profit:300,seconds:0,minutes:0,hours:2,day:0,img:"www/images/icons/corporate/level1.png"},{level:6,price:1,profit:300,seconds:0,minutes:0,hours:4,day:0,img:"www/images/icons/corporate/level1.png"},{level:7,price:1,profit:300,seconds:0,minutes:0,hours:6,day:0,img:"www/images/icons/corporate/level1.png"}]},json_foodFactory={type_id:3,levels:[{level:1,price:3e5,profit:0,seconds:0,minutes:30,hours:0,day:0,mainBuilding:3,img:"www/images/icons/foodFactory/level1.png"},{level:2,price:45e4,profit:0,seconds:0,minutes:0,hours:1,day:0,mainBuilding:4,img:"www/images/icons/foodFactory/level1.png"},{level:3,price:6e5,profit:0,seconds:0,minutes:45,hours:1,day:0,mainBuilding:5,img:"www/images/icons/foodFactory/level1.png"},{level:4,price:9e5,profit:0,seconds:0,minutes:15,hours:2,day:0,mainBuilding:5,img:"www/images/icons/foodFactory/level1.png"},{level:5,price:12e5,profit:0,seconds:0,minutes:45,hours:2,day:0,mainBuilding:6,img:"www/images/icons/foodFactory/level1.png"},{level:6,price:16e5,profit:0,seconds:0,minutes:15,hours:3,day:0,mainBuilding:6,img:"www/images/icons/foodFactory/level1.png"},{level:7,price:2e6,profit:0,seconds:0,minutes:0,hours:4,day:0,mainBuilding:7,img:"www/images/icons/foodFactory/level1.png"},{level:8,price:26e5,profit:0,seconds:0,minutes:0,hours:5,day:0,mainBuilding:7,img:"www/images/icons/foodFactory/level1.png"},{level:9,price:34e5,profit:0,seconds:0,minutes:0,hours:6,day:0,mainBuilding:8,img:"www/images/icons/foodFactory/level1.png"},{level:10,price:44e5,profit:0,seconds:0,minutes:0,hours:8,day:0,mainBuilding:8,img:"www/images/icons/foodFactory/level1.png"}]},json_mainBuilding={type_id:0,building:[{type:[{type_id:1,name:"buildings",number:1},{type_id:2,name:"restaurant",number:1},{type_id:3,name:"food factory",number:0},{type_id:4,name:"Corporation",number:1},{type_id:5,name:"Accountant",number:0},{type_id:6,name:"Clothing Store",number:0},{type_id:7,name:"Factory clothing",number:0}]},{type:[{type_id:1,name:"buildings",number:3},{type_id:2,name:"restaurant",number:2},{type_id:3,name:"Factory factory",number:1},{type_id:4,name:"Corporation",number:1},{type_id:5,name:"Accountant",number:0},{type_id:6,name:"Clothing Store",number:0},{type_id:7,name:"Factory clothing",number:0}]},{type:[{type_id:1,name:"buildings",number:5},{type_id:2,name:"restaurant",number:2},{type_id:3,name:"Factory factory",number:1},{type_id:4,name:"Corporation",number:1},{type_id:5,name:"Accountant",number:0},{type_id:6,name:"Clothing Store",number:0},{type_id:7,name:"Factory clothing",number:0}]},{type:[{type_id:1,name:"buildings",number:7},{type_id:2,name:"restaurant",number:2},{type_id:3,name:"Factory factory",number:2},{type_id:4,name:"Corporation",number:1},{type_id:5,name:"Accountant",number:1},{type_id:6,name:"Clothing Store",number:0},{type_id:7,name:"Factory clothing",number:0}]},{type:[{type_id:1,name:"buildings",number:10},{type_id:2,name:"restaurant",number:3},{type_id:3,name:"Factory factory",number:2},{type_id:4,name:"Corporation",number:1},{type_id:5,name:"Accountant",number:1},{type_id:6,name:"Clothing Store",number:1},{type_id:7,name:"Factory clothing",number:0}]},{type:[{type_id:1,name:"buildings",number:12},{type_id:2,name:"restaurant",number:3},{type_id:3,name:"Factory factory",number:3},{type_id:4,name:"Corporation",number:1},{type_id:5,name:"Accountant",number:1},{type_id:6,name:"Clothing Store",number:2},{type_id:7,name:"Factory clothing",number:1}]},{type:[{type_id:1,name:"buildings",number:14},{type_id:2,name:"restaurant",number:4},{type_id:3,name:"Factory factory",number:4},{type_id:4,name:"Corporation",number:1},{type_id:5,name:"Accountant",number:1},{type_id:6,name:"Clothing Store",number:3},{type_id:7,name:"Factory clothing",number:2}]},{type:[{type_id:1,name:"buildings",number:18},{type_id:2,name:"restaurant",number:5},{type_id:3,name:"Factory factory",number:5},{type_id:4,name:"Corporation",number:1},{type_id:5,name:"Accountant",number:1},{type_id:6,name:"Clothing Store",number:4},{type_id:7,name:"Factory clothing",number:4}]}],levels:[{level:1,price:1e4,profit:0,seconds:0,minutes:0,hours:0,day:0,mainBuilding:0,img:"www/images/icons/main/level1.png"},{level:2,price:2e4,profit:0,seconds:5,minutes:0,hours:0,day:0,mainBuilding:0,img:"www/images/icons/main/level2.png"},{level:3,price:3e4,profit:0,seconds:0,minutes:10,hours:0,day:0,mainBuilding:0,img:"www/images/icons/main/level3.png"},{level:4,price:6e5,profit:0,seconds:0,minutes:30,hours:1,day:0,mainBuilding:0,img:"www/images/icons/main/level4.png"},{level:5,price:12e5,profit:0,seconds:0,minutes:0,hours:3,day:0,mainBuilding:0,img:"www/images/icons/main/level5.png"},{level:6,price:25e5,profit:0,seconds:0,minutes:0,hours:5,day:0,mainBuilding:0,img:"www/images/icons/main/level1.png"},{level:7,price:45e5,profit:0,seconds:0,minutes:0,hours:6,day:0,mainBuilding:0,img:"www/images/icons/main/level1.png"},{level:8,price:65e5,profit:0,seconds:0,minutes:0,hours:7,day:0,mainBuilding:0,img:"www/images/icons/main/level1.png"}]},json_residential={type_id:1,levels:[{level:1,price:6e4,profit:3e3,seconds:3,minutes:0,hours:0,day:0,mainBuilding:1,img:"www/images/icons/residential/level1.png"},{level:2,price:225e3,profit:3500,seconds:0,minutes:5,hours:0,day:0,mainBuilding:3,img:"www/images/icons/residential/level2.png"},{level:3,price:3e5,profit:4e3,seconds:0,minutes:20,hours:0,day:0,mainBuilding:3,img:"www/images/icons/residential/level3.png"},{level:4,price:45e4,profit:4500,seconds:0,minutes:45,hours:0,day:0,mainBuilding:4,img:"www/images/icons/residential/level4.png"},{level:5,price:6e5,profit:5e3,seconds:0,minutes:15,hours:1,day:0,mainBuilding:4,img:"www/images/icons/residential/level5.png"},{level:6,price:8e5,profit:6e3,seconds:0,minutes:45,hours:1,day:0,mainBuilding:5,img:"www/images/icons/residential/level1.png"},{level:7,price:1e6,profit:7500,seconds:0,minutes:15,hours:2,day:0,mainBuilding:6,img:"www/images/icons/residential/level1.png"},{level:8,price:13e5,profit:9e3,seconds:0,minutes:45,hours:2,day:0,mainBuilding:6,img:"www/images/icons/residential/level1.png"},{level:9,price:17e5,profit:11e3,seconds:0,minutes:30,hours:3,day:0,mainBuilding:7,img:"www/images/icons/residential/level1.png"},{level:10,price:26e5,profit:12e3,seconds:0,minutes:0,hours:4,day:0,mainBuilding:7,img:"www/images/icons/residential/level1.png"},{level:11,price:34e5,profit:15e3,seconds:0,minutes:0,hours:5,day:0,mainBuilding:8,img:"www/images/icons/residential/level1.png"},{level:12,price:45e5,profit:18e3,seconds:0,minutes:0,hours:6,day:0,mainBuilding:8,img:"www/images/icons/residential/level1.png"}]},json_restaurant={type_id:1,levels:[{level:1,price:5e4,profit:2e3,seconds:3,minutes:0,hours:0,day:0,mainBuilding:1,img:"www/images/icons/restaurant/level1.png"},{level:2,price:225e3,profit:2500,seconds:0,minutes:5,hours:0,day:0,mainBuilding:3,img:"www/images/icons/restaurant/level1.png"},{level:3,price:3e5,profit:3e3,seconds:0,minutes:45,hours:0,day:0,mainBuilding:3,img:"www/images/icons/restaurant/level1.png"},{level:4,price:45e4,profit:3500,seconds:0,minutes:30,hours:1,day:0,mainBuilding:4,img:"www/images/icons/restaurant/level1.png"},{level:5,price:6e5,profit:4e3,seconds:0,minutes:30,hours:2,day:0,mainBuilding:4,img:"www/images/icons/restaurant/level1.png"},{level:6,price:8e5,profit:5e3,seconds:0,minutes:0,hours:4,day:0,mainBuilding:5,img:"www/images/icons/restaurant/level1.png"},{level:7,price:1e6,profit:6e3,seconds:0,minutes:0,hours:6,day:0,mainBuilding:6,img:"www/images/icons/restaurant/level1.png"},{level:8,price:13e5,profit:7e3,seconds:0,minutes:0,hours:8,day:0,mainBuilding:6,img:"www/images/icons/restaurant/level1.png"},{level:9,price:17e5,profit:8500,seconds:0,minutes:0,hours:10,day:0,mainBuilding:7,img:"www/images/icons/restaurant/level1.png"},{level:10,price:26e5,profit:11500,seconds:0,minutes:0,hours:12,day:0,mainBuilding:7,img:"www/images/icons/restaurant/level1.png"},{level:11,price:34e5,profit:13e3,seconds:0,minutes:0,hours:14,day:0,mainBuilding:8,img:"www/images/icons/restaurant/level1.png"},{level:12,price:45e5,profit:15e3,seconds:0,minutes:0,hours:16,day:0,mainBuilding:8,img:"www/images/icons/restaurant/level1.png"}]},json_accountant={type_id:5,levels:[{level:1,price:1e5,profit:0,seconds:10,minutes:0,hours:0,day:0,maxMoney:3e6,mainBuilding:1,img:"www/images/icons/accountant/level1.png"},{level:2,price:1e5,profit:0,seconds:10,minutes:0,hours:0,day:0,maxMoney:4e6,mainBuilding:1,img:"www/images/icons/accountant/level1.png"},{level:3,price:1e5,profit:0,seconds:10,minutes:0,hours:0,day:0,maxMoney:5e6,mainBuilding:1,img:"www/images/icons/accountant/level1.png"},{level:4,price:1e5,profit:0,seconds:10,minutes:0,hours:0,day:0,maxMoney:6e6,mainBuilding:1,img:"www/images/icons/accountant/level1.png"},{level:5,price:1e5,profit:0,seconds:10,minutes:0,hours:0,day:0,maxMoney:7e6,mainBuilding:1,img:"www/images/icons/accountant/level1.png"},{level:6,price:1e5,profit:0,seconds:10,minutes:0,hours:0,day:0,maxMoney:8e6,mainBuilding:1,img:"www/images/icons/accountant/level1.png"},{level:7,price:1e5,profit:0,seconds:10,minutes:0,hours:0,day:0,maxMoney:9e6,mainBuilding:1,img:"www/images/icons/accountant/level1.png"},{level:8,price:1e5,profit:0,seconds:10,minutes:0,hours:0,day:0,maxMoney:1e7,mainBuilding:1,img:"www/images/icons/accountant/level1.png"},{level:9,price:1e5,profit:0,seconds:10,minutes:0,hours:0,day:0,maxMoney:11e6,mainBuilding:1,img:"www/images/icons/accountant/level1.png"},{level:10,price:1e5,profit:0,seconds:10,minutes:0,hours:0,day:0,maxMoney:12e6,mainBuilding:1,img:"www/images/icons/accountant/level1.png"}]},json_clothingStore={type_id:6,levels:[{level:1,price:2e5,profit:4500,seconds:30,minutes:0,hours:0,day:0,mainBuilding:1,img:"www/images/icons/clothingStore/level1.png"},{level:2,price:3e5,profit:5500,seconds:0,minutes:5,hours:0,day:0,mainBuilding:1,img:"www/images/icons/clothingStore/level1.png"},{level:3,price:5e5,profit:7500,seconds:0,minutes:30,hours:0,day:0,mainBuilding:3,img:"www/images/icons/clothingStore/level1.png"},{level:4,price:8e5,profit:11e3,seconds:0,minutes:45,hours:1,day:0,mainBuilding:3,img:"www/images/icons/clothingStore/level1.png"},{level:5,price:12e6,profit:15e3,seconds:0,minutes:30,hours:2,day:0,mainBuilding:4,img:"www/images/icons/clothingStore/level1.png"},{level:6,price:2e6,profit:2e4,seconds:0,minutes:0,hours:6,day:0,mainBuilding:5,img:"www/images/icons/clothingStore/level1.png"},{level:7,price:29e5,profit:24e3,seconds:0,minutes:0,hours:8,day:0,mainBuilding:6,img:"www/images/icons/clothingStore/level1.png"},{level:8,price:36e5,profit:3e4,seconds:0,minutes:0,hours:10,day:0,mainBuilding:7,img:"www/images/icons/clothingStore/level1.png"},{level:9,price:5e6,profit:38e3,seconds:0,minutes:0,hours:12,day:0,mainBuilding:7,img:"www/images/icons/clothingStore/level1.png"},{level:10,price:8e6,profit:58e3,seconds:0,minutes:0,hours:14,day:0,mainBuilding:7,img:"www/images/icons/clothingStore/level1.png"},{level:11,price:12e6,profit:75e3,seconds:0,minutes:0,hours:20,day:0,mainBuilding:7,img:"www/images/icons/clothingStore/level1.png"},{level:12,price:2e7,profit:113e3,seconds:0,minutes:0,hours:12,day:1,mainBuilding:7,img:"www/images/icons/clothingStore/level1.png"}]},json_clothingFactory={type_id:7,levels:[{level:1,price:2e5,profit:4500,seconds:30,minutes:0,hours:0,day:0,mainBuilding:1,img:"www/images/icons/clothingFactory/level1.png"},{level:2,price:3e5,profit:5500,seconds:0,minutes:5,hours:0,day:0,mainBuilding:1,img:"www/images/icons/clothingFactory/level1.png"},{level:3,price:5e5,profit:7500,seconds:0,minutes:30,hours:0,day:0,mainBuilding:3,img:"www/images/icons/clothingFactory/level1.png"},{level:4,price:8e5,profit:11e3,seconds:0,minutes:45,hours:1,day:0,mainBuilding:3,img:"www/images/icons/clothingFactory/level1.png"},{level:5,price:12e6,profit:15e3,seconds:0,minutes:30,hours:2,day:0,mainBuilding:4,img:"www/images/icons/clothingFactory/level1.png"},{level:6,price:2e6,profit:2e4,seconds:0,minutes:0,hours:6,day:0,mainBuilding:5,img:"www/images/icons/clothingFactory/level1.png"},{level:7,price:29e5,profit:24e3,seconds:0,minutes:0,hours:8,day:0,mainBuilding:6,img:"www/images/icons/clothingFactory/level1.png"},{level:8,price:36e5,profit:3e4,seconds:0,minutes:0,hours:10,day:0,mainBuilding:7,img:"www/images/icons/clothingFactory/level1.png"},{level:9,price:5e6,profit:38e3,seconds:0,minutes:0,hours:12,day:0,mainBuilding:7,img:"www/images/icons/clothingFactory/level1.png"},{level:10,price:8e6,profit:58e3,seconds:0,minutes:0,hours:14,day:0,mainBuilding:7,img:"www/images/icons/clothingFactory/level1.png"},{level:11,price:12e6,profit:75e3,seconds:0,minutes:0,hours:20,day:0,mainBuilding:7,img:"www/images/icons/clothingFactory/level1.png"},{level:12,price:2e7,profit:113e3,seconds:0,minutes:0,hours:12,day:1,mainBuilding:7,img:"www/images/icons/clothingFactory/level1.png"}]};$.rootUrl="";var global=new globalJs;$(function(){function e(){n(),s(),c(),f(),g(),d(),u(),l(),_(),m(),p(),v(),o(),h(),y(),b(),r(),a(),w(),x(),k(),i(),t()}function t(){$(".global_page_notebookNav").load("www/pages/notebookNav/notebookNav.html",function(){notebookNav.ctor()})}function n(){$(".global_page_header").load("www/header/header.html",function(){header.ctor(),header_notifcations.ctor()})}function o(){$(".global_page_chat").load("www/pages/chat/chat.html",function(){chat.ctor()})}function i(){$(".global_page_rank").load("www/pages/rank/rank.html",function(){rank.ctor()})}function r(){$(".global_page_notebook").load("www/pages/notebook/notebook.html",function(){notebook.ctor()})}function a(){$(".global_page_war").load("www/pages/war/war.html",function(){war.ctor()})}function s(){$(".global_page_login").load("www/pages/login/login.html",function(){login.ctor()})}function l(){$(".global_page_petek").load("www/pages/petek/petek.html",function(){petek.ctor()})}function c(){$(".global_page_addBuilding").load("www/pages/addBuilding/addBuilding.html",function(){addBuilding.ctor()})}function d(){$(".global_page_youtube").load("www/pages/youtube/youtube.html",function(){youtube.ctor()})}function u(){$(".global_page_company").load("www/pages/company/company.html",function(){company.ctor()})}function p(){$(".global_page_profile").load("www/pages/profile/profile.html",function(){profile.ctor()})}function h(){$(".global_page_upgradeBuilding").load("www/pages/upgradeBuilding/upgradeBuilding.html",function(){upgradeBuilding.ctor()})}function f(){$(".global_page_feed").load("www/pages/feed/feed.html",function(){feed.ctor()})}function _(){$(".global_page_runningTimes").load("www/pages/runningTimes/runningTimes.html",function(){runningTimes.ctor(),runningTimes.showPage()})}function m(){$(".global_page_payment").load("www/pages/payment/payment.html",function(){payment.ctor()})}function g(){setTimeout(function(){$(".global_page_map").load("www/pages/map/map.html",function(){$(".global_page_map").show(),global.main(),map_click.ctor(),setTimeout(function(){map_findStreetName.initMap()},1e3)})},1e3)}function v(){$(".global_page_mentor").load("www/pages/mentor/mentor.html",function(){mentor.ctor()})}function y(){$(".global_page_bgElements").load("www/pages/bgElements/bgElements.html",function(){bgElements.ctor()})}function b(){$(".global_page_searchResults").load("www/pages/searchResults/searchResults.html",function(){searchResults.ctor()})}function w(){$(".global_page_popup").load("www/pages/popup/popup.html",function(){popup.ctor()})}function x(){$(".global_page_choicePopup").load("www/pages/choicePopup/choicePopup.html",function(){choicePopup.ctor()})}function k(){$(".global_page_alert").load("www/pages/alert/alert.html",function(){valert.ctor()})}e()});var pages=new pagesJS,buildingsJson=new buildingsJsonJs,help=new helpJs,formulas=new formulasJs;!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.io=e()}}(function(){var e;return function t(e,n,o){function i(a,s){if(!n[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=n[a]={exports:{}};e[a][0].call(c.exports,function(t){var n=e[a][1][t];return i(n?n:t)},c,c.exports,t,e,n,o)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(e,t,n){t.exports=e("./lib/")},{"./lib/":2}],2:[function(e,t,n){function o(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,o=i(e),r=o.source,c=o.id;return t.forceNew||t["force new connection"]||!1===t.multiplex?(s("ignoring socket cache for %s",r),n=a(r,t)):(l[c]||(s("new io instance for %s",r),l[c]=a(r,t)),n=l[c]),n.socket(o.path)}var i=e("./url"),r=e("socket.io-parser"),a=e("./manager"),s=e("debug")("socket.io-client");t.exports=n=o;var l=n.managers={};n.protocol=r.protocol,n.connect=o,n.Manager=e("./manager"),n.Socket=e("./socket")},{"./manager":3,"./socket":5,"./url":6,debug:10,"socket.io-parser":44}],3:[function(e,t,n){function o(e,t){return this instanceof o?(e&&"object"==typeof e&&(t=e,e=void 0),t=t||{},t.path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(t.reconnection!==!1),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new p({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),
jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connected=[],this.encoding=!1,this.packetBuffer=[],this.encoder=new s.Encoder,this.decoder=new s.Decoder,this.autoConnect=t.autoConnect!==!1,void(this.autoConnect&&this.open())):new o(e,t)}var i=(e("./url"),e("engine.io-client")),r=e("./socket"),a=e("component-emitter"),s=e("socket.io-parser"),l=e("./on"),c=e("component-bind"),d=(e("object-component"),e("debug")("socket.io-client:manager")),u=e("indexof"),p=e("backo2");t.exports=o,o.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps)this.nsps[e].emit.apply(this.nsps[e],arguments)},o.prototype.updateSocketIds=function(){for(var e in this.nsps)this.nsps[e].id=this.engine.id},a(o.prototype),o.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},o.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},o.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},o.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},o.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},o.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},o.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},o.prototype.open=o.prototype.connect=function(e){if(d("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;d("opening %s",this.uri),this.engine=i(this.uri,this.opts);var t=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var o=l(t,"open",function(){n.onopen(),e&&e()}),r=l(t,"error",function(t){if(d("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",t),e){var o=new Error("Connection error");o.data=t,e(o)}else n.maybeReconnectOnOpen()});if(!1!==this._timeout){var a=this._timeout;d("connect attempt will timeout after %d",a);var s=setTimeout(function(){d("connect attempt timed out after %d",a),o.destroy(),t.close(),t.emit("error","timeout"),n.emitAll("connect_timeout",a)},a);this.subs.push({destroy:function(){clearTimeout(s)}})}return this.subs.push(o),this.subs.push(r),this},o.prototype.onopen=function(){d("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(l(e,"data",c(this,"ondata"))),this.subs.push(l(this.decoder,"decoded",c(this,"ondecoded"))),this.subs.push(l(e,"error",c(this,"onerror"))),this.subs.push(l(e,"close",c(this,"onclose")))},o.prototype.ondata=function(e){this.decoder.add(e)},o.prototype.ondecoded=function(e){this.emit("packet",e)},o.prototype.onerror=function(e){d("error",e),this.emitAll("error",e)},o.prototype.socket=function(e){var t=this.nsps[e];if(!t){t=new r(this,e),this.nsps[e]=t;var n=this;t.on("connect",function(){t.id=n.engine.id,~u(n.connected,t)||n.connected.push(t)})}return t},o.prototype.destroy=function(e){var t=u(this.connected,e);~t&&this.connected.splice(t,1),this.connected.length||this.close()},o.prototype.packet=function(e){d("writing packet %j",e);var t=this;t.encoding?t.packetBuffer.push(e):(t.encoding=!0,this.encoder.encode(e,function(e){for(var n=0;n<e.length;n++)t.engine.write(e[n]);t.encoding=!1,t.processPacketQueue()}))},o.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},o.prototype.cleanup=function(){for(var e;e=this.subs.shift();)e.destroy();this.packetBuffer=[],this.encoding=!1,this.decoder.destroy()},o.prototype.close=o.prototype.disconnect=function(){this.skipReconnect=!0,this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},o.prototype.onclose=function(e){d("close"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},o.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var e=this;if(this.backoff.attempts>=this._reconnectionAttempts)d("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var t=this.backoff.duration();d("will wait %dms before reconnect attempt",t),this.reconnecting=!0;var n=setTimeout(function(){e.skipReconnect||(d("attempting reconnect"),e.emitAll("reconnect_attempt",e.backoff.attempts),e.emitAll("reconnecting",e.backoff.attempts),e.skipReconnect||e.open(function(t){t?(d("reconnect attempt error"),e.reconnecting=!1,e.reconnect(),e.emitAll("reconnect_error",t.data)):(d("reconnect success"),e.onreconnect())}))},t);this.subs.push({destroy:function(){clearTimeout(n)}})}},o.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},{"./on":4,"./socket":5,"./url":6,backo2:7,"component-bind":8,"component-emitter":9,debug:10,"engine.io-client":11,indexof:40,"object-component":41,"socket.io-parser":44}],4:[function(e,t,n){function o(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}t.exports=o},{}],5:[function(e,t,n){function o(e,t){this.io=e,this.nsp=t,this.json=this,this.ids=0,this.acks={},this.io.autoConnect&&this.open(),this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0}var i=e("socket.io-parser"),r=e("component-emitter"),a=e("to-array"),s=e("./on"),l=e("component-bind"),c=e("debug")("socket.io-client:socket"),d=e("has-binary");t.exports=n=o;var u={connect:1,connect_error:1,connect_timeout:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1},p=r.prototype.emit;r(o.prototype),o.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[s(e,"open",l(this,"onopen")),s(e,"packet",l(this,"onpacket")),s(e,"close",l(this,"onclose"))]}},o.prototype.open=o.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"==this.io.readyState&&this.onopen(),this)},o.prototype.send=function(){var e=a(arguments);return e.unshift("message"),this.emit.apply(this,e),this},o.prototype.emit=function(e){if(u.hasOwnProperty(e))return p.apply(this,arguments),this;var t=a(arguments),n=i.EVENT;d(t)&&(n=i.BINARY_EVENT);var o={type:n,data:t};return"function"==typeof t[t.length-1]&&(c("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),o.id=this.ids++),this.connected?this.packet(o):this.sendBuffer.push(o),this},o.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},o.prototype.onopen=function(){c("transport is open - connecting"),"/"!=this.nsp&&this.packet({type:i.CONNECT})},o.prototype.onclose=function(e){c("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},o.prototype.onpacket=function(e){if(e.nsp==this.nsp)switch(e.type){case i.CONNECT:this.onconnect();break;case i.EVENT:this.onevent(e);break;case i.BINARY_EVENT:this.onevent(e);break;case i.ACK:this.onack(e);break;case i.BINARY_ACK:this.onack(e);break;case i.DISCONNECT:this.ondisconnect();break;case i.ERROR:this.emit("error",e.data)}},o.prototype.onevent=function(e){var t=e.data||[];c("emitting event %j",t),null!=e.id&&(c("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?p.apply(this,t):this.receiveBuffer.push(t)},o.prototype.ack=function(e){var t=this,n=!1;return function(){if(!n){n=!0;var o=a(arguments);c("sending ack %j",o);var r=d(o)?i.BINARY_ACK:i.ACK;t.packet({type:r,id:e,data:o})}}},o.prototype.onack=function(e){c("calling ack %s with %j",e.id,e.data);var t=this.acks[e.id];t.apply(this,e.data),delete this.acks[e.id]},o.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},o.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)p.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},o.prototype.ondisconnect=function(){c("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},o.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},o.prototype.close=o.prototype.disconnect=function(){return this.connected&&(c("performing disconnect (%s)",this.nsp),this.packet({type:i.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}},{"./on":4,"component-bind":8,"component-emitter":9,debug:10,"has-binary":36,"socket.io-parser":44,"to-array":48}],6:[function(e,t,n){(function(n){function o(e,t){var o=e,t=t||n.location;return null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"==e.charAt(0)&&(e="/"==e.charAt(1)?t.protocol+e:t.hostname+e),/^(https?|wss?):\/\//.test(e)||(r("protocol-less url %s",e),e="undefined"!=typeof t?t.protocol+"//"+e:"https://"+e),r("parse %s",e),o=i(e)),o.port||(/^(http|ws)$/.test(o.protocol)?o.port="80":/^(http|ws)s$/.test(o.protocol)&&(o.port="443")),o.path=o.path||"/",o.id=o.protocol+"://"+o.host+":"+o.port,o.href=o.protocol+"://"+o.host+(t&&t.port==o.port?"":":"+o.port),o}var i=e("parseuri"),r=e("debug")("socket.io-client:url");t.exports=o}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{debug:10,parseuri:42}],7:[function(e,t,n){function o(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}t.exports=o,o.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},o.prototype.reset=function(){this.attempts=0},o.prototype.setMin=function(e){this.ms=e},o.prototype.setMax=function(e){this.max=e},o.prototype.setJitter=function(e){this.jitter=e}},{}],8:[function(e,t,n){var o=[].slice;t.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var n=o.call(arguments,2);return function(){return t.apply(e,n.concat(o.call(arguments)))}}},{}],9:[function(e,t,n){function o(e){return e?i(e):void 0}function i(e){for(var t in o.prototype)e[t]=o.prototype[t];return e}t.exports=o,o.prototype.on=o.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this},o.prototype.once=function(e,t){function n(){o.off(e,n),t.apply(this,arguments)}var o=this;return this._callbacks=this._callbacks||{},n.fn=t,this.on(e,n),this},o.prototype.off=o.prototype.removeListener=o.prototype.removeAllListeners=o.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n=this._callbacks[e];if(!n)return this;if(1==arguments.length)return delete this._callbacks[e],this;for(var o,i=0;i<n.length;i++)if(o=n[i],o===t||o.fn===t){n.splice(i,1);break}return this},o.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks[e];if(n){n=n.slice(0);for(var o=0,i=n.length;i>o;++o)n[o].apply(this,t)}return this},o.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]},o.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],10:[function(e,t,n){function o(e){return o.enabled(e)?function(t){t=i(t);var n=new Date,r=n-(o[e]||n);o[e]=n,t=e+" "+t+" +"+o.humanize(r),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function i(e){return e instanceof Error?e.stack||e.message:e}t.exports=o,o.names=[],o.skips=[],o.enable=function(e){try{localStorage.debug=e}catch(t){}for(var n=(e||"").split(/[\s,]+/),i=n.length,r=0;i>r;r++)e=n[r].replace("*",".*?"),"-"===e[0]?o.skips.push(new RegExp("^"+e.substr(1)+"$")):o.names.push(new RegExp("^"+e+"$"))},o.disable=function(){o.enable("")},o.humanize=function(e){var t=1e3,n=6e4,o=60*n;return e>=o?(e/o).toFixed(1)+"h":e>=n?(e/n).toFixed(1)+"m":e>=t?(e/t|0)+"s":e+"ms"},o.enabled=function(e){for(var t=0,n=o.skips.length;n>t;t++)if(o.skips[t].test(e))return!1;for(var t=0,n=o.names.length;n>t;t++)if(o.names[t].test(e))return!0;return!1};try{window.localStorage&&o.enable(localStorage.debug)}catch(r){}},{}],11:[function(e,t,n){t.exports=e("./lib/")},{"./lib/":12}],12:[function(e,t,n){t.exports=e("./socket"),t.exports.parser=e("engine.io-parser")},{"./socket":13,"engine.io-parser":25}],13:[function(e,t,n){(function(n){function o(e,t){if(!(this instanceof o))return new o(e,t);if(t=t||{},e&&"object"==typeof e&&(t=e,e=null),e&&(e=d(e),t.host=e.host,t.secure="https"==e.protocol||"wss"==e.protocol,t.port=e.port,e.query&&(t.query=e.query)),this.secure=null!=t.secure?t.secure:n.location&&"https:"==location.protocol,t.host){var i=t.host.split(":");t.hostname=i.shift(),i.length?t.port=i.pop():t.port||(t.port=this.secure?"443":"80")}this.agent=t.agent||!1,this.hostname=t.hostname||(n.location?location.hostname:"localhost"),this.port=t.port||(n.location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=p.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.callbackBuffer=[],this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=t.rejectUnauthorized||null,this.open()}function i(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}var r=e("./transports"),a=e("component-emitter"),s=e("debug")("engine.io-client:socket"),l=e("indexof"),c=e("engine.io-parser"),d=e("parseuri"),u=e("parsejson"),p=e("parseqs");t.exports=o,o.priorWebsocketSuccess=!1,a(o.prototype),o.protocol=c.protocol,o.Socket=o,o.Transport=e("./transport"),o.transports=e("./transports"),o.parser=e("engine.io-parser"),o.prototype.createTransport=function(e){s('creating transport "%s"',e);var t=i(this.query);t.EIO=c.protocol,t.transport=e,this.id&&(t.sid=this.id);var n=new r[e]({agent:this.agent,hostname:this.hostname,port:this.port,secure:this.secure,path:this.path,query:t,forceJSONP:this.forceJSONP,jsonp:this.jsonp,forceBase64:this.forceBase64,enablesXDR:this.enablesXDR,timestampRequests:this.timestampRequests,timestampParam:this.timestampParam,policyPort:this.policyPort,socket:this,pfx:this.pfx,key:this.key,passphrase:this.passphrase,cert:this.cert,ca:this.ca,ciphers:this.ciphers,rejectUnauthorized:this.rejectUnauthorized});return n},o.prototype.open=function(){var e;if(this.rememberUpgrade&&o.priorWebsocketSuccess&&-1!=this.transports.indexOf("websocket"))e="websocket";else{if(0==this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";var e;try{e=this.createTransport(e)}catch(n){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},o.prototype.setTransport=function(e){s("setting transport %s",e.name);var t=this;this.transport&&(s("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},o.prototype.probe=function(e){function t(){if(p.onlyBinaryUpgrades){var t=!this.supportsBinary&&p.transport.supportsBinary;u=u||t}u||(s('probe transport "%s" opened',e),d.send([{type:"ping",data:"probe"}]),d.once("packet",function(t){if(!u)if("pong"==t.type&&"probe"==t.data){if(s('probe transport "%s" pong',e),p.upgrading=!0,p.emit("upgrading",d),!d)return;o.priorWebsocketSuccess="websocket"==d.name,s('pausing current transport "%s"',p.transport.name),p.transport.pause(function(){u||"closed"!=p.readyState&&(s("changing transport and sending upgrade packet"),c(),p.setTransport(d),d.send([{type:"upgrade"}]),p.emit("upgrade",d),d=null,p.upgrading=!1,p.flush())})}else{s('probe transport "%s" failed',e);var n=new Error("probe error");n.transport=d.name,p.emit("upgradeError",n)}}))}function n(){u||(u=!0,c(),d.close(),d=null)}function i(t){var o=new Error("probe error: "+t);o.transport=d.name,n(),s('probe transport "%s" failed because of error: %s',e,t),p.emit("upgradeError",o)}function r(){i("transport closed")}function a(){i("socket closed")}function l(e){d&&e.name!=d.name&&(s('"%s" works - aborting "%s"',e.name,d.name),n())}function c(){d.removeListener("open",t),d.removeListener("error",i),d.removeListener("close",r),p.removeListener("close",a),p.removeListener("upgrading",l)}s('probing transport "%s"',e);var d=this.createTransport(e,{probe:1}),u=!1,p=this;o.priorWebsocketSuccess=!1,d.once("open",t),d.once("error",i),d.once("close",r),this.once("close",a),this.once("upgrading",l),d.open()},o.prototype.onOpen=function(){if(s("socket open"),this.readyState="open",o.priorWebsocketSuccess="websocket"==this.transport.name,this.emit("open"),this.flush(),"open"==this.readyState&&this.upgrade&&this.transport.pause){s("starting upgrade probes");for(var e=0,t=this.upgrades.length;t>e;e++)this.probe(this.upgrades[e])}},o.prototype.onPacket=function(e){if("opening"==this.readyState||"open"==this.readyState)switch(s('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(u(e.data));break;case"pong":this.setPing();break;case"error":var t=new Error("server error");t.code=e.data,this.emit("error",t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else s('packet received with socket readyState "%s"',this.readyState)},o.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!=this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},o.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!=t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},o.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){s("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},o.prototype.ping=function(){this.sendPacket("ping")},o.prototype.onDrain=function(){for(var e=0;e<this.prevBufferLen;e++)this.callbackBuffer[e]&&this.callbackBuffer[e]();this.writeBuffer.splice(0,this.prevBufferLen),this.callbackBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0==this.writeBuffer.length?this.emit("drain"):this.flush()},o.prototype.flush=function(){"closed"!=this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(s("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},o.prototype.write=o.prototype.send=function(e,t){return this.sendPacket("message",e,t),this},o.prototype.sendPacket=function(e,t,n){if("closing"!=this.readyState&&"closed"!=this.readyState){var o={type:e,data:t};this.emit("packetCreate",o),this.writeBuffer.push(o),this.callbackBuffer.push(n),this.flush()}},o.prototype.close=function(){function e(){o.onClose("forced close"),s("socket closing - telling transport to close"),o.transport.close()}function t(){o.removeListener("upgrade",t),o.removeListener("upgradeError",t),e()}function n(){o.once("upgrade",t),o.once("upgradeError",t)}if("opening"==this.readyState||"open"==this.readyState){this.readyState="closing";var o=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?n():e()}):this.upgrading?n():e()}return this},o.prototype.onError=function(e){s("socket error %j",e),o.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},o.prototype.onClose=function(e,t){if("opening"==this.readyState||"open"==this.readyState||"closing"==this.readyState){s('socket close with reason: "%s"',e);var n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),setTimeout(function(){n.writeBuffer=[],n.callbackBuffer=[],n.prevBufferLen=0},0),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t)}},o.prototype.filterUpgrades=function(e){for(var t=[],n=0,o=e.length;o>n;n++)~l(this.transports,e[n])&&t.push(e[n]);return t}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./transport":14,"./transports":15,"component-emitter":9,debug:22,"engine.io-parser":25,indexof:40,parsejson:32,parseqs:33,parseuri:34}],14:[function(e,t,n){function o(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized}var i=e("engine.io-parser"),r=e("component-emitter");t.exports=o,r(o.prototype),o.timestamps=0,o.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},o.prototype.open=function(){return("closed"==this.readyState||""==this.readyState)&&(this.readyState="opening",this.doOpen()),this},o.prototype.close=function(){return("opening"==this.readyState||"open"==this.readyState)&&(this.doClose(),this.onClose()),this},o.prototype.send=function(e){if("open"!=this.readyState)throw new Error("Transport not open");this.write(e)},o.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},o.prototype.onData=function(e){var t=i.decodePacket(e,this.socket.binaryType);this.onPacket(t)},o.prototype.onPacket=function(e){this.emit("packet",e)},o.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},{"component-emitter":9,"engine.io-parser":25}],15:[function(e,t,n){(function(t){function o(e){var n,o=!1,s=!1,l=!1!==e.jsonp;if(t.location){var c="https:"==location.protocol,d=location.port;d||(d=c?443:80),o=e.hostname!=location.hostname||d!=e.port,s=e.secure!=c}if(e.xdomain=o,e.xscheme=s,n=new i(e),"open"in n&&!e.forceJSONP)return new r(e);if(!l)throw new Error("JSONP disabled");return new a(e)}var i=e("xmlhttprequest"),r=e("./polling-xhr"),a=e("./polling-jsonp"),s=e("./websocket");n.polling=o,n.websocket=s}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling-jsonp":16,"./polling-xhr":17,"./websocket":19,xmlhttprequest:20}],16:[function(e,t,n){(function(n){function o(){}function i(e){r.call(this,e),this.query=this.query||{},s||(n.___eio||(n.___eio=[]),s=n.___eio),this.index=s.length;var t=this;s.push(function(e){t.onData(e)}),this.query.j=this.index,n.document&&n.addEventListener&&n.addEventListener("beforeunload",function(){t.script&&(t.script.onerror=o)},!1)}var r=e("./polling"),a=e("component-inherit");t.exports=i;var s,l=/\n/g,c=/\\n/g;a(i,r),i.prototype.supportsBinary=!1,i.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),r.prototype.doClose.call(this)},i.prototype.doPoll=function(){var e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(t,n),this.script=t;var o="undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent);o&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},i.prototype.doWrite=function(e,t){function n(){o(),t()}function o(){if(i.iframe)try{i.form.removeChild(i.iframe)}catch(e){i.onError("jsonp polling iframe removal error",e)}try{var t='<iframe src="javascript:0" name="'+i.iframeId+'">';r=document.createElement(t)}catch(e){r=document.createElement("iframe"),r.name=i.iframeId,r.src="javascript:0"}r.id=i.iframeId,i.form.appendChild(r),i.iframe=r}var i=this;if(!this.form){var r,a=document.createElement("form"),s=document.createElement("textarea"),d=this.iframeId="eio_iframe_"+this.index;a.className="socketio",a.style.position="absolute",a.style.top="-1000px",a.style.left="-1000px",a.target=d,a.method="POST",a.setAttribute("accept-charset","utf-8"),s.name="d",a.appendChild(s),document.body.appendChild(a),this.form=a,this.area=s}this.form.action=this.uri(),o(),e=e.replace(c,"\\\n"),this.area.value=e.replace(l,"\\n");try{this.form.submit()}catch(u){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"==i.iframe.readyState&&n()}:this.iframe.onload=n}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-inherit":21}],17:[function(e,t,n){(function(n){function o(){}function i(e){if(l.call(this,e),n.location){var t="https:"==location.protocol,o=location.port;o||(o=t?443:80),this.xd=e.hostname!=n.location.hostname||o!=e.port,this.xs=e.secure!=t}}function r(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!=e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.create()}function a(){for(var e in r.requests)r.requests.hasOwnProperty(e)&&r.requests[e].abort()}var s=e("xmlhttprequest"),l=e("./polling"),c=e("component-emitter"),d=e("component-inherit"),u=e("debug")("engine.io-client:polling-xhr");t.exports=i,t.exports.Request=r,d(i,l),i.prototype.supportsBinary=!0,i.prototype.request=function(e){return e=e||{},e.uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,new r(e)},i.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,o=this.request({method:"POST",data:e,isBinary:n}),i=this;o.on("success",t),o.on("error",function(e){i.onError("xhr post error",e)}),this.sendXhr=o},i.prototype.doPoll=function(){u("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},c(r.prototype),r.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new s(e),o=this;try{if(u("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async),this.supportsBinary&&(t.responseType="arraybuffer"),"POST"==this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(i){}"withCredentials"in t&&(t.withCredentials=!0),this.hasXDR()?(t.onload=function(){o.onLoad()},t.onerror=function(){o.onError(t.responseText)}):t.onreadystatechange=function(){4==t.readyState&&(200==t.status||1223==t.status?o.onLoad():setTimeout(function(){o.onError(t.status)},0))},u("xhr data %s",this.data),t.send(this.data)}catch(i){return void setTimeout(function(){o.onError(i)},0)}n.document&&(this.index=r.requestsCount++,r.requests[this.index]=this)},r.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},r.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},r.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},r.prototype.cleanup=function(e){if("undefined"!=typeof this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=o:this.xhr.onreadystatechange=o,e)try{this.xhr.abort()}catch(t){}n.document&&delete r.requests[this.index],this.xhr=null}},r.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type").split(";")[0]}catch(n){}e="application/octet-stream"===t?this.xhr.response:this.supportsBinary?"ok":this.xhr.responseText}catch(n){this.onError(n)}null!=e&&this.onData(e)},r.prototype.hasXDR=function(){return"undefined"!=typeof n.XDomainRequest&&!this.xs&&this.enablesXDR},r.prototype.abort=function(){this.cleanup()},n.document&&(r.requestsCount=0,r.requests={},n.attachEvent?n.attachEvent("onunload",a):n.addEventListener&&n.addEventListener("beforeunload",a,!1))}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./polling":18,"component-emitter":9,"component-inherit":21,debug:22,xmlhttprequest:20}],18:[function(e,t,n){function o(e){var t=e&&e.forceBase64;(!c||t)&&(this.supportsBinary=!1),i.call(this,e)}var i=e("../transport"),r=e("parseqs"),a=e("engine.io-parser"),s=e("component-inherit"),l=e("debug")("engine.io-client:polling");t.exports=o;var c=function(){var t=e("xmlhttprequest"),n=new t({xdomain:!1});return null!=n.responseType}();s(o,i),o.prototype.name="polling",o.prototype.doOpen=function(){this.poll()},o.prototype.pause=function(e){function t(){l("paused"),n.readyState="paused",e()}var n=this;if(this.readyState="pausing",this.polling||!this.writable){var o=0;this.polling&&(l("we are currently polling - waiting to pause"),o++,this.once("pollComplete",function(){l("pre-pause polling complete"),--o||t()})),this.writable||(l("we are currently writing - waiting to pause"),o++,this.once("drain",function(){l("pre-pause writing complete"),--o||t()}))}else t()},o.prototype.poll=function(){l("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},o.prototype.onData=function(e){var t=this;l("polling got data %s",e);var n=function(e,n,o){return"opening"==t.readyState&&t.onOpen(),"close"==e.type?(t.onClose(),!1):void t.onPacket(e)};a.decodePayload(e,this.socket.binaryType,n),"closed"!=this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"==this.readyState?this.poll():l('ignoring poll - transport state "%s"',this.readyState))},o.prototype.doClose=function(){function e(){l("writing close packet"),t.write([{type:"close"}])}var t=this;"open"==this.readyState?(l("transport open - closing"),e()):(l("transport not open - deferring close"),this.once("open",e))},o.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")},t=this;a.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},o.prototype.uri=function(){
var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=+new Date+"-"+i.timestamps++),this.supportsBinary||e.sid||(e.b64=1),e=r.encode(e),this.port&&("https"==t&&443!=this.port||"http"==t&&80!=this.port)&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+this.hostname+n+this.path+e}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:33,xmlhttprequest:20}],19:[function(e,t,n){function o(e){var t=e&&e.forceBase64;t&&(this.supportsBinary=!1),i.call(this,e)}var i=e("../transport"),r=e("engine.io-parser"),a=e("parseqs"),s=e("component-inherit"),l=e("debug")("engine.io-client:websocket"),c=e("ws");t.exports=o,s(o,i),o.prototype.name="websocket",o.prototype.supportsBinary=!0,o.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=void 0,n={agent:this.agent};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.ws=new c(e,t,n),void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.binaryType="arraybuffer",this.addEventListeners()}},o.prototype.addEventListeners=function(){var e=this;this.ws.onopen=function(){e.onOpen()},this.ws.onclose=function(){e.onClose()},this.ws.onmessage=function(t){e.onData(t.data)},this.ws.onerror=function(t){e.onError("websocket error",t)}},"undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)&&(o.prototype.onData=function(e){var t=this;setTimeout(function(){i.prototype.onData.call(t,e)},0)}),o.prototype.write=function(e){function t(){n.writable=!0,n.emit("drain")}var n=this;this.writable=!1;for(var o=0,i=e.length;i>o;o++)r.encodePacket(e[o],this.supportsBinary,function(e){try{n.ws.send(e)}catch(t){l("websocket closed before onclose event")}});setTimeout(t,0)},o.prototype.onClose=function(){i.prototype.onClose.call(this)},o.prototype.doClose=function(){"undefined"!=typeof this.ws&&this.ws.close()},o.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"==t&&443!=this.port||"ws"==t&&80!=this.port)&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=+new Date),this.supportsBinary||(e.b64=1),e=a.encode(e),e.length&&(e="?"+e),t+"://"+this.hostname+n+this.path+e},o.prototype.check=function(){return!(!c||"__initialize"in c&&this.name===o.prototype.name)}},{"../transport":14,"component-inherit":21,debug:22,"engine.io-parser":25,parseqs:33,ws:35}],20:[function(e,t,n){var o=e("has-cors");t.exports=function(e){var t=e.xdomain,n=e.xscheme,i=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||o))return new XMLHttpRequest}catch(r){}try{if("undefined"!=typeof XDomainRequest&&!n&&i)return new XDomainRequest}catch(r){}if(!t)try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(r){}}},{"has-cors":38}],21:[function(e,t,n){t.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},{}],22:[function(e,t,n){function o(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function i(){var e=arguments,t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+n.humanize(this.diff),!t)return e;var o="color: "+this.color;e=[e[0],o,"color: inherit"].concat(Array.prototype.slice.call(e,1));var i=0,r=0;return e[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(i++,"%c"===e&&(r=i))}),e.splice(r,0,o),e}function r(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(e){try{null==e?localStorage.removeItem("debug"):localStorage.debug=e}catch(t){}}function s(){var e;try{e=localStorage.debug}catch(t){}return e}n=t.exports=e("./debug"),n.log=r,n.formatArgs=i,n.save=a,n.load=s,n.useColors=o,n.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],n.formatters.j=function(e){return JSON.stringify(e)},n.enable(s())},{"./debug":23}],23:[function(e,t,n){function o(){return n.colors[d++%n.colors.length]}function i(e){function t(){}function i(){var e=i,t=+new Date,r=t-(c||t);e.diff=r,e.prev=c,e.curr=t,c=t,null==e.useColors&&(e.useColors=n.useColors()),null==e.color&&e.useColors&&(e.color=o());var a=Array.prototype.slice.call(arguments);a[0]=n.coerce(a[0]),"string"!=typeof a[0]&&(a=["%o"].concat(a));var s=0;a[0]=a[0].replace(/%([a-z%])/g,function(t,o){if("%%"===t)return t;s++;var i=n.formatters[o];if("function"==typeof i){var r=a[s];t=i.call(e,r),a.splice(s,1),s--}return t}),"function"==typeof n.formatArgs&&(a=n.formatArgs.apply(e,a));var l=i.log||n.log||console.log.bind(console);l.apply(e,a)}t.enabled=!1,i.enabled=!0;var r=n.enabled(e)?i:t;return r.namespace=e,r}function r(e){n.save(e);for(var t=(e||"").split(/[\s,]+/),o=t.length,i=0;o>i;i++)t[i]&&(e=t[i].replace(/\*/g,".*?"),"-"===e[0]?n.skips.push(new RegExp("^"+e.substr(1)+"$")):n.names.push(new RegExp("^"+e+"$")))}function a(){n.enable("")}function s(e){var t,o;for(t=0,o=n.skips.length;o>t;t++)if(n.skips[t].test(e))return!1;for(t=0,o=n.names.length;o>t;t++)if(n.names[t].test(e))return!0;return!1}function l(e){return e instanceof Error?e.stack||e.message:e}n=t.exports=i,n.coerce=l,n.disable=a,n.enable=r,n.enabled=s,n.humanize=e("ms"),n.names=[],n.skips=[],n.formatters={};var c,d=0},{ms:24}],24:[function(e,t,n){function o(e){var t=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]),o=(t[2]||"ms").toLowerCase();switch(o){case"years":case"year":case"y":return n*u;case"days":case"day":case"d":return n*d;case"hours":case"hour":case"h":return n*c;case"minutes":case"minute":case"m":return n*l;case"seconds":case"second":case"s":return n*s;case"ms":return n}}}function i(e){return e>=d?Math.round(e/d)+"d":e>=c?Math.round(e/c)+"h":e>=l?Math.round(e/l)+"m":e>=s?Math.round(e/s)+"s":e+"ms"}function r(e){return a(e,d,"day")||a(e,c,"hour")||a(e,l,"minute")||a(e,s,"second")||e+" ms"}function a(e,t,n){return t>e?void 0:1.5*t>e?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var s=1e3,l=60*s,c=60*l,d=24*c,u=365.25*d;t.exports=function(e,t){return t=t||{},"string"==typeof e?o(e):t["long"]?r(e):i(e)}},{}],25:[function(e,t,n){(function(t){function o(e,t){var o="b"+n.packets[e.type]+e.data.data;return t(o)}function i(e,t,o){if(!t)return n.encodeBase64Packet(e,o);var i=e.data,r=new Uint8Array(i),a=new Uint8Array(1+i.byteLength);a[0]=g[e.type];for(var s=0;s<r.length;s++)a[s+1]=r[s];return o(a.buffer)}function r(e,t,o){if(!t)return n.encodeBase64Packet(e,o);var i=new FileReader;return i.onload=function(){e.data=i.result,n.encodePacket(e,t,!0,o)},i.readAsArrayBuffer(e.data)}function a(e,t,o){if(!t)return n.encodeBase64Packet(e,o);if(m)return r(e,t,o);var i=new Uint8Array(1);i[0]=g[e.type];var a=new b([i.buffer,e.data]);return o(a)}function s(e,t,n){for(var o=new Array(e.length),i=p(e.length,n),r=function(e,n,i){t(n,function(t,n){o[e]=n,i(t,o)})},a=0;a<e.length;a++)r(a,e[a],i)}var l=e("./keys"),c=e("has-binary"),d=e("arraybuffer.slice"),u=e("base64-arraybuffer"),p=e("after"),h=e("utf8"),f=navigator.userAgent.match(/Android/i),_=/PhantomJS/i.test(navigator.userAgent),m=f||_;n.protocol=3;var g=n.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},v=l(g),y={type:"error",data:"parser error"},b=e("blob");n.encodePacket=function(e,n,r,s){"function"==typeof n&&(s=n,n=!1),"function"==typeof r&&(s=r,r=null);var l=void 0===e.data?void 0:e.data.buffer||e.data;if(t.ArrayBuffer&&l instanceof ArrayBuffer)return i(e,n,s);if(b&&l instanceof t.Blob)return a(e,n,s);if(l&&l.base64)return o(e,s);var c=g[e.type];return void 0!==e.data&&(c+=r?h.encode(String(e.data)):String(e.data)),s(""+c)},n.encodeBase64Packet=function(e,o){var i="b"+n.packets[e.type];if(b&&e.data instanceof b){var r=new FileReader;return r.onload=function(){var e=r.result.split(",")[1];o(i+e)},r.readAsDataURL(e.data)}var a;try{a=String.fromCharCode.apply(null,new Uint8Array(e.data))}catch(s){for(var l=new Uint8Array(e.data),c=new Array(l.length),d=0;d<l.length;d++)c[d]=l[d];a=String.fromCharCode.apply(null,c)}return i+=t.btoa(a),o(i)},n.decodePacket=function(e,t,o){if("string"==typeof e||void 0===e){if("b"==e.charAt(0))return n.decodeBase64Packet(e.substr(1),t);if(o)try{e=h.decode(e)}catch(i){return y}var r=e.charAt(0);return Number(r)==r&&v[r]?e.length>1?{type:v[r],data:e.substring(1)}:{type:v[r]}:y}var a=new Uint8Array(e),r=a[0],s=d(e,1);return b&&"blob"===t&&(s=new b([s])),{type:v[r],data:s}},n.decodeBase64Packet=function(e,n){var o=v[e.charAt(0)];if(!t.ArrayBuffer)return{type:o,data:{base64:!0,data:e.substr(1)}};var i=u.decode(e.substr(1));return"blob"===n&&b&&(i=new b([i])),{type:o,data:i}},n.encodePayload=function(e,t,o){function i(e){return e.length+":"+e}function r(e,o){n.encodePacket(e,a?t:!1,!0,function(e){o(null,i(e))})}"function"==typeof t&&(o=t,t=null);var a=c(e);return t&&a?b&&!m?n.encodePayloadAsBlob(e,o):n.encodePayloadAsArrayBuffer(e,o):e.length?void s(e,r,function(e,t){return o(t.join(""))}):o("0:")},n.decodePayload=function(e,t,o){if("string"!=typeof e)return n.decodePayloadAsBinary(e,t,o);"function"==typeof t&&(o=t,t=null);var i;if(""==e)return o(y,0,1);for(var r,a,s="",l=0,c=e.length;c>l;l++){var d=e.charAt(l);if(":"!=d)s+=d;else{if(""==s||s!=(r=Number(s)))return o(y,0,1);if(a=e.substr(l+1,r),s!=a.length)return o(y,0,1);if(a.length){if(i=n.decodePacket(a,t,!0),y.type==i.type&&y.data==i.data)return o(y,0,1);var u=o(i,l+r,c);if(!1===u)return}l+=r,s=""}}return""!=s?o(y,0,1):void 0},n.encodePayloadAsArrayBuffer=function(e,t){function o(e,t){n.encodePacket(e,!0,!0,function(e){return t(null,e)})}return e.length?void s(e,o,function(e,n){var o=n.reduce(function(e,t){var n;return n="string"==typeof t?t.length:t.byteLength,e+n.toString().length+n+2},0),i=new Uint8Array(o),r=0;return n.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var o=new Uint8Array(e.length),a=0;a<e.length;a++)o[a]=e.charCodeAt(a);n=o.buffer}t?i[r++]=0:i[r++]=1;for(var s=n.byteLength.toString(),a=0;a<s.length;a++)i[r++]=parseInt(s[a]);i[r++]=255;for(var o=new Uint8Array(n),a=0;a<o.length;a++)i[r++]=o[a]}),t(i.buffer)}):t(new ArrayBuffer(0))},n.encodePayloadAsBlob=function(e,t){function o(e,t){n.encodePacket(e,!0,!0,function(e){var n=new Uint8Array(1);if(n[0]=1,"string"==typeof e){for(var o=new Uint8Array(e.length),i=0;i<e.length;i++)o[i]=e.charCodeAt(i);e=o.buffer,n[0]=0}for(var r=e instanceof ArrayBuffer?e.byteLength:e.size,a=r.toString(),s=new Uint8Array(a.length+1),i=0;i<a.length;i++)s[i]=parseInt(a[i]);if(s[a.length]=255,b){var l=new b([n.buffer,s.buffer,e]);t(null,l)}})}s(e,o,function(e,n){return t(new b(n))})},n.decodePayloadAsBinary=function(e,t,o){"function"==typeof t&&(o=t,t=null);for(var i=e,r=[],a=!1;i.byteLength>0;){for(var s=new Uint8Array(i),l=0===s[0],c="",u=1;255!=s[u];u++){if(c.length>310){a=!0;break}c+=s[u]}if(a)return o(y,0,1);i=d(i,2+c.length),c=parseInt(c);var p=d(i,0,c);if(l)try{p=String.fromCharCode.apply(null,new Uint8Array(p))}catch(h){var f=new Uint8Array(p);p="";for(var u=0;u<f.length;u++)p+=String.fromCharCode(f[u])}r.push(p),i=d(i,c)}var _=r.length;r.forEach(function(e,i){o(n.decodePacket(e,t,!0),i,_)})}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./keys":26,after:27,"arraybuffer.slice":28,"base64-arraybuffer":29,blob:30,"has-binary":36,utf8:31}],26:[function(e,t,n){t.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var o in e)n.call(e,o)&&t.push(o);return t}},{}],27:[function(e,t,n){function o(e,t,n){function o(e,i){if(o.count<=0)throw new Error("after called too many times");--o.count,e?(r=!0,t(e),t=n):0!==o.count||r||t(null,i)}var r=!1;return n=n||i,o.count=e,0===e?t():o}function i(){}t.exports=o},{}],28:[function(e,t,n){t.exports=function(e,t,n){var o=e.byteLength;if(t=t||0,n=n||o,e.slice)return e.slice(t,n);if(0>t&&(t+=o),0>n&&(n+=o),n>o&&(n=o),t>=o||t>=n||0===o)return new ArrayBuffer(0);for(var i=new Uint8Array(e),r=new Uint8Array(n-t),a=t,s=0;n>a;a++,s++)r[s]=i[a];return r.buffer}},{}],29:[function(e,t,n){!function(e){"use strict";n.encode=function(t){var n,o=new Uint8Array(t),i=o.length,r="";for(n=0;i>n;n+=3)r+=e[o[n]>>2],r+=e[(3&o[n])<<4|o[n+1]>>4],r+=e[(15&o[n+1])<<2|o[n+2]>>6],r+=e[63&o[n+2]];return i%3===2?r=r.substring(0,r.length-1)+"=":i%3===1&&(r=r.substring(0,r.length-2)+"=="),r},n.decode=function(t){var n,o,i,r,a,s=.75*t.length,l=t.length,c=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);var d=new ArrayBuffer(s),u=new Uint8Array(d);for(n=0;l>n;n+=4)o=e.indexOf(t[n]),i=e.indexOf(t[n+1]),r=e.indexOf(t[n+2]),a=e.indexOf(t[n+3]),u[c++]=o<<2|i>>4,u[c++]=(15&i)<<4|r>>2,u[c++]=(3&r)<<6|63&a;return d}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},{}],30:[function(e,t,n){(function(e){function n(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.buffer instanceof ArrayBuffer){var o=n.buffer;if(n.byteLength!==o.byteLength){var i=new Uint8Array(n.byteLength);i.set(new Uint8Array(o,n.byteOffset,n.byteLength)),o=i.buffer}e[t]=o}}}function o(e,t){t=t||{};var o=new r;n(e);for(var i=0;i<e.length;i++)o.append(e[i]);return t.type?o.getBlob(t.type):o.getBlob()}function i(e,t){return n(e),new Blob(e,t||{})}var r=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder,a=function(){try{var e=new Blob(["hi"]);return 2===e.size}catch(t){return!1}}(),s=a&&function(){try{var e=new Blob([new Uint8Array([1,2])]);return 2===e.size}catch(t){return!1}}(),l=r&&r.prototype.append&&r.prototype.getBlob;t.exports=function(){return a?s?e.Blob:i:l?o:void 0}()}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],31:[function(t,n,o){(function(t){!function(i){function r(e){for(var t,n,o=[],i=0,r=e.length;r>i;)t=e.charCodeAt(i++),t>=55296&&56319>=t&&r>i?(n=e.charCodeAt(i++),56320==(64512&n)?o.push(((1023&t)<<10)+(1023&n)+65536):(o.push(t),i--)):o.push(t);return o}function a(e){for(var t,n=e.length,o=-1,i="";++o<n;)t=e[o],t>65535&&(t-=65536,i+=b(t>>>10&1023|55296),t=56320|1023&t),i+=b(t);return i}function s(e){if(e>=55296&&57343>=e)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}function l(e,t){return b(e>>t&63|128)}function c(e){if(0==(4294967168&e))return b(e);var t="";return 0==(4294965248&e)?t=b(e>>6&31|192):0==(4294901760&e)?(s(e),t=b(e>>12&15|224),t+=l(e,6)):0==(4292870144&e)&&(t=b(e>>18&7|240),t+=l(e,12),t+=l(e,6)),t+=b(63&e|128)}function d(e){for(var t,n=r(e),o=n.length,i=-1,a="";++i<o;)t=n[i],a+=c(t);return a}function u(){if(y>=v)throw Error("Invalid byte index");var e=255&g[y];if(y++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function p(){var e,t,n,o,i;if(y>v)throw Error("Invalid byte index");if(y==v)return!1;if(e=255&g[y],y++,0==(128&e))return e;if(192==(224&e)){var t=u();if(i=(31&e)<<6|t,i>=128)return i;throw Error("Invalid continuation byte")}if(224==(240&e)){if(t=u(),n=u(),i=(15&e)<<12|t<<6|n,i>=2048)return s(i),i;throw Error("Invalid continuation byte")}if(240==(248&e)&&(t=u(),n=u(),o=u(),i=(15&e)<<18|t<<12|n<<6|o,i>=65536&&1114111>=i))return i;throw Error("Invalid UTF-8 detected")}function h(e){g=r(e),v=g.length,y=0;for(var t,n=[];(t=p())!==!1;)n.push(t);return a(n)}var f="object"==typeof o&&o,_="object"==typeof n&&n&&n.exports==f&&n,m="object"==typeof t&&t;(m.global===m||m.window===m)&&(i=m);var g,v,y,b=String.fromCharCode,w={version:"2.0.0",encode:d,decode:h};if("function"==typeof e&&"object"==typeof e.amd&&e.amd)e(function(){return w});else if(f&&!f.nodeType)if(_)_.exports=w;else{var $={},x=$.hasOwnProperty;for(var k in w)x.call(w,k)&&(f[k]=w[k])}else i.utf8=w}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],32:[function(e,t,n){(function(e){var n=/^[\],:{}\s]*$/,o=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,i=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,r=/(?:^|:|,)(?:\s*\[)+/g,a=/^\s+/,s=/\s+$/;t.exports=function(t){return"string"==typeof t&&t?(t=t.replace(a,"").replace(s,""),e.JSON&&JSON.parse?JSON.parse(t):n.test(t.replace(o,"@").replace(i,"]").replace(r,""))?new Function("return "+t)():void 0):null}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],33:[function(e,t,n){n.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},n.decode=function(e){for(var t={},n=e.split("&"),o=0,i=n.length;i>o;o++){var r=n[o].split("=");t[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return t}},{}],34:[function(e,t,n){var o=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(e){var t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));for(var a=o.exec(e||""),s={},l=14;l--;)s[i[l]]=a[l]||"";return-1!=n&&-1!=r&&(s.source=t,s.host=s.host.substring(1,s.host.length-1).replace(/;/g,":"),s.authority=s.authority.replace("[","").replace("]","").replace(/;/g,":"),s.ipv6uri=!0),s}},{}],35:[function(e,t,n){function o(e,t,n){var o;return o=t?new r(e,t):new r(e)}var i=function(){return this}(),r=i.WebSocket||i.MozWebSocket;t.exports=r?o:null,r&&(o.prototype=r.prototype)},{}],36:[function(e,t,n){(function(n){function o(e){function t(e){if(!e)return!1;if(n.Buffer&&n.Buffer.isBuffer(e)||n.ArrayBuffer&&e instanceof ArrayBuffer||n.Blob&&e instanceof Blob||n.File&&e instanceof File)return!0;if(i(e)){for(var o=0;o<e.length;o++)if(t(e[o]))return!0}else if(e&&"object"==typeof e){e.toJSON&&(e=e.toJSON());for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return!0}return!1}return t(e)}var i=e("isarray");t.exports=o}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{isarray:37}],37:[function(e,t,n){t.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},{}],38:[function(e,t,n){var o=e("global");try{t.exports="XMLHttpRequest"in o&&"withCredentials"in new o.XMLHttpRequest}catch(i){t.exports=!1}},{global:39}],39:[function(e,t,n){t.exports=function(){return this}()},{}],40:[function(e,t,n){var o=[].indexOf;t.exports=function(e,t){if(o)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}},{}],41:[function(e,t,n){var o=Object.prototype.hasOwnProperty;n.keys=Object.keys||function(e){var t=[];for(var n in e)o.call(e,n)&&t.push(n);return t},n.values=function(e){var t=[];for(var n in e)o.call(e,n)&&t.push(e[n]);return t},n.merge=function(e,t){for(var n in t)o.call(t,n)&&(e[n]=t[n]);return e},n.length=function(e){return n.keys(e).length},n.isEmpty=function(e){return 0==n.length(e)}},{}],42:[function(e,t,n){var o=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(e){for(var t=o.exec(e||""),n={},r=14;r--;)n[i[r]]=t[r]||"";return n}},{}],43:[function(e,t,n){(function(t){var o=e("isarray"),i=e("./is-buffer");n.deconstructPacket=function(e){function t(e){if(!e)return e;if(i(e)){var r={_placeholder:!0,num:n.length};return n.push(e),r}if(o(e)){for(var a=new Array(e.length),s=0;s<e.length;s++)a[s]=t(e[s]);return a}if("object"==typeof e&&!(e instanceof Date)){var a={};for(var l in e)a[l]=t(e[l]);return a}return e}var n=[],r=e.data,a=e;return a.data=t(r),a.attachments=n.length,{packet:a,buffers:n}},n.reconstructPacket=function(e,t){function n(e){if(e&&e._placeholder){var i=t[e.num];return i}if(o(e)){for(var r=0;r<e.length;r++)e[r]=n(e[r]);return e}if(e&&"object"==typeof e){for(var a in e)e[a]=n(e[a]);return e}return e}return e.data=n(e.data),e.attachments=void 0,e},n.removeBlobs=function(e,n){function r(e,l,c){if(!e)return e;if(t.Blob&&e instanceof Blob||t.File&&e instanceof File){a++;var d=new FileReader;d.onload=function(){c?c[l]=this.result:s=this.result,--a||n(s)},d.readAsArrayBuffer(e)}else if(o(e))for(var u=0;u<e.length;u++)r(e[u],u,e);else if(e&&"object"==typeof e&&!i(e))for(var p in e)r(e[p],p,e)}var a=0,s=e;r(s),a||n(s)}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./is-buffer":45,isarray:46}],44:[function(e,t,n){function o(){}function i(e){var t="",o=!1;return t+=e.type,(n.BINARY_EVENT==e.type||n.BINARY_ACK==e.type)&&(t+=e.attachments,t+="-"),e.nsp&&"/"!=e.nsp&&(o=!0,t+=e.nsp),null!=e.id&&(o&&(t+=",",o=!1),t+=e.id),null!=e.data&&(o&&(t+=","),t+=u.stringify(e.data)),d("encoded %j as %s",e,t),t}function r(e,t){function n(e){var n=h.deconstructPacket(e),o=i(n.packet),r=n.buffers;r.unshift(o),t(r)}h.removeBlobs(e,n)}function a(){this.reconstructor=null}function s(e){var t={},o=0;if(t.type=Number(e.charAt(0)),null==n.types[t.type])return c();if(n.BINARY_EVENT==t.type||n.BINARY_ACK==t.type){for(var i="";"-"!=e.charAt(++o)&&(i+=e.charAt(o),o!=e.length););if(i!=Number(i)||"-"!=e.charAt(o))throw new Error("Illegal attachments");t.attachments=Number(i)}if("/"==e.charAt(o+1))for(t.nsp="";++o;){var r=e.charAt(o);if(","==r)break;if(t.nsp+=r,o==e.length)break}else t.nsp="/";var a=e.charAt(o+1);if(""!==a&&Number(a)==a){for(t.id="";++o;){var r=e.charAt(o);if(null==r||Number(r)!=r){--o;break}if(t.id+=e.charAt(o),o==e.length)break}t.id=Number(t.id)}if(e.charAt(++o))try{t.data=u.parse(e.substr(o))}catch(s){return c()}return d("decoded %s as %j",e,t),t}function l(e){this.reconPack=e,this.buffers=[]}function c(e){return{type:n.ERROR,data:"parser error"}}var d=e("debug")("socket.io-parser"),u=e("json3"),p=(e("isarray"),e("component-emitter")),h=e("./binary"),f=e("./is-buffer");n.protocol=4,n.types=["CONNECT","DISCONNECT","EVENT","BINARY_EVENT","ACK","BINARY_ACK","ERROR"],n.CONNECT=0,n.DISCONNECT=1,n.EVENT=2,n.ACK=3,n.ERROR=4,n.BINARY_EVENT=5,n.BINARY_ACK=6,n.Encoder=o,n.Decoder=a,o.prototype.encode=function(e,t){if(d("encoding packet %j",e),n.BINARY_EVENT==e.type||n.BINARY_ACK==e.type)r(e,t);else{var o=i(e);t([o])}},p(a.prototype),a.prototype.add=function(e){var t;if("string"==typeof e)t=s(e),n.BINARY_EVENT==t.type||n.BINARY_ACK==t.type?(this.reconstructor=new l(t),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",t)):this.emit("decoded",t);else{if(!f(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,this.emit("decoded",t))}},a.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},l.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length==this.reconPack.attachments){var t=h.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null},l.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},{"./binary":43,"./is-buffer":45,"component-emitter":9,debug:10,isarray:46,json3:47}],45:[function(e,t,n){(function(e){function n(t){return e.Buffer&&e.Buffer.isBuffer(t)||e.ArrayBuffer&&t instanceof ArrayBuffer}t.exports=n}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],46:[function(e,t,n){t.exports=e(37)},{}],47:[function(t,n,o){!function(t){function n(e){if(n[e]!==a)return n[e];var t;if("bug-string-char-index"==e)t="a"!="a"[0];else if("json"==e)t=n("json-stringify")&&n("json-parse");else{var o,i='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var r=d.stringify,l="function"==typeof r&&u;if(l){(o=function(){return 1}).toJSON=o;try{l="0"===r(0)&&"0"===r(new Number)&&'""'==r(new String)&&r(s)===a&&r(a)===a&&r()===a&&"1"===r(o)&&"[1]"==r([o])&&"[null]"==r([a])&&"null"==r(null)&&"[null,null,null]"==r([a,s,null])&&r({a:[o,!0,!1,null,"\x00\b\n\f\r	"]})==i&&"1"===r(null,o)&&"[\n 1,\n 2\n]"==r([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==r(new Date(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==r(new Date(864e13))&&'"-000001-01-01T00:00:00.000Z"'==r(new Date(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==r(new Date(-1))}catch(c){l=!1}}t=l}if("json-parse"==e){var p=d.parse;if("function"==typeof p)try{if(0===p("0")&&!p(!1)){o=p(i);var h=5==o.a.length&&1===o.a[0];if(h){try{h=!p('"	"')}catch(c){}if(h)try{h=1!==p("01")}catch(c){}if(h)try{h=1!==p("1.")}catch(c){}}}}catch(c){h=!1}t=h}}return n[e]=!!t}var i,r,a,s={}.toString,l="function"==typeof e&&e.amd,c="object"==typeof JSON&&JSON,d="object"==typeof o&&o&&!o.nodeType&&o;d&&c?(d.stringify=c.stringify,d.parse=c.parse):d=t.JSON=c||{};var u=new Date(-0xc782b5b800cec);try{u=-109252==u.getUTCFullYear()&&0===u.getUTCMonth()&&1===u.getUTCDate()&&10==u.getUTCHours()&&37==u.getUTCMinutes()&&6==u.getUTCSeconds()&&708==u.getUTCMilliseconds()}catch(p){}if(!n("json")){var h="[object Function]",f="[object Date]",_="[object Number]",m="[object String]",g="[object Array]",v="[object Boolean]",y=n("bug-string-char-index");if(!u)var b=Math.floor,w=[0,31,59,90,120,151,181,212,243,273,304,334],$=function(e,t){return w[t]+365*(e-1970)+b((e-1969+(t=+(t>1)))/4)-b((e-1901+t)/100)+b((e-1601+t)/400)};(i={}.hasOwnProperty)||(i=function(e){var t,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=s?i=function(e){var t=this.__proto__,n=e in(this.__proto__=null,this);return this.__proto__=t,n}:(t=n.constructor,i=function(e){var n=(this.constructor||t).prototype;return e in this&&!(e in n&&this[e]===n[e])}),n=null,i.call(this,e)});var x={"boolean":1,number:1,string:1,undefined:1},k=function(e,t){var n=typeof e[t];return"object"==n?!!e[t]:!x[n]};if(r=function(e,t){var n,o,a,l=0;(n=function(){this.valueOf=0}).prototype.valueOf=0,o=new n;for(a in o)i.call(o,a)&&l++;return n=o=null,l?r=2==l?function(e,t){var n,o={},r=s.call(e)==h;for(n in e)r&&"prototype"==n||i.call(o,n)||!(o[n]=1)||!i.call(e,n)||t(n)}:function(e,t){var n,o,r=s.call(e)==h;for(n in e)r&&"prototype"==n||!i.call(e,n)||(o="constructor"===n)||t(n);(o||i.call(e,n="constructor"))&&t(n)}:(o=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],r=function(e,t){var n,r,a=s.call(e)==h,l=!a&&"function"!=typeof e.constructor&&k(e,"hasOwnProperty")?e.hasOwnProperty:i;for(n in e)a&&"prototype"==n||!l.call(e,n)||t(n);for(r=o.length;n=o[--r];l.call(e,n)&&t(n));}),r(e,t)},!n("json-stringify")){var B={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},C="000000",P=function(e,t){return(C+(t||0)).slice(-e)},I="\\u00",U=function(e){var t,n='"',o=0,i=e.length,r=i>10&&y;for(r&&(t=e.split(""));i>o;o++){var a=e.charCodeAt(o);switch(a){case 8:case 9:case 10:case 12:case 13:case 34:case 92:n+=B[a];break;default:if(32>a){n+=I+P(2,a.toString(16));break}n+=r?t[o]:y?e.charAt(o):e[o]}}return n+'"'},T=function(e,t,n,o,l,c,d){var u,p,h,y,w,x,k,B,C,I,N,A,S,R,L,M;try{u=t[e]}catch(J){}if("object"==typeof u&&u)if(p=s.call(u),p!=f||i.call(u,"toJSON"))"function"==typeof u.toJSON&&(p!=_&&p!=m&&p!=g||i.call(u,"toJSON"))&&(u=u.toJSON(e));else if(u>-1/0&&1/0>u){if($){for(w=b(u/864e5),h=b(w/365.2425)+1970-1;$(h+1,0)<=w;h++);for(y=b((w-$(h,0))/30.42);$(h,y+1)<=w;y++);w=1+w-$(h,y),x=(u%864e5+864e5)%864e5,k=b(x/36e5)%24,B=b(x/6e4)%60,C=b(x/1e3)%60,I=x%1e3}else h=u.getUTCFullYear(),y=u.getUTCMonth(),w=u.getUTCDate(),k=u.getUTCHours(),B=u.getUTCMinutes(),C=u.getUTCSeconds(),I=u.getUTCMilliseconds();u=(0>=h||h>=1e4?(0>h?"-":"+")+P(6,0>h?-h:h):P(4,h))+"-"+P(2,y+1)+"-"+P(2,w)+"T"+P(2,k)+":"+P(2,B)+":"+P(2,C)+"."+P(3,I)+"Z"}else u=null;if(n&&(u=n.call(t,e,u)),null===u)return"null";if(p=s.call(u),p==v)return""+u;if(p==_)return u>-1/0&&1/0>u?""+u:"null";if(p==m)return U(""+u);if("object"==typeof u){for(R=d.length;R--;)if(d[R]===u)throw TypeError();if(d.push(u),N=[],L=c,c+=l,p==g){for(S=0,R=u.length;R>S;S++)A=T(S,u,n,o,l,c,d),N.push(A===a?"null":A);M=N.length?l?"[\n"+c+N.join(",\n"+c)+"\n"+L+"]":"["+N.join(",")+"]":"[]"}else r(o||u,function(e){var t=T(e,u,n,o,l,c,d);t!==a&&N.push(U(e)+":"+(l?" ":"")+t)}),M=N.length?l?"{\n"+c+N.join(",\n"+c)+"\n"+L+"}":"{"+N.join(",")+"}":"{}";return d.pop(),M}};d.stringify=function(e,t,n){var o,i,r,a;if("function"==typeof t||"object"==typeof t&&t)if((a=s.call(t))==h)i=t;else if(a==g){r={};for(var l,c=0,d=t.length;d>c;l=t[c++],a=s.call(l),(a==m||a==_)&&(r[l]=1));}if(n)if((a=s.call(n))==_){if((n-=n%1)>0)for(o="",n>10&&(n=10);o.length<n;o+=" ");}else a==m&&(o=n.length<=10?n:n.slice(0,10));return T("",(l={},l[""]=e,l),i,r,o,"",[])}}if(!n("json-parse")){var N,A,S=String.fromCharCode,R={92:"\\",34:'"',47:"/",98:"\b",116:"	",110:"\n",102:"\f",114:"\r"},L=function(){throw N=A=null,SyntaxError()},M=function(){for(var e,t,n,o,i,r=A,a=r.length;a>N;)switch(i=r.charCodeAt(N)){case 9:case 10:case 13:case 32:N++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=y?r.charAt(N):r[N],N++,e;case 34:for(e="@",N++;a>N;)if(i=r.charCodeAt(N),32>i)L();else if(92==i)switch(i=r.charCodeAt(++N)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=R[i],N++;break;case 117:for(t=++N,n=N+4;n>N;N++)i=r.charCodeAt(N),i>=48&&57>=i||i>=97&&102>=i||i>=65&&70>=i||L();e+=S("0x"+r.slice(t,N));break;default:L()}else{if(34==i)break;for(i=r.charCodeAt(N),t=N;i>=32&&92!=i&&34!=i;)i=r.charCodeAt(++N);e+=r.slice(t,N)}if(34==r.charCodeAt(N))return N++,e;L();default:if(t=N,45==i&&(o=!0,i=r.charCodeAt(++N)),i>=48&&57>=i){for(48==i&&(i=r.charCodeAt(N+1),i>=48&&57>=i)&&L(),o=!1;a>N&&(i=r.charCodeAt(N),i>=48&&57>=i);N++);if(46==r.charCodeAt(N)){for(n=++N;a>n&&(i=r.charCodeAt(n),i>=48&&57>=i);n++);n==N&&L(),N=n}if(i=r.charCodeAt(N),101==i||69==i){for(i=r.charCodeAt(++N),(43==i||45==i)&&N++,n=N;a>n&&(i=r.charCodeAt(n),i>=48&&57>=i);n++);n==N&&L(),N=n}return+r.slice(t,N)}if(o&&L(),"true"==r.slice(N,N+4))return N+=4,!0;if("false"==r.slice(N,N+5))return N+=5,!1;if("null"==r.slice(N,N+4))return N+=4,null;L()}return"$"},J=function(e){var t,n;if("$"==e&&L(),"string"==typeof e){if("@"==(y?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];e=M(),"]"!=e;n||(n=!0))n&&(","==e?(e=M(),"]"==e&&L()):L()),","==e&&L(),t.push(J(e));return t}if("{"==e){for(t={};e=M(),"}"!=e;n||(n=!0))n&&(","==e?(e=M(),"}"==e&&L()):L()),(","==e||"string"!=typeof e||"@"!=(y?e.charAt(0):e[0])||":"!=M())&&L(),t[e.slice(1)]=J(M());return t}L()}return e},O=function(e,t,n){var o=E(e,t,n);o===a?delete e[t]:e[t]=o},E=function(e,t,n){var o,i=e[t];if("object"==typeof i&&i)if(s.call(i)==g)for(o=i.length;o--;)O(i,o,n);else r(i,function(e){O(i,e,n)});return n.call(e,t,i)};d.parse=function(e,t){var n,o;return N=0,A=""+e,n=J(M()),"$"!=M()&&L(),N=A=null,t&&s.call(t)==h?E((o={},o[""]=n,o),"",t):n}}}l&&e(function(){return d})}(this)},{}],48:[function(e,t,n){function o(e,t){var n=[];t=t||0;for(var o=t||0;o<e.length;o++)n[o-t]=e[o];return n}t.exports=o},{}]},{},[1])(1)});var header=new headerJS,header_notifcations=new header_notifcationsJS,header=new headerJS,header_notifcations=new header_notifcationsJS,login=new loginJs,notebook=new notebookJs,war=new warJs,addBuilding=new addBuildingJs,feed=new feedJs,vmap=new vmapJs,map_lookAround=new map_lookAroundJs,map_findStreetName=new map_findStreetNameJs,geocoder,map,infowindow,map_click=new map_clickJs,map_relationship=new map_relationshipJs,youtube=new youtubeJs,company=new companyJs,petek=new petekJs,runningTimes=new runningTimesJs,payment=new paymentJs,profile=new profileJs,upgradeBuilding=new upgradeBuildingJs,mentor=new mentorJs,chat=new chatJs,bgElements=new bgElementsJs,searchResults=new searchResultsJs,choicePopup=new choicePopupJs,popup=new popupJs,rank=new rankJs,valert=new alertJs;